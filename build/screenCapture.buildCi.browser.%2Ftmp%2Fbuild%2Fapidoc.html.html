<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/NetEase/pomelo">pomelo (v2.2.5)</a>
</h1>
<h4>Pomelo is a fast, scalable game server framework for [node.js](http://nodejs.org). It provides the basic development framework and many related components, including libraries and tools. Pomelo is also suitable for real-time web applications; its distribu</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo">module pomelo</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSession">
            function <span class="apidocSignatureSpan">pomelo.</span>backendSession
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService">
            function <span class="apidocSignatureSpan">pomelo.</span>backendSessionService
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channel">
            function <span class="apidocSignatureSpan">pomelo.</span>channel
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService">
            function <span class="apidocSignatureSpan">pomelo.</span>channelService
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connection">
            function <span class="apidocSignatureSpan">pomelo.</span>connection
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService">
            function <span class="apidocSignatureSpan">pomelo.</span>connectionService
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connector">
            function <span class="apidocSignatureSpan">pomelo.</span>connector
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector">
            function <span class="apidocSignatureSpan">pomelo.</span>connectors.hybridconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector">
            function <span class="apidocSignatureSpan">pomelo.</span>connectors.mqttconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector">
            function <span class="apidocSignatureSpan">pomelo.</span>connectors.sioconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector">
            function <span class="apidocSignatureSpan">pomelo.</span>connectors.udpconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.createApp">
            function <span class="apidocSignatureSpan">pomelo.</span>createApp
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.dictionary">
            function <span class="apidocSignatureSpan">pomelo.</span>dictionary
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService">
            function <span class="apidocSignatureSpan">pomelo.</span>filterService
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handlerService">
            function <span class="apidocSignatureSpan">pomelo.</span>handlerService
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handshake">
            function <span class="apidocSignatureSpan">pomelo.</span>handshake
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.heartbeat">
            function <span class="apidocSignatureSpan">pomelo.</span>heartbeat
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>hybridsocket
            <span class="apidocSignatureSpan">(id, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.master">
            function <span class="apidocSignatureSpan">pomelo.</span>master
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.monitor">
            function <span class="apidocSignatureSpan">pomelo.</span>monitor
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor">
            function <span class="apidocSignatureSpan">pomelo.</span>mqttadaptor
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>mqttsocket
            <span class="apidocSignatureSpan">(id, socket, adaptor)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.protobuf">
            function <span class="apidocSignatureSpan">pomelo.</span>protobuf
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.proxy">
            function <span class="apidocSignatureSpan">pomelo.</span>proxy
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushScheduler">
            function <span class="apidocSignatureSpan">pomelo.</span>pushScheduler
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer">
            function <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.buffer
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.direct">
            function <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.direct
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.remote">
            function <span class="apidocSignatureSpan">pomelo.</span>remote
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.serial">
            function <span class="apidocSignatureSpan">pomelo.</span>serial
            <span class="apidocSignatureSpan">(timeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.server">
            function <span class="apidocSignatureSpan">pomelo.</span>server
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.session">
            function <span class="apidocSignatureSpan">pomelo.</span>session
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService">
            function <span class="apidocSignatureSpan">pomelo.</span>sessionService
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket">
            function <span class="apidocSignatureSpan">pomelo.</span>siosocket
            <span class="apidocSignatureSpan">(id, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.switcher">
            function <span class="apidocSignatureSpan">pomelo.</span>switcher
            <span class="apidocSignatureSpan">(server, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpprocessor">
            function <span class="apidocSignatureSpan">pomelo.</span>tcpprocessor
            <span class="apidocSignatureSpan">(closeMethod)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>tcpsocket
            <span class="apidocSignatureSpan">(socket, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.time">
            function <span class="apidocSignatureSpan">pomelo.</span>time
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.timeout">
            function <span class="apidocSignatureSpan">pomelo.</span>timeout
            <span class="apidocSignatureSpan">(timeout, maxSize)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.toobusy">
            function <span class="apidocSignatureSpan">pomelo.</span>toobusy
            <span class="apidocSignatureSpan">(maxLag)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>udpsocket
            <span class="apidocSignatureSpan">(id, socket, peer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog">
            function <span class="apidocSignatureSpan">pomelo.</span>watchdog
            <span class="apidocSignatureSpan">(app, service)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.wsprocessor">
            function <span class="apidocSignatureSpan">pomelo.</span>wsprocessor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>appManager</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>appUtil</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>application</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>backendSessionService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>channelService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>coder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>components</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectionService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectors</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectors.hybridconnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectors.mqttconnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectors.sioconnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>connectors.udpconnector.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>countDownLatch</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>events</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>filterService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>filters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>generate</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>handlerService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>handshake.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>heartbeat.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>hybridsocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>index</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>kick</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>moduleUtil</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>mqttadaptor.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>mqttsocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>pathUtil</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.buffer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.direct.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>rpcFilters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>sessionService.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>siosocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>starter</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>switcher.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>taskManager</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>tcpprocessor.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>tcpsocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>udpsocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>watchdog.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.</span>wsprocessor.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.appManager">module pomelo.appManager</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appManager.transaction">
            function <span class="apidocSignatureSpan">pomelo.appManager.</span>transaction
            <span class="apidocSignatureSpan">(name, conditions, handlers, retry)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.appUtil">module pomelo.appUtil</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appUtil.defaultConfiguration">
            function <span class="apidocSignatureSpan">pomelo.appUtil.</span>defaultConfiguration
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appUtil.loadDefaultComponents">
            function <span class="apidocSignatureSpan">pomelo.appUtil.</span>loadDefaultComponents
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appUtil.optComponents">
            function <span class="apidocSignatureSpan">pomelo.appUtil.</span>optComponents
            <span class="apidocSignatureSpan">(comps, method, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appUtil.startByType">
            function <span class="apidocSignatureSpan">pomelo.appUtil.</span>startByType
            <span class="apidocSignatureSpan">(app, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.appUtil.stopComps">
            function <span class="apidocSignatureSpan">pomelo.appUtil.</span>stopComps
            <span class="apidocSignatureSpan">(comps, index, force, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.application">module pomelo.application</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.addCrons">
            function <span class="apidocSignatureSpan">pomelo.application.</span>addCrons
            <span class="apidocSignatureSpan">(crons)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.addServers">
            function <span class="apidocSignatureSpan">pomelo.application.</span>addServers
            <span class="apidocSignatureSpan">(servers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.after">
            function <span class="apidocSignatureSpan">pomelo.application.</span>after
            <span class="apidocSignatureSpan">(af)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.afterStart">
            function <span class="apidocSignatureSpan">pomelo.application.</span>afterStart
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.before">
            function <span class="apidocSignatureSpan">pomelo.application.</span>before
            <span class="apidocSignatureSpan">(bf)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.beforeStopHook">
            function <span class="apidocSignatureSpan">pomelo.application.</span>beforeStopHook
            <span class="apidocSignatureSpan">(fun)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.configure">
            function <span class="apidocSignatureSpan">pomelo.application.</span>configure
            <span class="apidocSignatureSpan">(env, type, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.configureLogger">
            function <span class="apidocSignatureSpan">pomelo.application.</span>configureLogger
            <span class="apidocSignatureSpan">(logger)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.disable">
            function <span class="apidocSignatureSpan">pomelo.application.</span>disable
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.disabled">
            function <span class="apidocSignatureSpan">pomelo.application.</span>disabled
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.enable">
            function <span class="apidocSignatureSpan">pomelo.application.</span>enable
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.enabled">
            function <span class="apidocSignatureSpan">pomelo.application.</span>enabled
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.filter">
            function <span class="apidocSignatureSpan">pomelo.application.</span>filter
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.get">
            function <span class="apidocSignatureSpan">pomelo.application.</span>get
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getBase">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getBase
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getCurServer">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getCurServer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getMaster">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getMaster
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServerById">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServerById
            <span class="apidocSignatureSpan">(serverId)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServerFromConfig">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServerFromConfig
            <span class="apidocSignatureSpan">(serverId)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServerId">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServerId
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServerType">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServerType
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServerTypes">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServerTypes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServers">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServers
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServersByType">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServersByType
            <span class="apidocSignatureSpan">(serverType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.getServersFromConfig">
            function <span class="apidocSignatureSpan">pomelo.application.</span>getServersFromConfig
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.globalAfter">
            function <span class="apidocSignatureSpan">pomelo.application.</span>globalAfter
            <span class="apidocSignatureSpan">(af)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.globalBefore">
            function <span class="apidocSignatureSpan">pomelo.application.</span>globalBefore
            <span class="apidocSignatureSpan">(bf)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.globalFilter">
            function <span class="apidocSignatureSpan">pomelo.application.</span>globalFilter
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.init">
            function <span class="apidocSignatureSpan">pomelo.application.</span>init
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.isBackend">
            function <span class="apidocSignatureSpan">pomelo.application.</span>isBackend
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.isFrontend">
            function <span class="apidocSignatureSpan">pomelo.application.</span>isFrontend
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.isMaster">
            function <span class="apidocSignatureSpan">pomelo.application.</span>isMaster
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.load">
            function <span class="apidocSignatureSpan">pomelo.application.</span>load
            <span class="apidocSignatureSpan">(name, component, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.loadConfig">
            function <span class="apidocSignatureSpan">pomelo.application.</span>loadConfig
            <span class="apidocSignatureSpan">(key, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.loadConfigBaseApp">
            function <span class="apidocSignatureSpan">pomelo.application.</span>loadConfigBaseApp
            <span class="apidocSignatureSpan">(key, val, reload)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.registerAdmin">
            function <span class="apidocSignatureSpan">pomelo.application.</span>registerAdmin
            <span class="apidocSignatureSpan">(moduleId, module, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.removeCrons">
            function <span class="apidocSignatureSpan">pomelo.application.</span>removeCrons
            <span class="apidocSignatureSpan">(crons)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.removeServers">
            function <span class="apidocSignatureSpan">pomelo.application.</span>removeServers
            <span class="apidocSignatureSpan">(ids)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.replaceServers">
            function <span class="apidocSignatureSpan">pomelo.application.</span>replaceServers
            <span class="apidocSignatureSpan">(servers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.require">
            function <span class="apidocSignatureSpan">pomelo.application.</span>require
            <span class="apidocSignatureSpan">(ph)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.route">
            function <span class="apidocSignatureSpan">pomelo.application.</span>route
            <span class="apidocSignatureSpan">(serverType, routeFunc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.rpcAfter">
            function <span class="apidocSignatureSpan">pomelo.application.</span>rpcAfter
            <span class="apidocSignatureSpan">(af)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.rpcBefore">
            function <span class="apidocSignatureSpan">pomelo.application.</span>rpcBefore
            <span class="apidocSignatureSpan">(bf)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.rpcFilter">
            function <span class="apidocSignatureSpan">pomelo.application.</span>rpcFilter
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.set">
            function <span class="apidocSignatureSpan">pomelo.application.</span>set
            <span class="apidocSignatureSpan">(setting, val, attach)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.start">
            function <span class="apidocSignatureSpan">pomelo.application.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.stop">
            function <span class="apidocSignatureSpan">pomelo.application.</span>stop
            <span class="apidocSignatureSpan">(force)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.transaction">
            function <span class="apidocSignatureSpan">pomelo.application.</span>transaction
            <span class="apidocSignatureSpan">(name, conditions, handlers, retry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.application.use">
            function <span class="apidocSignatureSpan">pomelo.application.</span>use
            <span class="apidocSignatureSpan">(plugin, opts)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>clusterSeq</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>components</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>curServer</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>event</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>lifecycleCbs</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>loaded</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>serverId</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>serverType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>serverTypeMaps</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>serverTypes</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>servers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>settings</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.application.</span>startTime</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.application.</span>base</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.application.</span>env</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.backendSessionService">module pomelo.backendSessionService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.backendSessionService">
            function <span class="apidocSignatureSpan">pomelo.</span>backendSessionService
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.backendSessionService.prototype">module pomelo.backendSessionService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.bind">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>bind
            <span class="apidocSignatureSpan">(frontendId, sid, uid, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.create">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>create
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.get">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>get
            <span class="apidocSignatureSpan">(frontendId, sid, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.getByUid">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>getByUid
            <span class="apidocSignatureSpan">(frontendId, uid, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.kickBySid">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>kickBySid
            <span class="apidocSignatureSpan">(frontendId, sid, reason, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.kickByUid">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>kickByUid
            <span class="apidocSignatureSpan">(frontendId, uid, reason, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.push">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>push
            <span class="apidocSignatureSpan">(frontendId, sid, key, value, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.pushAll">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>pushAll
            <span class="apidocSignatureSpan">(frontendId, sid, settings, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.backendSessionService.prototype.unbind">
            function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>unbind
            <span class="apidocSignatureSpan">(frontendId, sid, uid, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.channelService">module pomelo.channelService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.channelService">
            function <span class="apidocSignatureSpan">pomelo.</span>channelService
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.channelService.prototype">module pomelo.channelService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.broadcast">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>broadcast
            <span class="apidocSignatureSpan">(stype, route, msg, opts, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.createChannel">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>createChannel
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.destroyChannel">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>destroyChannel
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.getChannel">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>getChannel
            <span class="apidocSignatureSpan">(name, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.pushMessageByUids">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>pushMessageByUids
            <span class="apidocSignatureSpan">(route, msg, uids, opts, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.channelService.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.coder">module pomelo.coder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.coder.decode">
            function <span class="apidocSignatureSpan">pomelo.coder.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.coder.encode">
            function <span class="apidocSignatureSpan">pomelo.coder.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.components">module pomelo.components</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.backendSession">
            function <span class="apidocSignatureSpan">pomelo.components.</span>backendSession
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.channel">
            function <span class="apidocSignatureSpan">pomelo.components.</span>channel
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.connection">
            function <span class="apidocSignatureSpan">pomelo.components.</span>connection
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.connector">
            function <span class="apidocSignatureSpan">pomelo.components.</span>connector
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.dictionary">
            function <span class="apidocSignatureSpan">pomelo.components.</span>dictionary
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.master">
            function <span class="apidocSignatureSpan">pomelo.components.</span>master
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.monitor">
            function <span class="apidocSignatureSpan">pomelo.components.</span>monitor
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.protobuf">
            function <span class="apidocSignatureSpan">pomelo.components.</span>protobuf
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.proxy">
            function <span class="apidocSignatureSpan">pomelo.components.</span>proxy
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.pushScheduler">
            function <span class="apidocSignatureSpan">pomelo.components.</span>pushScheduler
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.remote">
            function <span class="apidocSignatureSpan">pomelo.components.</span>remote
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.server">
            function <span class="apidocSignatureSpan">pomelo.components.</span>server
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.components.session">
            function <span class="apidocSignatureSpan">pomelo.components.</span>session
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectionService">module pomelo.connectionService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.connectionService">
            function <span class="apidocSignatureSpan">pomelo.</span>connectionService
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectionService.prototype">module pomelo.connectionService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.addLoginedUser">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>addLoginedUser
            <span class="apidocSignatureSpan">(uid, info)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.decreaseConnectionCount">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>decreaseConnectionCount
            <span class="apidocSignatureSpan">(uid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.getStatisticsInfo">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>getStatisticsInfo
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.increaseConnectionCount">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>increaseConnectionCount
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.removeLoginedUser">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>removeLoginedUser
            <span class="apidocSignatureSpan">(uid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectionService.prototype.updateUserInfo">
            function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>updateUserInfo
            <span class="apidocSignatureSpan">(uid, info)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors">module pomelo.connectors</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>hybridconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>mqttconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>sioconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>udpconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.hybridconnector">module pomelo.connectors.hybridconnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.hybridconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>hybridconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.super_">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.hybridconnector.prototype">module pomelo.connectors.hybridconnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.stop">
            function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>stop
            <span class="apidocSignatureSpan">(force, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.mqttconnector">module pomelo.connectors.mqttconnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.mqttconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>mqttconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.super_">
            function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.mqttconnector.prototype">module pomelo.connectors.mqttconnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.close">
            function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msgBody)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.stop">
            function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.sioconnector">module pomelo.connectors.sioconnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.sioconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>sioconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.super_">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.sioconnector.prototype">module pomelo.connectors.sioconnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.prototype.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.prototype.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.sioconnector.prototype.stop">
            function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>stop
            <span class="apidocSignatureSpan">(force, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.udpconnector">module pomelo.connectors.udpconnector</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.udpconnector">
            function <span class="apidocSignatureSpan">pomelo.connectors.</span>udpconnector
            <span class="apidocSignatureSpan">(port, host, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.super_">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.connectors.udpconnector.prototype">module pomelo.connectors.udpconnector.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.prototype.decode">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>decode
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.prototype.encode">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>encode
            <span class="apidocSignatureSpan">(reqId, route, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.connectors.udpconnector.prototype.stop">
            function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>stop
            <span class="apidocSignatureSpan">(force, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.countDownLatch">module pomelo.countDownLatch</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.countDownLatch.createCountDownLatch">
            function <span class="apidocSignatureSpan">pomelo.countDownLatch.</span>createCountDownLatch
            <span class="apidocSignatureSpan">(count, opts, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.filterService">module pomelo.filterService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService.filterService">
            function <span class="apidocSignatureSpan">pomelo.</span>filterService
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.filterService.prototype">module pomelo.filterService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService.prototype.after">
            function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>after
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService.prototype.afterFilter">
            function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>afterFilter
            <span class="apidocSignatureSpan">(err, msg, session, resp, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService.prototype.before">
            function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>before
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filterService.prototype.beforeFilter">
            function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>beforeFilter
            <span class="apidocSignatureSpan">(msg, session, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>name</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.filters">module pomelo.filters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filters.serial">
            function <span class="apidocSignatureSpan">pomelo.filters.</span>serial
            <span class="apidocSignatureSpan">(timeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filters.time">
            function <span class="apidocSignatureSpan">pomelo.filters.</span>time
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filters.timeout">
            function <span class="apidocSignatureSpan">pomelo.filters.</span>timeout
            <span class="apidocSignatureSpan">(timeout, maxSize)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.filters.toobusy">
            function <span class="apidocSignatureSpan">pomelo.filters.</span>toobusy
            <span class="apidocSignatureSpan">(maxLag)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.generate">module pomelo.generate</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.generate.publish">
            function <span class="apidocSignatureSpan">pomelo.generate.</span>publish
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.handlerService">module pomelo.handlerService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handlerService.handlerService">
            function <span class="apidocSignatureSpan">pomelo.</span>handlerService
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.handlerService.prototype">module pomelo.handlerService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handlerService.prototype.getHandler">
            function <span class="apidocSignatureSpan">pomelo.handlerService.prototype.</span>getHandler
            <span class="apidocSignatureSpan">(routeRecord)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handlerService.prototype.handle">
            function <span class="apidocSignatureSpan">pomelo.handlerService.prototype.</span>handle
            <span class="apidocSignatureSpan">(routeRecord, msg, session, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.handlerService.prototype.</span>name</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.handshake">module pomelo.handshake</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handshake.handshake">
            function <span class="apidocSignatureSpan">pomelo.</span>handshake
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.handshake.prototype">module pomelo.handshake.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.handshake.prototype.handle">
            function <span class="apidocSignatureSpan">pomelo.handshake.prototype.</span>handle
            <span class="apidocSignatureSpan">(socket, msg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.heartbeat">module pomelo.heartbeat</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.heartbeat.heartbeat">
            function <span class="apidocSignatureSpan">pomelo.</span>heartbeat
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.heartbeat.prototype">module pomelo.heartbeat.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.heartbeat.prototype.clear">
            function <span class="apidocSignatureSpan">pomelo.heartbeat.prototype.</span>clear
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.heartbeat.prototype.handle">
            function <span class="apidocSignatureSpan">pomelo.heartbeat.prototype.</span>handle
            <span class="apidocSignatureSpan">(socket)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.hybridsocket">module pomelo.hybridsocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.hybridsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>hybridsocket
            <span class="apidocSignatureSpan">(id, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.super_">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.hybridsocket.prototype">module pomelo.hybridsocket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.disconnect">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>disconnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.handshakeResponse">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>handshakeResponse
            <span class="apidocSignatureSpan">(resp)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.send">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>send
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.sendBatch">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendBatch
            <span class="apidocSignatureSpan">(msgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.sendForce">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendForce
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.hybridsocket.prototype.sendRaw">
            function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendRaw
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.index">module pomelo.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.backendSession">
            function <span class="apidocSignatureSpan">pomelo.index.</span>backendSession
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.channel">
            function <span class="apidocSignatureSpan">pomelo.index.</span>channel
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.connection">
            function <span class="apidocSignatureSpan">pomelo.index.</span>connection
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.connector">
            function <span class="apidocSignatureSpan">pomelo.index.</span>connector
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.createApp">
            function <span class="apidocSignatureSpan">pomelo.index.</span>createApp
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.dictionary">
            function <span class="apidocSignatureSpan">pomelo.index.</span>dictionary
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.master">
            function <span class="apidocSignatureSpan">pomelo.index.</span>master
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.monitor">
            function <span class="apidocSignatureSpan">pomelo.index.</span>monitor
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.protobuf">
            function <span class="apidocSignatureSpan">pomelo.index.</span>protobuf
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.proxy">
            function <span class="apidocSignatureSpan">pomelo.index.</span>proxy
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.pushScheduler">
            function <span class="apidocSignatureSpan">pomelo.index.</span>pushScheduler
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.remote">
            function <span class="apidocSignatureSpan">pomelo.index.</span>remote
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.serial">
            function <span class="apidocSignatureSpan">pomelo.index.</span>serial
            <span class="apidocSignatureSpan">(timeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.server">
            function <span class="apidocSignatureSpan">pomelo.index.</span>server
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.session">
            function <span class="apidocSignatureSpan">pomelo.index.</span>session
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.time">
            function <span class="apidocSignatureSpan">pomelo.index.</span>time
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.timeout">
            function <span class="apidocSignatureSpan">pomelo.index.</span>timeout
            <span class="apidocSignatureSpan">(timeout, maxSize)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.index.toobusy">
            function <span class="apidocSignatureSpan">pomelo.index.</span>toobusy
            <span class="apidocSignatureSpan">(maxLag)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>components</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>connectors</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>events</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>filters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>pushSchedulers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">pomelo.index.</span>rpcFilters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">pomelo.index.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.kick">module pomelo.kick</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.kick.handle">
            function <span class="apidocSignatureSpan">pomelo.kick.</span>handle
            <span class="apidocSignatureSpan">(socket, reason)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.moduleUtil">module pomelo.moduleUtil</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.moduleUtil.loadModules">
            function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>loadModules
            <span class="apidocSignatureSpan">(self, consoleService)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.moduleUtil.registerDefaultModules">
            function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>registerDefaultModules
            <span class="apidocSignatureSpan">(isMaster, app, closeWatcher)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.moduleUtil.startModules">
            function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>startModules
            <span class="apidocSignatureSpan">(modules, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.mqttadaptor">module pomelo.mqttadaptor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor.mqttadaptor">
            function <span class="apidocSignatureSpan">pomelo.</span>mqttadaptor
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.mqttadaptor.prototype">module pomelo.mqttadaptor.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor.prototype.onPubAck">
            function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onPubAck
            <span class="apidocSignatureSpan">(client, packet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor.prototype.onPublish">
            function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onPublish
            <span class="apidocSignatureSpan">(client, packet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor.prototype.onSubscribe">
            function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onSubscribe
            <span class="apidocSignatureSpan">(client, packet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttadaptor.prototype.publish">
            function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>publish
            <span class="apidocSignatureSpan">(client, packet)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.mqttsocket">module pomelo.mqttsocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket.mqttsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>mqttsocket
            <span class="apidocSignatureSpan">(id, socket, adaptor)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket.super_">
            function <span class="apidocSignatureSpan">pomelo.mqttsocket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.mqttsocket.prototype">module pomelo.mqttsocket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket.prototype.disconnect">
            function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>disconnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket.prototype.send">
            function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>send
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.mqttsocket.prototype.sendBatch">
            function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>sendBatch
            <span class="apidocSignatureSpan">(msgs)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pathUtil">module pomelo.pathUtil</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getCronPath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getCronPath
            <span class="apidocSignatureSpan">(appBase, serverType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getHandlerPath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getHandlerPath
            <span class="apidocSignatureSpan">(appBase, serverType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getLogPath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getLogPath
            <span class="apidocSignatureSpan">(appBase)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getScriptPath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getScriptPath
            <span class="apidocSignatureSpan">(appBase)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getSysRemotePath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getSysRemotePath
            <span class="apidocSignatureSpan">(role)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.getUserRemotePath">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getUserRemotePath
            <span class="apidocSignatureSpan">(appBase, serverType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.listUserRemoteDir">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>listUserRemoteDir
            <span class="apidocSignatureSpan">(appBase)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pathUtil.remotePathRecord">
            function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>remotePathRecord
            <span class="apidocSignatureSpan">(namespace, serverType, path)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pushSchedulers">module pomelo.pushSchedulers</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>buffer
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.direct">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>direct
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pushSchedulers.buffer">module pomelo.pushSchedulers.buffer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer.buffer">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>buffer
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pushSchedulers.buffer.prototype">module pomelo.pushSchedulers.buffer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.schedule">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>schedule
            <span class="apidocSignatureSpan">(reqId, route, msg, recvs, opts, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.start">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>start
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.stop">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>stop
            <span class="apidocSignatureSpan">(force, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pushSchedulers.direct">module pomelo.pushSchedulers.direct</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.direct.direct">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>direct
            <span class="apidocSignatureSpan">(app, opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.pushSchedulers.direct.prototype">module pomelo.pushSchedulers.direct.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.pushSchedulers.direct.prototype.schedule">
            function <span class="apidocSignatureSpan">pomelo.pushSchedulers.direct.prototype.</span>schedule
            <span class="apidocSignatureSpan">(reqId, route, msg, recvs, opts, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.rpcFilters">module pomelo.rpcFilters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.rpcFilters.rpcLog">
            function <span class="apidocSignatureSpan">pomelo.rpcFilters.</span>rpcLog
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.rpcFilters.toobusy">
            function <span class="apidocSignatureSpan">pomelo.rpcFilters.</span>toobusy
            <span class="apidocSignatureSpan">(maxLag)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.sessionService">module pomelo.sessionService</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.sessionService">
            function <span class="apidocSignatureSpan">pomelo.</span>sessionService
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.sessionService.prototype">module pomelo.sessionService.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.bind">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>bind
            <span class="apidocSignatureSpan">(sid, uid, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.create">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>create
            <span class="apidocSignatureSpan">(sid, frontendId, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.forEachBindedSession">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>forEachBindedSession
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.forEachSession">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>forEachSession
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.get">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>get
            <span class="apidocSignatureSpan">(sid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.getByUid">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getByUid
            <span class="apidocSignatureSpan">(uid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.getClientAddressBySessionId">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getClientAddressBySessionId
            <span class="apidocSignatureSpan">(sid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.getSessionsCount">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getSessionsCount
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.import">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>import
            <span class="apidocSignatureSpan">(sid, key, value, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.importAll">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>importAll
            <span class="apidocSignatureSpan">(sid, settings, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.kick">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>kick
            <span class="apidocSignatureSpan">(uid, reason, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.kickBySessionId">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>kickBySessionId
            <span class="apidocSignatureSpan">(sid, reason, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.remove">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>remove
            <span class="apidocSignatureSpan">(sid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.sendMessage">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>sendMessage
            <span class="apidocSignatureSpan">(sid, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.sendMessageByUid">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>sendMessageByUid
            <span class="apidocSignatureSpan">(uid, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.sessionService.prototype.unbind">
            function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>unbind
            <span class="apidocSignatureSpan">(sid, uid, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.siosocket">module pomelo.siosocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket.siosocket">
            function <span class="apidocSignatureSpan">pomelo.</span>siosocket
            <span class="apidocSignatureSpan">(id, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket.super_">
            function <span class="apidocSignatureSpan">pomelo.siosocket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.siosocket.prototype">module pomelo.siosocket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket.prototype.disconnect">
            function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>disconnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket.prototype.send">
            function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>send
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.siosocket.prototype.sendBatch">
            function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>sendBatch
            <span class="apidocSignatureSpan">(msgs)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.starter">module pomelo.starter</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.bindCpu">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>bindCpu
            <span class="apidocSignatureSpan">(sid, pid, host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.kill">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>kill
            <span class="apidocSignatureSpan">(pids, servers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.localrun">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>localrun
            <span class="apidocSignatureSpan">(cmd, host, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.run">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>run
            <span class="apidocSignatureSpan">(app, server, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.runServers">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>runServers
            <span class="apidocSignatureSpan">(app)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.starter.sshrun">
            function <span class="apidocSignatureSpan">pomelo.starter.</span>sshrun
            <span class="apidocSignatureSpan">(cmd, host, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.switcher">module pomelo.switcher</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.switcher.switcher">
            function <span class="apidocSignatureSpan">pomelo.</span>switcher
            <span class="apidocSignatureSpan">(server, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.switcher.super_">
            function <span class="apidocSignatureSpan">pomelo.switcher.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.switcher.prototype">module pomelo.switcher.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.switcher.prototype.close">
            function <span class="apidocSignatureSpan">pomelo.switcher.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.switcher.prototype.newSocket">
            function <span class="apidocSignatureSpan">pomelo.switcher.prototype.</span>newSocket
            <span class="apidocSignatureSpan">(socket)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.taskManager">module pomelo.taskManager</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.taskManager.addTask">
            function <span class="apidocSignatureSpan">pomelo.taskManager.</span>addTask
            <span class="apidocSignatureSpan">(key, fn, ontimeout, timeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.taskManager.closeQueue">
            function <span class="apidocSignatureSpan">pomelo.taskManager.</span>closeQueue
            <span class="apidocSignatureSpan">(key, force)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">pomelo.taskManager.</span>timeout</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.tcpprocessor">module pomelo.tcpprocessor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpprocessor.tcpprocessor">
            function <span class="apidocSignatureSpan">pomelo.</span>tcpprocessor
            <span class="apidocSignatureSpan">(closeMethod)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpprocessor.super_">
            function <span class="apidocSignatureSpan">pomelo.tcpprocessor.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.tcpprocessor.prototype">module pomelo.tcpprocessor.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpprocessor.prototype.add">
            function <span class="apidocSignatureSpan">pomelo.tcpprocessor.prototype.</span>add
            <span class="apidocSignatureSpan">(socket, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpprocessor.prototype.close">
            function <span class="apidocSignatureSpan">pomelo.tcpprocessor.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.tcpsocket">module pomelo.tcpsocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpsocket.tcpsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>tcpsocket
            <span class="apidocSignatureSpan">(socket, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpsocket.super_">
            function <span class="apidocSignatureSpan">pomelo.tcpsocket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.tcpsocket.prototype">module pomelo.tcpsocket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpsocket.prototype.close">
            function <span class="apidocSignatureSpan">pomelo.tcpsocket.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.tcpsocket.prototype.send">
            function <span class="apidocSignatureSpan">pomelo.tcpsocket.prototype.</span>send
            <span class="apidocSignatureSpan">(msg, encode, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.udpsocket">module pomelo.udpsocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.udpsocket">
            function <span class="apidocSignatureSpan">pomelo.</span>udpsocket
            <span class="apidocSignatureSpan">(id, socket, peer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.super_">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.udpsocket.prototype">module pomelo.udpsocket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.disconnect">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>disconnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.handshakeResponse">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>handshakeResponse
            <span class="apidocSignatureSpan">(resp)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.send">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>send
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.sendBatch">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendBatch
            <span class="apidocSignatureSpan">(msgs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.sendForce">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendForce
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.udpsocket.prototype.sendRaw">
            function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendRaw
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.utils">module pomelo.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.arrayDiff">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>arrayDiff
            <span class="apidocSignatureSpan">(array1, array2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.checkPort">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>checkPort
            <span class="apidocSignatureSpan">(server, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.endsWith">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>endsWith
            <span class="apidocSignatureSpan">(str, suffix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.extends">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>extends
            <span class="apidocSignatureSpan">(origin, add)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.format">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>format
            <span class="apidocSignatureSpan">(date, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.hasChineseChar">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>hasChineseChar
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.headHandler">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>headHandler
            <span class="apidocSignatureSpan">(headBuffer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.invokeCallback">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>invokeCallback
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.isLocal">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>isLocal
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.isObject">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>isObject
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.loadCluster">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>loadCluster
            <span class="apidocSignatureSpan">(app, server, serverMap)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.ping">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>ping
            <span class="apidocSignatureSpan">(host, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.size">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>size
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.startsWith">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>startsWith
            <span class="apidocSignatureSpan">(str, prefix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.utils.unicodeToUtf8">
            function <span class="apidocSignatureSpan">pomelo.utils.</span>unicodeToUtf8
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.watchdog">module pomelo.watchdog</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.watchdog">
            function <span class="apidocSignatureSpan">pomelo.</span>watchdog
            <span class="apidocSignatureSpan">(app, service)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.super_">
            function <span class="apidocSignatureSpan">pomelo.watchdog.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.watchdog.prototype">module pomelo.watchdog.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.addServer">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>addServer
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.notify">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>notify
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.notifyById">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>notifyById
            <span class="apidocSignatureSpan">(id, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.query">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>query
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.reconnectServer">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>reconnectServer
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.record">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>record
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.removeServer">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>removeServer
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.subscribe">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>subscribe
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.watchdog.prototype.unsubscribe">
            function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>unsubscribe
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.wsprocessor">module pomelo.wsprocessor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.wsprocessor.wsprocessor">
            function <span class="apidocSignatureSpan">pomelo.</span>wsprocessor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.wsprocessor.super_">
            function <span class="apidocSignatureSpan">pomelo.wsprocessor.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.pomelo.wsprocessor.prototype">module pomelo.wsprocessor.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.wsprocessor.prototype.add">
            function <span class="apidocSignatureSpan">pomelo.wsprocessor.prototype.</span>add
            <span class="apidocSignatureSpan">(socket, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.pomelo.wsprocessor.prototype.close">
            function <span class="apidocSignatureSpan">pomelo.wsprocessor.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo" id="apidoc.module.pomelo">module pomelo</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.backendSession" id="apidoc.element.pomelo.backendSession">
        function <span class="apidocSignatureSpan">pomelo.</span>backendSession
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">backendSession = function (app) {
  var service = new BackendSessionService(app);
  service.name = '__backendSession__';
  // export backend session service to the application context.
  app.set('backendSessionService', service, true);

  // for compatibility as `LocalSession` is renamed to `BackendSession`
  app.set('localSessionService', service, true);

  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService" id="apidoc.element.pomelo.backendSessionService">
        function <span class="apidocSignatureSpan">pomelo.</span>backendSessionService
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">backendSessionService = function (app) {
  this.app = app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channel" id="apidoc.element.pomelo.channel">
        function <span class="apidocSignatureSpan">pomelo.</span>channel
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">channel = function (app, opts) {
  var service = new ChannelService(app, opts);
  app.set('channelService', service, true);
  service.name = '__channel__';
  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService" id="apidoc.element.pomelo.channelService">
        function <span class="apidocSignatureSpan">pomelo.</span>channelService
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">channelService = function (app, opts) {
  opts = opts || {};
  this.app = app;
  this.channels = {};
  this.prefix = opts.prefix;
  this.store = opts.store;
  this.broadcastFilter = opts.broadcastFilter;
  this.channelRemote = new ChannelRemote(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connection" id="apidoc.element.pomelo.connection">
        function <span class="apidocSignatureSpan">pomelo.</span>connection
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connection = function (app) {
  return new Component(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService" id="apidoc.element.pomelo.connectionService">
        function <span class="apidocSignatureSpan">pomelo.</span>connectionService
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectionService = function (app) {
  this.serverId = app.getServerId();
  this.connCount = 0;
  this.loginedCount = 0;
  this.logined = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connector" id="apidoc.element.pomelo.connector">
        function <span class="apidocSignatureSpan">pomelo.</span>connector
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connector = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector" id="apidoc.element.pomelo.connectors.hybridconnector">
        function <span class="apidocSignatureSpan">pomelo.</span>connectors.hybridconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectors.hybridconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);

  this.opts = opts || {};
  this.port = port;
  this.host = host;
  this.useDict = opts.useDict;
  this.useProtobuf = opts.useProtobuf;
  this.handshake = new Handshake(opts);
  this.heartbeat = new Heartbeat(opts);
  this.distinctHost = opts.distinctHost;
  this.ssl = opts.ssl;

  this.switcher = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector" id="apidoc.element.pomelo.connectors.mqttconnector">
        function <span class="apidocSignatureSpan">pomelo.</span>connectors.mqttconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectors.mqttconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts || {};

  this.adaptor = new Adaptor(this.opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector" id="apidoc.element.pomelo.connectors.sioconnector">
        function <span class="apidocSignatureSpan">pomelo.</span>connectors.sioconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectors.sioconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts;
  this.heartbeats = opts.heartbeats || true;
  this.closeTimeout = opts.closeTimeout || 60;
  this.heartbeatTimeout = opts.heartbeatTimeout || 60;
  this.heartbeatInterval = opts.heartbeatInterval || 25;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector" id="apidoc.element.pomelo.connectors.udpconnector">
        function <span class="apidocSignatureSpan">pomelo.</span>connectors.udpconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectors.udpconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.opts = opts || {};
  this.type = opts.udpType || 'udp4';
  this.handshake = new Handshake(opts);
  if(!opts.heartbeat) {
    opts.heartbeat = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIME;
    opts.timeout = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIMEOUT;
  }
  this.heartbeat = new Heartbeat(utils.extends(opts, {disconnectOnTimeout: true}));
  this.clients = {};
  this.host = host;
  this.port = port;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.createApp" id="apidoc.element.pomelo.createApp">
        function <span class="apidocSignatureSpan">pomelo.</span>createApp
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createApp = function (opts) {
  var app = application;
  app.init(opts);
  self.app = app;
  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.dictionary" id="apidoc.element.pomelo.dictionary">
        function <span class="apidocSignatureSpan">pomelo.</span>dictionary
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dictionary = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filterService" id="apidoc.element.pomelo.filterService">
        function <span class="apidocSignatureSpan">pomelo.</span>filterService
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filterService = function () {
  this.befores = [];    // before filters
  this.afters = [];     // after filters
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.handlerService" id="apidoc.element.pomelo.handlerService">
        function <span class="apidocSignatureSpan">pomelo.</span>handlerService
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handlerService = function (app, opts) {
  this.app = app;
  this.handlerMap = {};
  if(!!opts.reloadHandlers) {
    watchHandlers(app, this.handlerMap);
  }

  this.enableForwardLog = opts.enableForwardLog || false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.handshake" id="apidoc.element.pomelo.handshake">
        function <span class="apidocSignatureSpan">pomelo.</span>handshake
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handshake = function (opts) {
  opts = opts || {};
  this.userHandshake = opts.handshake;

  if(opts.heartbeat) {
    this.heartbeatSec = opts.heartbeat;
    this.heartbeat = opts.heartbeat * 1000;
  }

  this.checkClient = opts.checkClient;

  this.useDict = opts.useDict;
  this.useProtobuf = opts.useProtobuf;
  this.useCrypto = opts.useCrypto;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var CODE_USE_ERROR = 500;
var CODE_OLD_CLIENT = 501;

/**
 * Process the handshake request.
 *
 * @param {Object} opts option parameters
 *                      opts.<span class="apidocCodeKeywordSpan">handshake</span>(msg, cb(err, resp)) handshake callback. msg is
 the handshake message from client.
 *                      opts.hearbeat heartbeat interval (level?)
 *                      opts.version required client level
 */
var Command = function(opts) {
opts = opts || {};
this.userHandshake = opts.handshake;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.heartbeat" id="apidoc.element.pomelo.heartbeat">
        function <span class="apidocSignatureSpan">pomelo.</span>heartbeat
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">heartbeat = function (opts) {
  opts = opts || {};
  this.heartbeat = null;
  this.timeout = null;
  this.disconnectOnTimeout = opts.disconnectOnTimeout;

  if(opts.heartbeat) {
    this.heartbeat = opts.heartbeat * 1000; // heartbeat interval
    this.timeout = opts.timeout * 1000 || this.heartbeat * 2;      // max heartbeat message timeout
    this.disconnectOnTimeout = true;
  }

  this.timeouts = {};
  this.clients = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket" id="apidoc.element.pomelo.hybridsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>hybridsocket
        <span class="apidocSignatureSpan">(id, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hybridsocket = function (id, socket) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;

  if(!socket._socket) {
    this.remoteAddress = {
      ip: socket.address().address,
      port: socket.address().port
    };
  } else {
    this.remoteAddress = {
      ip: socket._socket.remoteAddress,
      port: socket._socket.remotePort
    };
  }

  var self = this;

  socket.once('close', this.emit.bind(this, 'disconnect'));
  socket.on('error', this.emit.bind(this, 'error'));

  socket.on('message', function(msg) {
    if(msg) {
      msg = Package.decode(msg);
      handler(self, msg);
    }
  });

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.master" id="apidoc.element.pomelo.master">
        function <span class="apidocSignatureSpan">pomelo.</span>master
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">master = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.monitor" id="apidoc.element.pomelo.monitor">
        function <span class="apidocSignatureSpan">pomelo.</span>monitor
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monitor = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor" id="apidoc.element.pomelo.mqttadaptor">
        function <span class="apidocSignatureSpan">pomelo.</span>mqttadaptor
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttadaptor = function (opts) {
  opts = opts || {};
  this.subReqs = {};
  this.publishRoute = opts.publishRoute;
  this.subscribeRoute = opts.subscribeRoute;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket" id="apidoc.element.pomelo.mqttsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>mqttsocket
        <span class="apidocSignatureSpan">(id, socket, adaptor)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttsocket = function (id, socket, adaptor) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;
  this.remoteAddress = {
    ip: socket.stream.remoteAddress,
    port: socket.stream.remotePort
  };
  this.adaptor = adaptor;

  var self = this;

  socket.on('close', this.emit.bind(this, 'disconnect'));
  socket.on('error', this.emit.bind(this, 'disconnect'));
  socket.on('disconnect', this.emit.bind(this, 'disconnect'));

  socket.on('pingreq', function(packet) {
    socket.pingresp();
  });

  socket.on('subscribe', this.adaptor.onSubscribe.bind(this.adaptor, this));

  socket.on('publish', this.adaptor.onPublish.bind(this.adaptor, this));

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.protobuf" id="apidoc.element.pomelo.protobuf">
        function <span class="apidocSignatureSpan">pomelo.</span>protobuf
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">protobuf = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.proxy" id="apidoc.element.pomelo.proxy">
        function <span class="apidocSignatureSpan">pomelo.</span>proxy
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proxy = function (app, opts) {
  opts = opts || {};
  // proxy default config
  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  opts.router = genRouteFun();
  opts.context = app;
  opts.routeContext = app;
  if (app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }

  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushScheduler" id="apidoc.element.pomelo.pushScheduler">
        function <span class="apidocSignatureSpan">pomelo.</span>pushScheduler
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushScheduler = function (app, opts) {
  return new PushScheduler(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer" id="apidoc.element.pomelo.pushSchedulers.buffer">
        function <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.buffer
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushSchedulers.buffer = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
  this.flushInterval = opts.flushInterval || DEFAULT_FLUSH_INTERVAL;
  this.sessions = {};   // sid -&gt; msg queue
  this.tid = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.direct" id="apidoc.element.pomelo.pushSchedulers.direct">
        function <span class="apidocSignatureSpan">pomelo.</span>pushSchedulers.direct
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushSchedulers.direct = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.remote" id="apidoc.element.pomelo.remote">
        function <span class="apidocSignatureSpan">pomelo.</span>remote
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remote = function (app, opts) {
  opts = opts || {};

  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  if(app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.serial" id="apidoc.element.pomelo.serial">
        function <span class="apidocSignatureSpan">pomelo.</span>serial
        <span class="apidocSignatureSpan">(timeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">serial = function (timeout) {
  return new Filter(timeout);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.server" id="apidoc.element.pomelo.server">
        function <span class="apidocSignatureSpan">pomelo.</span>server
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">server = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.session" id="apidoc.element.pomelo.session">
        function <span class="apidocSignatureSpan">pomelo.</span>session
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">session = function (app, opts) {
  var cmp = new Component(app, opts);
  app.set('sessionService', cmp, true);
  return cmp;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService" id="apidoc.element.pomelo.sessionService">
        function <span class="apidocSignatureSpan">pomelo.</span>sessionService
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sessionService = function (opts) {
  opts = opts || {};
  this.singleSession = opts.singleSession;
  this.sessions = {};     // sid -&gt; session
  this.uidMap = {};       // uid -&gt; sessions
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.siosocket" id="apidoc.element.pomelo.siosocket">
        function <span class="apidocSignatureSpan">pomelo.</span>siosocket
        <span class="apidocSignatureSpan">(id, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">siosocket = function (id, socket) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;
  this.remoteAddress = {
    ip: socket.handshake.address.address,
    port: socket.handshake.address.port
  };

  var self = this;

  socket.on('disconnect', this.emit.bind(this, 'disconnect'));

  socket.on('error', this.emit.bind(this, 'error'));

  socket.on('message', function(msg) {
    self.emit('message', msg);
  });

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.switcher" id="apidoc.element.pomelo.switcher">
        function <span class="apidocSignatureSpan">pomelo.</span>switcher
        <span class="apidocSignatureSpan">(server, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">switcher = function (server, opts) {
  EventEmitter.call(this);
  this.server = server;
  this.wsprocessor = new WSProcessor();
  this.tcpprocessor = new TCPProcessor(opts.closeMethod);
  this.id = 1;
  this.timeout = (opts.timeout || DEFAULT_TIMEOUT) * 1000;
  this.setNoDelay = opts.setNoDelay;

  if (!opts.ssl) {
    this.server.on('connection', this.newSocket.bind(this));
  } else {
    this.server.on('secureConnection', this.newSocket.bind(this));
    this.server.on('clientError', function(e, tlsSo) {
      logger.warn('an ssl error occured before handshake established: ', e);
      tlsSo.destroy();
    });
  }

  this.wsprocessor.on('connection', this.emit.bind(this, 'connection'));
  this.tcpprocessor.on('connection', this.emit.bind(this, 'connection'));

  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpprocessor" id="apidoc.element.pomelo.tcpprocessor">
        function <span class="apidocSignatureSpan">pomelo.</span>tcpprocessor
        <span class="apidocSignatureSpan">(closeMethod)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tcpprocessor = function (closeMethod) {
  EventEmitter.call(this);
  this.closeMethod = closeMethod;
  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpsocket" id="apidoc.element.pomelo.tcpsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>tcpsocket
        <span class="apidocSignatureSpan">(socket, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tcpsocket = function (socket, opts) {
  if(!(this instanceof Socket)) {
    return new Socket(socket, opts);
  }

  if(!socket || !opts) {
    throw new Error('invalid socket or opts');
  }

  if(!opts.headSize || typeof opts.headHandler !== 'function') {
    throw new Error('invalid opts.headSize or opts.headHandler');
  }

  // stream style interfaces.
  // TODO: need to port to stream2 after node 0.9
  Stream.call(this);
  this.readable = true;
  this.writeable = true;

  this._socket = socket;
  this.headSize = opts.headSize;
  this.closeMethod = opts.closeMethod;
  this.headBuffer = new Buffer(opts.headSize);
  this.headHandler = opts.headHandler;

  this.headOffset = 0;
  this.packageOffset = 0;
  this.packageSize = 0;
  this.packageBuffer = null;

  // bind event form the origin socket
  this._socket.on('data', ondata.bind(null, this));
  this._socket.on('end', onend.bind(null, this));
  this._socket.on('error', this.emit.bind(this, 'error'));
  this._socket.on('close', this.emit.bind(this, 'close'));

  this.state = ST_HEAD;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.time" id="apidoc.element.pomelo.time">
        function <span class="apidocSignatureSpan">pomelo.</span>time
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function () {
  return new Filter();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.timeout" id="apidoc.element.pomelo.timeout">
        function <span class="apidocSignatureSpan">pomelo.</span>timeout
        <span class="apidocSignatureSpan">(timeout, maxSize)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeout = function (timeout, maxSize) {
  return new Filter(timeout || DEFAULT_TIMEOUT, maxSize || DEFAULT_SIZE);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.toobusy" id="apidoc.element.pomelo.toobusy">
        function <span class="apidocSignatureSpan">pomelo.</span>toobusy
        <span class="apidocSignatureSpan">(maxLag)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toobusy = function (maxLag) {
  return new Filter(maxLag || DEFAULT_MAXLAG);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket" id="apidoc.element.pomelo.udpsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>udpsocket
        <span class="apidocSignatureSpan">(id, socket, peer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">udpsocket = function (id, socket, peer) {
	EventEmitter.call(this);
	
  this.id = id;
	this.socket = socket;
  this.peer = peer;
	this.host = peer.address;
	this.port = peer.port;
	this.remoteAddress = {
    ip: this.host,
    port: this.port
  };

  var self = this;
  this.on('package', function(pkg) {
    if(!!pkg) {
      pkg = Package.decode(pkg);
      handler(self, pkg);
    }
  });

  this.state = ST_INITED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog" id="apidoc.element.pomelo.watchdog">
        function <span class="apidocSignatureSpan">pomelo.</span>watchdog
        <span class="apidocSignatureSpan">(app, service)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">watchdog = function (app, service) {
  EventEmitter.call(this);

  this.app = app;
  this.service = service;
  this.isStarted = false;
  this.count = utils.size(app.getServersFromConfig());

  this.servers = {};
  this.listeners = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.wsprocessor" id="apidoc.element.pomelo.wsprocessor">
        function <span class="apidocSignatureSpan">pomelo.</span>wsprocessor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wsprocessor = function () {
  EventEmitter.call(this);
  this.httpServer = new HttpServer();

  var self = this;
  this.wsServer = new WebSocketServer({server: this.httpServer});

  this.wsServer.on('connection', function(socket) {
    // emit socket to outside
    self.emit('connection', socket);
  });

  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


























































































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.appManager" id="apidoc.module.pomelo.appManager">module pomelo.appManager</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.appManager.transaction" id="apidoc.element.pomelo.appManager.transaction">
        function <span class="apidocSignatureSpan">pomelo.appManager.</span>transaction
        <span class="apidocSignatureSpan">(name, conditions, handlers, retry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">transaction = function (name, conditions, handlers, retry) {
	if(!retry) {
    retry = 1;
  }
  if(typeof name !== 'string') {
    logger.error('transaction name is error format, name: %s.', name);
    return;
  }
  if(typeof conditions !== 'object' || typeof handlers !== 'object') {
    logger.error('transaction conditions parameter is error format, conditions: %j, handlers: %j.', conditions, handlers);
    return;
  }

  var cmethods=[] ,dmethods=[], cnames=[], dnames=[];
  for(var key in conditions) {
    if(typeof key !== 'string' || typeof conditions[key] !== 'function') {
      logger.error('transaction conditions parameter is error format, condition name: %s, condition function: %j.', key, conditions
[key]);
      return;
    }
    cnames.push(key);
    cmethods.push(conditions[key]);
  }

  var i = 0;
  // execute conditions
  async.forEachSeries(cmethods, function(method, cb) {
    method(cb);
    transactionLogger.info('[%s]:[%s] condition is executed.', name, cnames[i]);
    i++;
  }, function(err) {
    if(err) {
      process.nextTick(function() {
        transactionLogger.error('[%s]:[%s] condition is executed with err: %j.', name, cnames[--i], err.stack);
        var log = {
          name: name,
          method: cnames[i],
          time: Date.now(),
          type: 'condition',
          description: err.stack
        };
        transactionErrorLogger.error(JSON.stringify(log));
      });
      return;
    } else {
      // execute handlers
      process.nextTick(function() {
        for(var key in handlers) {
          if(typeof key !== 'string' || typeof handlers[key] !== 'function') {
            logger.error('transcation handlers parameter is error format, handler name: %s, handler function: %j.', key, handlers
[key]);
            return;
          }
          dnames.push(key);
          dmethods.push(handlers[key]);
        }

        var flag = true;
        var times = retry;

        // do retry if failed util retry times
        async.whilst(
          function() {
            return retry &gt; 0 &amp;&amp; flag;
          },
          function(callback) {
            var j = 0;
            retry--;
            async.forEachSeries(dmethods, function(method, cb) {
              method(cb);
              transactionLogger.info('[%s]:[%s] handler is executed.', name, dnames[j]);
              j++;
            }, function(err) {
              if(err) {
                process.nextTick(function() {
                  transactionLogger.error('[%s]:[%s]:[%s] handler is executed with err: %j.', name, dnames[--j], times-retry, err
.stack);
                  var log = {
                    name: name,
                    method: dnames[j],
                    retry: times-retry,
                    time: Date.now(),
                    type: 'handler',
                    description: err.stack
                  };
                  transactionErrorLogger.error(JSON.stringify(log));
                  utils.invokeCallback(callback);
                });
                return;
              }
              flag = false;
              utils.invokeCallback(callback);
              process.nextTick(function() {
                transactionLogger.info('[%s] all conditions and handlers are executed successfully.', name);
              });
            });
          },
          function(err) {
            if(err) {
              logger.error('transaction process is executed with error: %j', err);
            }
            // callback will not pass error
          }
        );
      });
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {String} name transaction name
* @param {Object} conditions functions which are called before transaction
* @param {Object} handlers functions which are called during transaction
* @param {Number} retry retry times to execute handlers if conditions are successfully executed
* @memberOf Application
*/
Application.transaction = function(name, conditions, handlers, retry) {
 appManager.<span class="apidocCodeKeywordSpan">transaction</span>(name, conditions, handlers, retry);
};

/**
* Get master server info.
*
* @return {Object} master server info, {id, host, port}
* @memberOf Application
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.appUtil" id="apidoc.module.pomelo.appUtil">module pomelo.appUtil</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.appUtil.defaultConfiguration" id="apidoc.element.pomelo.appUtil.defaultConfiguration">
        function <span class="apidocSignatureSpan">pomelo.appUtil.</span>defaultConfiguration
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">defaultConfiguration = function (app) {
  var args = parseArgs(process.argv);
  setupEnv(app, args);
  loadMaster(app);
  loadServers(app);
  processArgs(app, args);
  configLogger(app);
  loadLifecycle(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 this.master = null;         // master server info
 this.servers = {};          // current global server info maps, id -&gt; info
 this.serverTypeMaps = {};   // current global type maps, type -&gt; [info]
 this.serverTypes = [];      // current global server type list
 this.lifecycleCbs = {};     // current server custom lifecycle callbacks
 this.clusterSeq = {};       // cluster id seqence

 appUtil.<span class="apidocCodeKeywordSpan">defaultConfiguration</span>(this);

 this.state = STATE_INITED;
 logger.info('application inited: %j', this.getServerId());
};

/**
* Get application base path
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.appUtil.loadDefaultComponents" id="apidoc.element.pomelo.appUtil.loadDefaultComponents">
        function <span class="apidocSignatureSpan">pomelo.appUtil.</span>loadDefaultComponents
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadDefaultComponents = function (app) {
  var pomelo = require('../pomelo');
  // load system default components
  if (app.serverType === Constants.RESERVED.MASTER) {
    app.load(pomelo.master, app.get('masterConfig'));
  } else {
    app.load(pomelo.proxy, app.get('proxyConfig'));
    if (app.getCurServer().port) {
      app.load(pomelo.remote, app.get('remoteConfig'));
    }
    if (app.isFrontend()) {
      app.load(pomelo.connection, app.get('connectionConfig'));
      app.load(pomelo.connector, app.get('connectorConfig'));
      app.load(pomelo.session, app.get('sessionConfig'));
      // compatible for schedulerConfig
      if(app.get('schedulerConfig')) {
        app.load(pomelo.pushScheduler, app.get('schedulerConfig'));
      } else {
        app.load(pomelo.pushScheduler, app.get('pushSchedulerConfig'));
      }
    }
    app.load(pomelo.backendSession, app.get('backendSessionConfig'));
    app.load(pomelo.channel, app.get('channelConfig'));
    app.load(pomelo.server, app.get('serverConfig'));
  }
  app.load(pomelo.monitor, app.get('monitorConfig'));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(this.state &gt; STATE_INITED) {
  utils.invokeCallback(cb, new Error('application has already start.'));
  return;
}

var self = this;
appUtil.startByType(self, function() {
  appUtil.<span class="apidocCodeKeywordSpan">loadDefaultComponents</span>(self);
  var startUp = function() {
    appUtil.optComponents(self.loaded, Constants.RESERVED.START, function(err) {
      self.state = STATE_START;
      if(err) {
        utils.invokeCallback(cb, err);
      } else {
        logger.info('%j enter after start...', self.getServerId());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.appUtil.optComponents" id="apidoc.element.pomelo.appUtil.optComponents">
        function <span class="apidocSignatureSpan">pomelo.appUtil.</span>optComponents
        <span class="apidocSignatureSpan">(comps, method, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">optComponents = function (comps, method, cb) {
  var i = 0;
  async.forEachSeries(comps, function(comp, done) {
    i++;
    if (typeof comp[method] === 'function') {
      comp[method](done);
    } else {
      done();
    }
  }, function(err) {
    if (err) {
      if(typeof err === 'string') {
        logger.error('fail to operate component, method: %s, err: %j', method, err);
      } else {
        logger.error('fail to operate component, method: %s, err: %j',  method, err.stack);
      }
    }
    utils.invokeCallback(cb, err);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

var self = this;
appUtil.startByType(self, function() {
  appUtil.loadDefaultComponents(self);
  var startUp = function() {
    appUtil.<span class="apidocCodeKeywordSpan">optComponents</span>(self.loaded, Constants.RESERVED.START, function(err) {
      self.state = STATE_START;
      if(err) {
        utils.invokeCallback(cb, err);
      } else {
        logger.info('%j enter after start...', self.getServerId());
        self.afterStart(cb);
      }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.appUtil.startByType" id="apidoc.element.pomelo.appUtil.startByType">
        function <span class="apidocSignatureSpan">pomelo.appUtil.</span>startByType
        <span class="apidocSignatureSpan">(app, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startByType = function (app, cb) {
  if(!!app.startId) {
    if(app.startId === Constants.RESERVED.MASTER) {
      utils.invokeCallback(cb);
    } else {
      starter.runServers(app);
    }
  } else {
    if(!!app.type &amp;&amp; app.type !== Constants.RESERVED.ALL &amp;&amp; app.type !== Constants.RESERVED.MASTER) {
      starter.runServers(app);
    } else {
      utils.invokeCallback(cb);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.startTime = Date.now();
if(this.state &gt; STATE_INITED) {
  utils.invokeCallback(cb, new Error('application has already start.'));
  return;
}

var self = this;
appUtil.<span class="apidocCodeKeywordSpan">startByType</span>(self, function() {
  appUtil.loadDefaultComponents(self);
  var startUp = function() {
    appUtil.optComponents(self.loaded, Constants.RESERVED.START, function(err) {
      self.state = STATE_START;
      if(err) {
        utils.invokeCallback(cb, err);
      } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.appUtil.stopComps" id="apidoc.element.pomelo.appUtil.stopComps">
        function <span class="apidocSignatureSpan">pomelo.appUtil.</span>stopComps
        <span class="apidocSignatureSpan">(comps, index, force, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stopComps = function (comps, index, force, cb) {
  if (index &gt;= comps.length) {
    utils.invokeCallback(cb);
    return;
  }
  var comp = comps[index];
  if (typeof comp.stop === 'function') {
    comp.stop(force, function() {
      // ignore any error
      module.exports.stopComps(comps, index + 1, force, cb);
    });
  } else {
    module.exports.stopComps(comps, index + 1, force, cb);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var cancelShutDownTimer =function(){
    if(!!self.stopTimer) {
      clearTimeout(self.stopTimer);
    }
};
var shutDown = function() {
  appUtil.<span class="apidocCodeKeywordSpan">stopComps</span>(self.loaded, 0, force, function() {
    cancelShutDownTimer();
    if(force) {
      process.exit(0);
    }
  });
};
var fun = this.get(Constants.KEYWORDS.BEFORE_STOP_HOOK);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.application" id="apidoc.module.pomelo.application">module pomelo.application</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.application.addCrons" id="apidoc.element.pomelo.application.addCrons">
        function <span class="apidocSignatureSpan">pomelo.application.</span>addCrons
        <span class="apidocSignatureSpan">(crons)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addCrons = function (crons) {
  if(!crons || !crons.length) {
    logger.warn('crons is not defined.');
    return;
  }
  this.event.emit(events.ADD_CRONS, crons);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (agent.type !== 'master') {
    setTimeout(function() {
      process.exit(-1);
    }, Constants.TIME.TIME_WAIT_MONITOR_KILL);
  }
  break;
case 'addCron':
  this.app.<span class="apidocCodeKeywordSpan">addCrons</span>([msg.cron]);
  break;
case 'removeCron':
  this.app.removeCrons([msg.cron]);
  break;
case 'blacklist':
  if(this.app.isFrontend()) {
    var connector = this.app.components.__connector__;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.addServers" id="apidoc.element.pomelo.application.addServers">
        function <span class="apidocSignatureSpan">pomelo.application.</span>addServers
        <span class="apidocSignatureSpan">(servers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addServers = function (servers) {
  if(!servers || !servers.length) {
    return;
  }

  var item, slist;
  for(var i=0, l=servers.length; i&lt;l; i++) {
    item = servers[i];
    // update global server map
    this.servers[item.id] = item;

    // update global server type map
    slist = this.serverTypeMaps[item.serverType];
    if(!slist) {
      this.serverTypeMaps[item.serverType] = slist = [];
    }
    replaceServer(slist, item);

    // update global server type list
    if(this.serverTypes.indexOf(item.serverType) &lt; 0) {
      this.serverTypes.push(item.serverType);
    }
  }
  this.event.emit(events.ADD_SERVERS, servers);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
pro.addServers = function(servers) {
 if (!servers || !servers.length) {
   return;
 }

 genProxies(this.client, this.app, servers);
 this.client.<span class="apidocCodeKeywordSpan">addServers</span>(servers);
};

/**
* Remove remote server from the rpc client.
*
* @param  {Array} ids server id list
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.after" id="apidoc.element.pomelo.application.after">
        function <span class="apidocSignatureSpan">pomelo.application.</span>after
        <span class="apidocSignatureSpan">(af)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">after = function (af) {
  addFilter(this, Constants.KEYWORDS.AFTER_FILTER, af);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.filter = function (filter) {
 this.before(filter);
 this.<span class="apidocCodeKeywordSpan">after</span>(filter);
};

/**
* Add before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
* @memberOf Application
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.afterStart" id="apidoc.element.pomelo.application.afterStart">
        function <span class="apidocSignatureSpan">pomelo.application.</span>afterStart
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">afterStart = function (cb) {
  if(this.state !== STATE_START) {
    utils.invokeCallback(cb, new Error('application is not running now.'));
    return;
  }

  var afterFun = this.lifecycleCbs[Constants.LIFECYCLE.AFTER_STARTUP];
  var self = this;
  appUtil.optComponents(this.loaded, Constants.RESERVED.AFTER_START, function(err) {
    self.state = STATE_STARTED;
    var id = self.getServerId();
    if(!err) {
      logger.info('%j finish start', id);
    }
    if(!!afterFun) {
      afterFun.call(null, self, function() {
        utils.invokeCallback(cb, err);
      });
    } else {
      utils.invokeCallback(cb, err);
    }
    var usedTime = Date.now() - self.startTime;
    logger.info('%j startup in %s ms', id, usedTime);
    self.event.emit(events.START_SERVER, id);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var startUp = function() {
  appUtil.optComponents(self.loaded, Constants.RESERVED.START, function(err) {
    self.state = STATE_START;
    if(err) {
      utils.invokeCallback(cb, err);
    } else {
      logger.info('%j enter after start...', self.getServerId());
      self.<span class="apidocCodeKeywordSpan">afterStart</span>(cb);
    }
  });
};
var beforeFun = self.lifecycleCbs[Constants.LIFECYCLE.BEFORE_STARTUP];
if(!!beforeFun) {
  beforeFun.call(null, self, startUp);
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.before" id="apidoc.element.pomelo.application.before">
        function <span class="apidocSignatureSpan">pomelo.application.</span>before
        <span class="apidocSignatureSpan">(bf)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">before = function (bf) {
  addFilter(this, Constants.KEYWORDS.BEFORE_FILTER, bf);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* add a filter to before and after filter
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.filter = function (filter) {
 this.<span class="apidocCodeKeywordSpan">before</span>(filter);
 this.after(filter);
};

/**
* Add before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.beforeStopHook" id="apidoc.element.pomelo.application.beforeStopHook">
        function <span class="apidocSignatureSpan">pomelo.application.</span>beforeStopHook
        <span class="apidocSignatureSpan">(fun)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beforeStopHook = function (fun) {
  logger.warn('this method was deprecated in pomelo 0.8');
  if(!!fun &amp;&amp; typeof fun === 'function') {
    this.set(Constants.KEYWORDS.BEFORE_STOP_HOOK, fun);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.configure" id="apidoc.element.pomelo.application.configure">
        function <span class="apidocSignatureSpan">pomelo.application.</span>configure
        <span class="apidocSignatureSpan">(env, type, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configure = function (env, type, fn) {
  var args = [].slice.call(arguments);
  fn = args.pop();
  env = type = Constants.RESERVED.ALL;

  if(args.length &gt; 0) {
    env = args[0];
  }
  if(args.length &gt; 1) {
    type = args[1];
  }

  if (env === Constants.RESERVED.ALL || contains(this.settings.env, env)) {
    if (type === Constants.RESERVED.ALL || contains(this.settings.serverType, type)) {
      fn.call(this);
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Application.configureLogger = function(logger) {
  if (process.env.POMELO_LOGGER !== 'off') {
    var base = this.getBase();
    var env = this.get(Constants.RESERVED.ENV);
    var originPath = path.join(base, Constants.FILEPATH.LOG);
    var presentPath = path.join(base, Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.LOG));
    if(fs.existsSync(originPath)) {
      logger.<span class="apidocCodeKeywordSpan">configure</span>(originPath, {serverId: this.serverId, base: base});
    } else if(fs.existsSync(presentPath)) {
      logger.configure(presentPath, {serverId: this.serverId, base: base});
    } else {
      logger.error('logger file path configuration is error.');
    }
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.configureLogger" id="apidoc.element.pomelo.application.configureLogger">
        function <span class="apidocSignatureSpan">pomelo.application.</span>configureLogger
        <span class="apidocSignatureSpan">(logger)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">configureLogger = function (logger) {
  if (process.env.POMELO_LOGGER !== 'off') {
    var base = this.getBase();
    var env = this.get(Constants.RESERVED.ENV);
    var originPath = path.join(base, Constants.FILEPATH.LOG);
    var presentPath = path.join(base, Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.LOG));
    if(fs.existsSync(originPath)) {
      logger.configure(originPath, {serverId: this.serverId, base: base});
    } else if(fs.existsSync(presentPath)) {
      logger.configure(presentPath, {serverId: this.serverId, base: base});
    } else {
      logger.error('logger file path configuration is error.');
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.disable" id="apidoc.element.pomelo.application.disable">
        function <span class="apidocSignatureSpan">pomelo.application.</span>disable
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disable = function (setting) {
  return this.set(setting, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.disabled" id="apidoc.element.pomelo.application.disabled">
        function <span class="apidocSignatureSpan">pomelo.application.</span>disabled
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disabled = function (setting) {
  return !this.get(setting);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.enable" id="apidoc.element.pomelo.application.enable">
        function <span class="apidocSignatureSpan">pomelo.application.</span>enable
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">enable = function (setting) {
  return this.set(setting, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.enabled" id="apidoc.element.pomelo.application.enabled">
        function <span class="apidocSignatureSpan">pomelo.application.</span>enabled
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">enabled = function (setting) {
  return !!this.get(setting);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // proxy default config
  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  opts.router = genRouteFun();
  opts.context = app;
  opts.routeContext = app;
  if (app.<span class="apidocCodeKeywordSpan">enabled</span>('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }

  return new Component(app, opts);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.filter" id="apidoc.element.pomelo.application.filter">
        function <span class="apidocSignatureSpan">pomelo.application.</span>filter
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filter = function (filter) {
  this.before(filter);
  this.after(filter);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param  {String} appBase application base path
 * @return {Array}         all the subdiretory name under servers/
 */
exp.listUserRemoteDir = function(appBase) {
  var base = path.join(appBase, '/app/servers/');
  var files = fs.readdirSync(base);
  return files.<span class="apidocCodeKeywordSpan">filter</span>(function(fn) {
    if(fn.charAt(0) === '.') {
      return false;
    }

    return fs.statSync(path.join(base, fn)).isDirectory();
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.get" id="apidoc.element.pomelo.application.get">
        function <span class="apidocSignatureSpan">pomelo.application.</span>get
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (setting) {
  return this.settings[setting];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*  // app.getBase() -&gt; /home/game
*
* @return {String} application base path
*
* @memberOf Application
*/
Application.getBase = function() {
 return this.<span class="apidocCodeKeywordSpan">get</span>(Constants.RESERVED.BASE);
};

/**
* Override require method in application
*
* @param {String} relative path of file
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getBase" id="apidoc.element.pomelo.application.getBase">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getBase
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getBase = function () {
  return this.get(Constants.RESERVED.BASE);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
 * Get application base path
 *
 *  // cwd: /home/game/
 *  pomelo start
 *  // app.<span class="apidocCodeKeywordSpan">getBase</span>() -&gt; /home/game
 *
 * @return {String} application base path
 *
 * @memberOf Application
 */
Application.getBase = function() {
return this.get(Constants.RESERVED.BASE);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getCurServer" id="apidoc.element.pomelo.application.getCurServer">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getCurServer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCurServer = function () {
  return this.curServer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param  {server}  server server info. it would check current server
*            if server not specified
* @return {Boolean}
*
* @memberOf Application
*/
Application.isFrontend = function(server) {
 server = server || this.<span class="apidocCodeKeywordSpan">getCurServer</span>();
 return !!server &amp;&amp; server.frontend === 'true';
};

/**
* Check the server whether is a backend server
*
* @param  {server}  server server info. it would check current server
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getMaster" id="apidoc.element.pomelo.application.getMaster">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getMaster
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMaster = function () {
  return this.master;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
 * Process server start command
 */
var processArgs = function(app, args) {
var serverType = args.serverType || Constants.RESERVED.MASTER;
var serverId = args.id || app.<span class="apidocCodeKeywordSpan">getMaster</span>().id;
var mode = args.mode || Constants.RESERVED.CLUSTER;
var masterha = args.masterha || 'false';
var type = args.type || Constants.RESERVED.ALL;
var startId = args.startId;

app.set(Constants.RESERVED.MAIN, args.main, true);
app.set(Constants.RESERVED.SERVER_TYPE, serverType, true);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServerById" id="apidoc.element.pomelo.application.getServerById">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServerById
        <span class="apidocSignatureSpan">(serverId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServerById = function (serverId) {
  return this.servers[serverId];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServerFromConfig" id="apidoc.element.pomelo.application.getServerFromConfig">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServerFromConfig
        <span class="apidocSignatureSpan">(serverId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServerFromConfig = function (serverId) {
  return this.get(Constants.KEYWORDS.SERVER_MAP)[serverId];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case Constants.RESERVED.ALL:
servers = app.getServersFromConfig();
for (var serverId in servers) {
  this.run(app, servers[serverId]);
}
break;
default:
server = app.<span class="apidocCodeKeywordSpan">getServerFromConfig</span>(condition);
if(!!server) {
  this.run(app, server);
} else {
  servers = app.get(Constants.RESERVED.SERVERS)[condition];
  for(var i=0; i&lt;servers.length; i++) {
    this.run(app, servers[i]);
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServerId" id="apidoc.element.pomelo.application.getServerId">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServerId
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServerId = function () {
  return this.serverId;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 this.serverTypes = [];      // current global server type list
 this.lifecycleCbs = {};     // current server custom lifecycle callbacks
 this.clusterSeq = {};       // cluster id seqence

 appUtil.defaultConfiguration(this);

 this.state = STATE_INITED;
 logger.info('application inited: %j', this.<span class="apidocCodeKeywordSpan">getServerId</span>());
};

/**
* Get application base path
*
*  // cwd: /home/game/
*  pomelo start
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServerType" id="apidoc.element.pomelo.application.getServerType">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServerType
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServerType = function () {
  return this.serverType;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// master server should not come here
if(app.isFrontend()) {
  role = 'frontend';
} else {
  role = 'backend';
}

var sysPath = pathUtil.getSysRemotePath(role), serverType = app.<span class="apidocCodeKeywordSpan">getServerType</span>();
if(fs.existsSync(sysPath)) {
  paths.push(pathUtil.remotePathRecord('sys', serverType, sysPath));
}
var userPath = pathUtil.getUserRemotePath(app.getBase(), serverType);
if(fs.existsSync(userPath)) {
  paths.push(pathUtil.remotePathRecord('user', serverType, userPath));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServerTypes" id="apidoc.element.pomelo.application.getServerTypes">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServerTypes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServerTypes = function () {
  return this.serverTypes;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServers" id="apidoc.element.pomelo.application.getServers">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServers
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServers = function () {
  return this.servers;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  agent.request(record.id, module.exports.moduleId, { signal: msg.signal }, agentRequestCallback);
}
};

var stop = function(app, agent, msg, cb) {
var serverIds = msg.ids;
if(!!serverIds.length) {
  var servers = app.<span class="apidocCodeKeywordSpan">getServers</span>();
  app.set(Constants.RESERVED.STOP_SERVERS, serverIds);
  for(var i=0; i&lt;serverIds.length; i++) {
    var serverId = serverIds[i];
    if(!servers[serverId]) {
      utils.invokeCallback(cb, new Error('Cannot find the server to stop.'), null);
    } else {
      agent.notifyById(serverId, module.exports.moduleId, { signal: msg.signal });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServersByType" id="apidoc.element.pomelo.application.getServersByType">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServersByType
        <span class="apidocSignatureSpan">(serverType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServersByType = function (serverType) {
  return this.serverTypeMaps[serverType];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* Examples:
*
*  app.route('area', routeFunc);
*
*  var routeFunc = function(session, msg, app, cb) {
*    // all request to area would be route to the first area server
*    var areas = app.<span class="apidocCodeKeywordSpan">getServersByType</span>('area');
*    cb(null, areas[0].id);
*  };
*
* @param  {String} serverType server type string
* @param  {Function} routeFunc  route function. routeFunc(session, msg, app, cb)
* @return {Object}     current application instance for chain invoking
* @memberOf Application
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.getServersFromConfig" id="apidoc.element.pomelo.application.getServersFromConfig">
        function <span class="apidocSignatureSpan">pomelo.application.</span>getServersFromConfig
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getServersFromConfig = function () {
  return this.get(Constants.KEYWORDS.SERVER_MAP);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 starter.runServers = function(app) {
var server, servers;
var condition = app.startId || app.type;
switch(condition) {
  case Constants.RESERVED.MASTER:
  break;
  case Constants.RESERVED.ALL:
  servers = app.<span class="apidocCodeKeywordSpan">getServersFromConfig</span>();
  for (var serverId in servers) {
    this.run(app, servers[serverId]);
  }
  break;
  default:
  server = app.getServerFromConfig(condition);
  if(!!server) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.globalAfter" id="apidoc.element.pomelo.application.globalAfter">
        function <span class="apidocSignatureSpan">pomelo.application.</span>globalAfter
        <span class="apidocSignatureSpan">(af)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">globalAfter = function (af) {
  addFilter(this, Constants.KEYWORDS.GLOBAL_AFTER_FILTER, af);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.globalFilter = function (filter) {
 this.globalBefore(filter);
 this.<span class="apidocCodeKeywordSpan">globalAfter</span>(filter);
};

/**
* Add global before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
* @memberOf Application
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.globalBefore" id="apidoc.element.pomelo.application.globalBefore">
        function <span class="apidocSignatureSpan">pomelo.application.</span>globalBefore
        <span class="apidocSignatureSpan">(bf)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">globalBefore = function (bf) {
  addFilter(this, Constants.KEYWORDS.GLOBAL_BEFORE_FILTER, bf);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* add a global filter to before and after global filter
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.globalFilter = function (filter) {
 this.<span class="apidocCodeKeywordSpan">globalBefore</span>(filter);
 this.globalAfter(filter);
};

/**
* Add global before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.globalFilter" id="apidoc.element.pomelo.application.globalFilter">
        function <span class="apidocSignatureSpan">pomelo.application.</span>globalFilter
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">globalFilter = function (filter) {
  this.globalBefore(filter);
  this.globalAfter(filter);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.init" id="apidoc.element.pomelo.application.init">
        function <span class="apidocSignatureSpan">pomelo.application.</span>init
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (opts) {
  opts = opts || {};
  this.loaded = [];       // loaded component list
  this.components = {};   // name -&gt; component map
  this.settings = {};     // collection keep set/get
  var base = opts.base || path.dirname(require.main.filename);
  this.set(Constants.RESERVED.BASE, base, true);
  this.event = new EventEmitter();  // event object to sub/pub events

  // current server info
  this.serverId = null;   // current server id
  this.serverType = null; // current server type
  this.curServer = null;  // current server info
  this.startTime = null; // current server start time

  // global server infos
  this.master = null;         // master server info
  this.servers = {};          // current global server info maps, id -&gt; info
  this.serverTypeMaps = {};   // current global type maps, type -&gt; [info]
  this.serverTypes = [];      // current global server type list
  this.lifecycleCbs = {};     // current server custom lifecycle callbacks
  this.clusterSeq = {};       // cluster id seqence

  appUtil.defaultConfiguration(this);

  this.state = STATE_INITED;
  logger.info('application inited: %j', this.getServerId());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @return {Application}
* @memberOf Pomelo
* @api public
*/
Pomelo.createApp = function (opts) {
 var app = application;
 app.<span class="apidocCodeKeywordSpan">init</span>(opts);
 self.app = app;
 return app;
};

/**
* Get application
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.isBackend" id="apidoc.element.pomelo.application.isBackend">
        function <span class="apidocSignatureSpan">pomelo.application.</span>isBackend
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isBackend = function (server) {
  server = server || this.getCurServer();
  return !!server &amp;&amp; !server.frontend;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.isFrontend" id="apidoc.element.pomelo.application.isFrontend">
        function <span class="apidocSignatureSpan">pomelo.application.</span>isFrontend
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isFrontend = function (server) {
  server = server || this.getCurServer();
  return !!server &amp;&amp; server.frontend === 'true';
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {Array}     remote path record array
 */
var getProxyRecords = function(app, sinfo) {
var records = [],
  appBase = app.getBase(),
  record;
// sys remote service path record
if (app.<span class="apidocCodeKeywordSpan">isFrontend</span>(sinfo)) {
  record = pathUtil.getSysRemotePath('frontend');
} else {
  record = pathUtil.getSysRemotePath('backend');
}
if (record) {
  records.push(pathUtil.remotePathRecord('sys', sinfo.serverType, record));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.isMaster" id="apidoc.element.pomelo.application.isMaster">
        function <span class="apidocSignatureSpan">pomelo.application.</span>isMaster
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isMaster = function () {
  return this.serverType === Constants.RESERVED.MASTER;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.load" id="apidoc.element.pomelo.application.load">
        function <span class="apidocSignatureSpan">pomelo.application.</span>load
        <span class="apidocSignatureSpan">(name, component, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">load = function (name, component, opts) {
  if(typeof name !== 'string') {
    opts = component;
    component = name;
    name = null;
    if(typeof component.name === 'string') {
      name = component.name;
    }
  }

  if(typeof component === 'function') {
    component = component(this, opts);
  }

  if(!name &amp;&amp; typeof component.name === 'string') {
    name = component.name;
  }

  if(name &amp;&amp; this.components[name]) {
    // ignore duplicat component
    logger.warn('ignore duplicate component: %j', name);
    return;
  }

  this.loaded.push(component);
  if(name) {
    // components with a name would get by name throught app.components later.
    this.components[name] = component;
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  var name = path.basename(filename, '.js');
  var param = opts[name] || {};
  var absolutePath = path.join(dir, Constants.DIR.COMPONENT, filename);
  if(!fs.existsSync(absolutePath)) {
    logger.error('component %s not exist at %s', name, absolutePath);
  } else {
    self.<span class="apidocCodeKeywordSpan">load</span>(require(absolutePath), param);
  }
});

// load events
if(!plugin.events) {
  return;
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.loadConfig" id="apidoc.element.pomelo.application.loadConfig">
        function <span class="apidocSignatureSpan">pomelo.application.</span>loadConfig
        <span class="apidocSignatureSpan">(key, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfig = function (key, val) {
  var env = this.get(Constants.RESERVED.ENV);
  val = require(val);
  if (val[env]) {
    val = val[env];
  }
  this.set(key, val);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.loadConfigBaseApp" id="apidoc.element.pomelo.application.loadConfigBaseApp">
        function <span class="apidocSignatureSpan">pomelo.application.</span>loadConfigBaseApp
        <span class="apidocSignatureSpan">(key, val, reload)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfigBaseApp = function (key, val, reload) {
  var self = this;
  var env = this.get(Constants.RESERVED.ENV);
  var originPath = path.join(Application.getBase(), val);
  var presentPath = path.join(Application.getBase(), Constants.FILEPATH.CONFIG_DIR, env, path.basename(val));
  var realPath;
  if(fs.existsSync(originPath)) {
     realPath = originPath;
     var file = require(originPath);
     if (file[env]) {
       file = file[env];
     }
     this.set(key, file);
  } else if(fs.existsSync(presentPath)) {
    realPath = presentPath;
    var pfile = require(presentPath);
    this.set(key, pfile);
  } else {
    logger.error('invalid configuration with file path: %s', key);
  }

  if(!!realPath &amp;&amp; !!reload) {
    fs.watch(realPath, function (event, filename) {
      if(event === 'change') {
        delete require.cache[require.resolve(realPath)];
        self.loadConfigBaseApp(key, val);
      }
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   logger.error('invalid configuration with file path: %s', key);
 }

 if(!!realPath &amp;&amp; !!reload) {
   fs.watch(realPath, function (event, filename) {
     if(event === 'change') {
       delete require.cache[require.resolve(realPath)];
       self.<span class="apidocCodeKeywordSpan">loadConfigBaseApp</span>(key, val);
     }
   });
 }
};

/**
* Load Configure json file to settings.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.registerAdmin" id="apidoc.element.pomelo.application.registerAdmin">
        function <span class="apidocSignatureSpan">pomelo.application.</span>registerAdmin
        <span class="apidocSignatureSpan">(moduleId, module, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">registerAdmin = function (moduleId, module, opts) {
  var modules = this.get(Constants.KEYWORDS.MODULE);
  if(!modules) {
    modules = {};
    this.set(Constants.KEYWORDS.MODULE, modules);
  }

  if(typeof moduleId !== 'string') {
    opts = module;
    module = moduleId;
    if(module) {
      moduleId = module.moduleId;
    }
  }

  if(!moduleId){
    return;
  }

  modules[moduleId] = {
    moduleId: moduleId,
    module: module,
    opts: opts
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Append the default system admin modules
 */
pro.registerDefaultModules = function(isMaster, app, closeWatcher) {
if(!closeWatcher) {
  if(isMaster) {
    app.<span class="apidocCodeKeywordSpan">registerAdmin</span>(require('../modules/masterwatcher'), {app: app});
  } else {
    app.registerAdmin(require('../modules/monitorwatcher'), {app: app});
  }
}
app.registerAdmin(admin.modules.watchServer,{app:app});
app.registerAdmin(require('../modules/console'), {app: app, starter: starter});
if(app.enabled('systemMonitor')) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.removeCrons" id="apidoc.element.pomelo.application.removeCrons">
        function <span class="apidocSignatureSpan">pomelo.application.</span>removeCrons
        <span class="apidocSignatureSpan">(crons)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeCrons = function (crons) {
  if(!crons || !crons.length) {
    logger.warn('ids is not defined.');
    return;
  }
  this.event.emit(events.REMOVE_CRONS, crons);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }, Constants.TIME.TIME_WAIT_MONITOR_KILL);
  }
  break;
case 'addCron':
  this.app.addCrons([msg.cron]);
  break;
case 'removeCron':
  this.app.<span class="apidocCodeKeywordSpan">removeCrons</span>([msg.cron]);
  break;
case 'blacklist':
  if(this.app.isFrontend()) {
    var connector = this.app.components.__connector__;
    connector.blacklist = connector.blacklist.concat(msg.blacklist);
  }
  break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.removeServers" id="apidoc.element.pomelo.application.removeServers">
        function <span class="apidocSignatureSpan">pomelo.application.</span>removeServers
        <span class="apidocSignatureSpan">(ids)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeServers = function (ids) {
  if(!ids || !ids.length) {
    return;
  }

  var id, item, slist;
  for(var i=0, l=ids.length; i&lt;l; i++) {
    id = ids[i];
    item = this.servers[id];
    if(!item) {
      continue;
    }
    // clean global server map
    delete this.servers[id];

    // clean global server type map
    slist = this.serverTypeMaps[item.serverType];
    removeServer(slist, id);
    // TODO: should remove the server type if the slist is empty?
  }
  this.event.emit(events.REMOVE_SERVERS, ids);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Remove remote server from the rpc client.
*
* @param  {Array} ids server id list
*/
pro.removeServers = function(ids) {
 this.client.<span class="apidocCodeKeywordSpan">removeServers</span>(ids);
};

/**
* Replace remote servers from the rpc client.
*
* @param  {Array} ids server id list
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.replaceServers" id="apidoc.element.pomelo.application.replaceServers">
        function <span class="apidocSignatureSpan">pomelo.application.</span>replaceServers
        <span class="apidocSignatureSpan">(servers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replaceServers = function (servers) {
  if(!servers){
    return;
  }

  this.servers = servers;
  this.serverTypeMaps = {};
  this.serverTypes = [];
  var serverArray = [];
  for(var id in servers){
    var server = servers[id];
    var serverType = server[Constants.RESERVED.SERVER_TYPE];
    var slist = this.serverTypeMaps[serverType];
    if(!slist) {
      this.serverTypeMaps[serverType] = slist = [];
    }
    this.serverTypeMaps[serverType].push(server);
    // update global server type list
    if(this.serverTypes.indexOf(serverType) &lt; 0) {
      this.serverTypes.push(serverType);
    }
    serverArray.push(server);
  }
  this.event.emit(events.REPLACE_SERVERS, serverArray);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   return;
 }

 // update proxies
 this.client.proxies = {};
 genProxies(this.client, this.app, servers);

 this.client.<span class="apidocCodeKeywordSpan">replaceServers</span>(servers);
};

/**
* Proxy for rpc client rpcInvoke.
*
* @param {String}   serverId remote server id
* @param {Object}   msg      rpc message: {serverType: serverType, service: serviceName, method: methodName, args: arguments}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.require" id="apidoc.element.pomelo.application.require">
        function <span class="apidocSignatureSpan">pomelo.application.</span>require
        <span class="apidocSignatureSpan">(ph)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">require = function (ph) {
  return require(path.join(Application.getBase(), ph));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.route" id="apidoc.element.pomelo.application.route">
        function <span class="apidocSignatureSpan">pomelo.application.</span>route
        <span class="apidocSignatureSpan">(serverType, routeFunc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">route = function (serverType, routeFunc) {
  var routes = this.get(Constants.KEYWORDS.ROUTE);
  if(!routes) {
    routes = {};
    this.set(Constants.KEYWORDS.ROUTE, routes);
  }
  routes[serverType] = routeFunc;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
* Set the route function for the specified server type.
*
* Examples:
*
*  app.<span class="apidocCodeKeywordSpan">route</span>('area', routeFunc);
*
*  var routeFunc = function(session, msg, app, cb) {
*    // all request to area would be route to the first area server
*    var areas = app.getServersByType('area');
*    cb(null, areas[0].id);
*  };
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.rpcAfter" id="apidoc.element.pomelo.application.rpcAfter">
        function <span class="apidocSignatureSpan">pomelo.application.</span>rpcAfter
        <span class="apidocSignatureSpan">(af)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rpcAfter = function (af) {
  addFilter(this, Constants.KEYWORDS.RPC_AFTER_FILTER, af);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.rpcFilter = function(filter) {
 this.rpcBefore(filter);
 this.<span class="apidocCodeKeywordSpan">rpcAfter</span>(filter);
};

/**
* Load component
*
* @param  {String} name    (optional) name of the component
* @param  {Object} component component instance or factory function of the component
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.rpcBefore" id="apidoc.element.pomelo.application.rpcBefore">
        function <span class="apidocSignatureSpan">pomelo.application.</span>rpcBefore
        <span class="apidocSignatureSpan">(bf)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rpcBefore = function (bf) {
  addFilter(this, Constants.KEYWORDS.RPC_BEFORE_FILTER, bf);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* add a rpc filter to before and after rpc filter
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.rpcFilter = function(filter) {
 this.<span class="apidocCodeKeywordSpan">rpcBefore</span>(filter);
 this.rpcAfter(filter);
};

/**
* Load component
*
* @param  {String} name    (optional) name of the component
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.rpcFilter" id="apidoc.element.pomelo.application.rpcFilter">
        function <span class="apidocSignatureSpan">pomelo.application.</span>rpcFilter
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rpcFilter = function (filter) {
  this.rpcBefore(filter);
  this.rpcAfter(filter);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Proxy component lifecycle function
 *
 * @param {Function} cb
 * @return {Void}
 */
pro.start = function(cb) {
if(this.opts.enableRpcLog) {
  logger.warn('enableRpcLog is deprecated in 0.8.0, please use app.<span class="apidocCodeKeywordSpan">rpcFilter</span>(pomelo
.rpcFilters.rpcLog())');
}
var rpcBefores = this.app.get(Constants.KEYWORDS.RPC_BEFORE_FILTER);
var rpcAfters = this.app.get(Constants.KEYWORDS.RPC_AFTER_FILTER);
var rpcErrorHandler = this.app.get(Constants.RESERVED.RPC_ERROR_HANDLER);

if(!!rpcBefores) {
  this.client.before(rpcBefores);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.set" id="apidoc.element.pomelo.application.set">
        function <span class="apidocSignatureSpan">pomelo.application.</span>set
        <span class="apidocSignatureSpan">(setting, val, attach)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (setting, val, attach) {
  if (arguments.length === 1) {
    return this.settings[setting];
  }
  this.settings[setting] = val;
  if(attach) {
    this[setting] = val;
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
Application.init = function(opts) {
opts = opts || {};
this.loaded = [];       // loaded component list
this.components = {};   // name -&gt; component map
this.settings = {};     // collection keep set/get
var base = opts.base || path.dirname(require.main.filename);
this.<span class="apidocCodeKeywordSpan">set</span>(Constants.RESERVED.BASE, base, true);
this.event = new EventEmitter();  // event object to sub/pub events

// current server info
this.serverId = null;   // current server id
this.serverType = null; // current server type
this.curServer = null;  // current server info
this.startTime = null; // current server start time
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.start" id="apidoc.element.pomelo.application.start">
        function <span class="apidocSignatureSpan">pomelo.application.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  this.startTime = Date.now();
  if(this.state &gt; STATE_INITED) {
    utils.invokeCallback(cb, new Error('application has already start.'));
    return;
  }

  var self = this;
  appUtil.startByType(self, function() {
    appUtil.loadDefaultComponents(self);
    var startUp = function() {
      appUtil.optComponents(self.loaded, Constants.RESERVED.START, function(err) {
        self.state = STATE_START;
        if(err) {
          utils.invokeCallback(cb, err);
        } else {
          logger.info('%j enter after start...', self.getServerId());
          self.afterStart(cb);
        }
      });
    };
    var beforeFun = self.lifecycleCbs[Constants.LIFECYCLE.BEFORE_STARTUP];
    if(!!beforeFun) {
      beforeFun.call(null, self, startUp);
    } else {
      startUp();
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.stop" id="apidoc.element.pomelo.application.stop">
        function <span class="apidocSignatureSpan">pomelo.application.</span>stop
        <span class="apidocSignatureSpan">(force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function (force) {
  if(this.state &gt; STATE_STARTED) {
    logger.warn('[pomelo application] application is not running now.');
    return;
  }
  this.state = STATE_STOPED;
  var self = this;

  this.stopTimer = setTimeout(function() {
    process.exit(0);
  }, Constants.TIME.TIME_WAIT_STOP);

  var cancelShutDownTimer =function(){
      if(!!self.stopTimer) {
        clearTimeout(self.stopTimer);
      }
  };
  var shutDown = function() {
    appUtil.stopComps(self.loaded, 0, force, function() {
      cancelShutDownTimer();
      if(force) {
        process.exit(0);
      }
    });
  };
  var fun = this.get(Constants.KEYWORDS.BEFORE_STOP_HOOK);
  var stopFun = this.lifecycleCbs[Constants.LIFECYCLE.BEFORE_SHUTDOWN];
  if(!!stopFun) {
    stopFun.call(null, this, shutDown, cancelShutDownTimer);
  } else if(!!fun) {
    utils.invokeCallback(fun, self, shutDown, cancelShutDownTimer);
  } else {
    shutDown();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.transaction" id="apidoc.element.pomelo.application.transaction">
        function <span class="apidocSignatureSpan">pomelo.application.</span>transaction
        <span class="apidocSignatureSpan">(name, conditions, handlers, retry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">transaction = function (name, conditions, handlers, retry) {
  appManager.transaction(name, conditions, handlers, retry);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {String} name transaction name
* @param {Object} conditions functions which are called before transaction
* @param {Object} handlers functions which are called during transaction
* @param {Number} retry retry times to execute handlers if conditions are successfully executed
* @memberOf Application
*/
Application.transaction = function(name, conditions, handlers, retry) {
 appManager.<span class="apidocCodeKeywordSpan">transaction</span>(name, conditions, handlers, retry);
};

/**
* Get master server info.
*
* @return {Object} master server info, {id, host, port}
* @memberOf Application
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.application.use" id="apidoc.element.pomelo.application.use">
        function <span class="apidocSignatureSpan">pomelo.application.</span>use
        <span class="apidocSignatureSpan">(plugin, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">use = function (plugin, opts) {
  if(!plugin.components) {
    logger.error('invalid components, no components exist');
    return;
  }

  var self = this;
  opts = opts || {};
  var dir = path.dirname(plugin.components);

  if(!fs.existsSync(plugin.components)) {
    logger.error('fail to find components, find path: %s', plugin.components);
    return;
  }

  fs.readdirSync(plugin.components).forEach(function (filename) {
    if (!/\.js$/.test(filename)) {
      return;
    }
    var name = path.basename(filename, '.js');
    var param = opts[name] || {};
    var absolutePath = path.join(dir, Constants.DIR.COMPONENT, filename);
    if(!fs.existsSync(absolutePath)) {
      logger.error('component %s not exist at %s', name, absolutePath);
    } else {
      self.load(require(absolutePath), param);
    }
  });

  // load events
  if(!plugin.events) {
    return;
  } else {
    if(!fs.existsSync(plugin.events)) {
      logger.error('fail to find events, find path: %s', plugin.events);
      return;
    }

    fs.readdirSync(plugin.events).forEach(function (filename) {
      if (!/\.js$/.test(filename)) {
        return;
      }
      var absolutePath = path.join(dir, Constants.DIR.EVENT, filename);
      if(!fs.existsSync(absolutePath)) {
        logger.error('events %s not exist at %s', filename, absolutePath);
      } else {
        bindEvents(require(absolutePath), self);
      }
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.backendSessionService" id="apidoc.module.pomelo.backendSessionService">module pomelo.backendSessionService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.backendSessionService" id="apidoc.element.pomelo.backendSessionService.backendSessionService">
        function <span class="apidocSignatureSpan">pomelo.</span>backendSessionService
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">backendSessionService = function (app) {
  this.app = app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.backendSessionService.prototype" id="apidoc.module.pomelo.backendSessionService.prototype">module pomelo.backendSessionService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.bind" id="apidoc.element.pomelo.backendSessionService.prototype.bind">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>bind
        <span class="apidocSignatureSpan">(frontendId, sid, uid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bind = function (frontendId, sid, uid, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'bind';
  var args = [sid, uid];
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 return false;
};

var bindEvents = function(Event, app) {
 var emethods = new Event(app);
 for(var m in emethods) {
   if(typeof emethods[m] === 'function') {
     app.event.on(m, emethods[m].<span class="apidocCodeKeywordSpan">bind</span>(emethods));
   }
 }
};

var addFilter = function(app, type, filter) {
var filters = app.get(type);
 if(!filters) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.create" id="apidoc.element.pomelo.backendSessionService.prototype.create">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>create
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (opts) {
  if(!opts) {
    throw new Error('opts should not be empty.');
  }
  return new BackendSession(opts, this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var app = self.app,
  sid = socket.id;
var session = self.session.get(sid);
if (session) {
  return session;
}

session = self.session.<span class="apidocCodeKeywordSpan">create</span>(sid, app.getServerId(), socket);
logger.debug('[%s] getSession session is created with session id: %s', app.getServerId(), sid);

// bind events for session
socket.on('disconnect', session.closed.bind(session));
socket.on('error', session.closed.bind(session));
session.on('closed', onSessionClose.bind(null, app));
session.on('bind', function(uid) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.get" id="apidoc.element.pomelo.backendSessionService.prototype.get">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>get
        <span class="apidocSignatureSpan">(frontendId, sid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (frontendId, sid, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'getBackendSessionBySid';
  var args = [sid];
  rpcInvoke(this.app, frontendId, namespace, service, method,
            args, BackendSessionCB.bind(null, this, cb));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*  // app.getBase() -&gt; /home/game
*
* @return {String} application base path
*
* @memberOf Application
*/
Application.getBase = function() {
 return this.<span class="apidocCodeKeywordSpan">get</span>(Constants.RESERVED.BASE);
};

/**
* Override require method in application
*
* @param {String} relative path of file
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.getByUid" id="apidoc.element.pomelo.backendSessionService.prototype.getByUid">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>getByUid
        <span class="apidocSignatureSpan">(frontendId, uid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getByUid = function (frontendId, uid, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'getBackendSessionsByUid';
  var args = [uid];
  rpcInvoke(this.app, frontendId, namespace, service, method,
            args, BackendSessionCB.bind(null, this, cb));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
SessionService.prototype.kick = function(uid, reason, cb) {
// compatible for old kick(uid, cb);
if(typeof reason === 'function') {
  cb = reason;
  reason = 'kick';
}
var sessions = this.<span class="apidocCodeKeywordSpan">getByUid</span>(uid);

if(sessions) {
  // notify client
  var sids = [];
  var self = this;
  sessions.forEach(function(session) {
    sids.push(session.id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.kickBySid" id="apidoc.element.pomelo.backendSessionService.prototype.kickBySid">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>kickBySid
        <span class="apidocSignatureSpan">(frontendId, sid, reason, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kickBySid = function (frontendId, sid, reason, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'kickBySid';
  var args = [sid];
  if(typeof reason === 'function') {
    cb = reason;
  }else{
    args.push(reason);
  }
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.kickByUid" id="apidoc.element.pomelo.backendSessionService.prototype.kickByUid">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>kickByUid
        <span class="apidocSignatureSpan">(frontendId, uid, reason, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kickByUid = function (frontendId, uid, reason, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'kickByUid';
  var args = [uid];
  if(typeof reason === 'function') {
    cb = reason;
  }else{
    args.push(reason);
  }
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.push" id="apidoc.element.pomelo.backendSessionService.prototype.push">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>push
        <span class="apidocSignatureSpan">(frontendId, sid, key, value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">push = function (frontendId, sid, key, value, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'push';
  var args = [sid, key, value];
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if(name &amp;&amp; this.components[name]) {
    // ignore duplicat component
    logger.warn('ignore duplicate component: %j', name);
    return;
  }

  this.loaded.<span class="apidocCodeKeywordSpan">push</span>(component);
  if(name) {
    // components with a name would get by name throught app.components later.
    this.components[name] = component;
  }

  return this;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.pushAll" id="apidoc.element.pomelo.backendSessionService.prototype.pushAll">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>pushAll
        <span class="apidocSignatureSpan">(frontendId, sid, settings, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushAll = function (frontendId, sid, settings, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'pushAll';
  var args = [sid, settings];
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Push all the key/values in backend session to the frontend internal session.
*
* @param  {Function} cb callback function
*/
BackendSession.prototype.pushAll = function(cb) {
 this.__sessionService__.<span class="apidocCodeKeywordSpan">pushAll</span>(this.frontendId, this.id, this.settings, cb);
};

/**
* Export the key/values for serialization.
*
* @api private
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.backendSessionService.prototype.unbind" id="apidoc.element.pomelo.backendSessionService.prototype.unbind">
        function <span class="apidocSignatureSpan">pomelo.backendSessionService.prototype.</span>unbind
        <span class="apidocSignatureSpan">(frontendId, sid, uid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbind = function (frontendId, sid, uid, cb) {
  var namespace = 'sys';
  var service = 'sessionRemote';
  var method = 'unbind';
  var args = [sid, uid];
  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param  {Number|String}   uid user id
 * @param  {Function} cb  callback function
 *
 * @memberOf BackendSession
 */
BackendSession.prototype.unbind = function(uid, cb) {
  var self = this;
  this.__sessionService__.<span class="apidocCodeKeywordSpan">unbind</span>(this.frontendId, this.id, uid, function(err) {
    if(!err) {
      self.uid = null;
    }
    utils.invokeCallback(cb, err);
  });
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.channelService" id="apidoc.module.pomelo.channelService">module pomelo.channelService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.channelService.channelService" id="apidoc.element.pomelo.channelService.channelService">
        function <span class="apidocSignatureSpan">pomelo.</span>channelService
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">channelService = function (app, opts) {
  opts = opts || {};
  this.app = app;
  this.channels = {};
  this.prefix = opts.prefix;
  this.store = opts.store;
  this.broadcastFilter = opts.broadcastFilter;
  this.channelRemote = new ChannelRemote(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.channelService.prototype" id="apidoc.module.pomelo.channelService.prototype">module pomelo.channelService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.broadcast" id="apidoc.element.pomelo.channelService.prototype.broadcast">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>broadcast
        <span class="apidocSignatureSpan">(stype, route, msg, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">broadcast = function (stype, route, msg, opts, cb) {
  var app = this.app;
  var namespace = 'sys';
  var service = 'channelRemote';
  var method = 'broadcast';
  var servers = app.getServersByType(stype);

  if(!servers || servers.length === 0) {
    // server list is empty
    utils.invokeCallback(cb);
    return;
  }

  var count = servers.length;
  var successFlag = false;

  var latch = countDownLatch.createCountDownLatch(count, function() {
    if(!successFlag) {
      utils.invokeCallback(cb, new Error('broadcast fails'));
      return;
    }
    utils.invokeCallback(cb, null);
  });

  var genCB = function(serverId) {
    return function(err) {
      if(err) {
        logger.error('[broadcast] fail to push message to serverId: ' + serverId + ', err:' + err.stack);
        latch.done();
        return;
      }
      successFlag = true;
      latch.done();
    };
  };

  var self = this;
  var sendMessage = function(serverId) {
    return (function() {
      if(serverId === app.serverId) {
        self.channelRemote[method](route, msg, opts, genCB());
      } else {
        app.rpcInvoke(serverId, {namespace: namespace, service: service,
          method: method, args: [route, msg, opts]}, genCB(serverId));
      }
    }());
  };

  opts = {type: 'broadcast', userOptions: opts || {}};

  // for compatiblity
  opts.isBroadcast = true;
  if(opts.userOptions) {
    opts.binded = opts.userOptions.binded;
    opts.filterParam = opts.userOptions.filterParam;
  }

  for(var i=0, l=count; i&lt;l; i++) {
    sendMessage(servers[i].id);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.createChannel" id="apidoc.element.pomelo.channelService.prototype.createChannel">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>createChannel
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createChannel = function (name) {
  if(this.channels[name]) {
    return this.channels[name];
  }

  var c = new Channel(name, this);
  addToStore(this, genKey(this), genKey(this, name));
  this.channels[name] = c;
  return c;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.destroyChannel" id="apidoc.element.pomelo.channelService.prototype.destroyChannel">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>destroyChannel
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroyChannel = function (name) {
  delete this.channels[name];
  removeFromStore(this, genKey(this), genKey(this, name));
  removeAllFromStore(this, genKey(this, name));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
* Destroy channel.
*/
Channel.prototype.destroy = function() {
 this.state = ST_DESTROYED;
 this.__channelService__.<span class="apidocCodeKeywordSpan">destroyChannel</span>(this.name);
};

/**
* Push message to all the members in the channel
*
* @param {String} route message route
* @param {Object} msg message that would be sent to client
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.getChannel" id="apidoc.element.pomelo.channelService.prototype.getChannel">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>getChannel
        <span class="apidocSignatureSpan">(name, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getChannel = function (name, create) {
  var channel = this.channels[name];
  if(!channel &amp;&amp; !!create) {
    channel = this.channels[name] = new Channel(name, this);
    addToStore(this, genKey(this), genKey(this, name));
  }
  return channel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.pushMessageByUids" id="apidoc.element.pomelo.channelService.prototype.pushMessageByUids">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>pushMessageByUids
        <span class="apidocSignatureSpan">(route, msg, uids, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushMessageByUids = function (route, msg, uids, opts, cb) {
  if(typeof route !== 'string') {
    cb = opts;
    opts = uids;
    uids = msg;
    msg = route;
    route = msg.route;
  }

  if(!cb &amp;&amp; typeof opts === 'function') {
    cb = opts;
    opts = {};
  }

  if(!uids || uids.length === 0) {
    utils.invokeCallback(cb, new Error('uids should not be empty'));
    return;
  }
  var groups = {}, record;
  for(var i=0, l=uids.length; i&lt;l; i++) {
    record = uids[i];
    add(record.uid, record.sid, groups);
  }

  sendMessageByGroup(this, route, msg, groups, opts, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.channelService.prototype.start" id="apidoc.element.pomelo.channelService.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.channelService.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  restoreChannel(this, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.coder" id="apidoc.module.pomelo.coder">module pomelo.coder</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.coder.decode" id="apidoc.element.pomelo.coder.decode">
        function <span class="apidocSignatureSpan">pomelo.coder.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  msg = Message.decode(msg.body);
  var route = msg.route;

  // decode use dictionary
  if(!!msg.compressRoute) {
    if(!!this.connector.useDict) {
      var abbrs = this.dictionary.getAbbrs();
      if(!abbrs[route]) {
        logger.error('dictionary error! no abbrs for route : %s', route);
        return null;
      }
      route = msg.route = abbrs[route];
    } else {
      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);
      return null;
    }
  }

  // decode use protobuf
  if(!!this.protobuf &amp;&amp; !!this.protobuf.getProtos().client[route]) {
    msg.body = this.protobuf.decode(route, msg.body);
  } else if(!!this.decodeIO_protobuf &amp;&amp; !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {
    msg.body = this.decodeIO_protobuf.decode(route, msg.body);
  } else {
    try {
      msg.body = JSON.parse(msg.body.toString('utf8'));
    } catch (ex) {
      msg.body = {};
    }
  }

  return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.coder.encode" id="apidoc.element.pomelo.coder.encode">
        function <span class="apidocSignatureSpan">pomelo.coder.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(!!reqId) {
    return composeResponse(this, reqId, route, msg);
  } else {
    return composePush(this, route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.components" id="apidoc.module.pomelo.components">module pomelo.components</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.components.backendSession" id="apidoc.element.pomelo.components.backendSession">
        function <span class="apidocSignatureSpan">pomelo.components.</span>backendSession
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">backendSession = function (app) {
  var service = new BackendSessionService(app);
  service.name = '__backendSession__';
  // export backend session service to the application context.
  app.set('backendSessionService', service, true);

  // for compatibility as `LocalSession` is renamed to `BackendSession`
  app.set('localSessionService', service, true);

  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.channel" id="apidoc.element.pomelo.components.channel">
        function <span class="apidocSignatureSpan">pomelo.components.</span>channel
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">channel = function (app, opts) {
  var service = new ChannelService(app, opts);
  app.set('channelService', service, true);
  service.name = '__channel__';
  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.connection" id="apidoc.element.pomelo.components.connection">
        function <span class="apidocSignatureSpan">pomelo.components.</span>connection
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connection = function (app) {
  return new Component(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.connector" id="apidoc.element.pomelo.components.connector">
        function <span class="apidocSignatureSpan">pomelo.components.</span>connector
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connector = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.dictionary" id="apidoc.element.pomelo.components.dictionary">
        function <span class="apidocSignatureSpan">pomelo.components.</span>dictionary
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dictionary = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.master" id="apidoc.element.pomelo.components.master">
        function <span class="apidocSignatureSpan">pomelo.components.</span>master
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">master = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.monitor" id="apidoc.element.pomelo.components.monitor">
        function <span class="apidocSignatureSpan">pomelo.components.</span>monitor
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monitor = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.protobuf" id="apidoc.element.pomelo.components.protobuf">
        function <span class="apidocSignatureSpan">pomelo.components.</span>protobuf
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">protobuf = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.proxy" id="apidoc.element.pomelo.components.proxy">
        function <span class="apidocSignatureSpan">pomelo.components.</span>proxy
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proxy = function (app, opts) {
  opts = opts || {};
  // proxy default config
  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  opts.router = genRouteFun();
  opts.context = app;
  opts.routeContext = app;
  if (app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }

  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.pushScheduler" id="apidoc.element.pomelo.components.pushScheduler">
        function <span class="apidocSignatureSpan">pomelo.components.</span>pushScheduler
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushScheduler = function (app, opts) {
  return new PushScheduler(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.remote" id="apidoc.element.pomelo.components.remote">
        function <span class="apidocSignatureSpan">pomelo.components.</span>remote
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remote = function (app, opts) {
  opts = opts || {};

  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  if(app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.server" id="apidoc.element.pomelo.components.server">
        function <span class="apidocSignatureSpan">pomelo.components.</span>server
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">server = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.components.session" id="apidoc.element.pomelo.components.session">
        function <span class="apidocSignatureSpan">pomelo.components.</span>session
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">session = function (app, opts) {
  var cmp = new Component(app, opts);
  app.set('sessionService', cmp, true);
  return cmp;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectionService" id="apidoc.module.pomelo.connectionService">module pomelo.connectionService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectionService.connectionService" id="apidoc.element.pomelo.connectionService.connectionService">
        function <span class="apidocSignatureSpan">pomelo.</span>connectionService
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connectionService = function (app) {
  this.serverId = app.getServerId();
  this.connCount = 0;
  this.loginedCount = 0;
  this.logined = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectionService.prototype" id="apidoc.module.pomelo.connectionService.prototype">module pomelo.connectionService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.addLoginedUser" id="apidoc.element.pomelo.connectionService.prototype.addLoginedUser">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>addLoginedUser
        <span class="apidocSignatureSpan">(uid, info)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addLoginedUser = function (uid, info) {
  if(!this.logined[uid]) {
    this.loginedCount++;
  }
  info.uid = uid;
  this.logined[uid] = info;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
socket.on('disconnect', session.closed.bind(session));
socket.on('error', session.closed.bind(session));
session.on('closed', onSessionClose.bind(null, app));
session.on('bind', function(uid) {
  logger.debug('session on [%s] bind with uid: %s', self.app.serverId, uid);
  // update connection statistics if necessary
  if (self.connection) {
    self.connection.<span class="apidocCodeKeywordSpan">addLoginedUser</span>(uid, {
      loginTime: Date.now(),
      uid: uid,
      address: socket.remoteAddress.ip + ':' + socket.remoteAddress.port
    });
  }
  self.app.event.emit(events.BIND_SESSION, session);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.decreaseConnectionCount" id="apidoc.element.pomelo.connectionService.prototype.decreaseConnectionCount">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>decreaseConnectionCount
        <span class="apidocSignatureSpan">(uid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decreaseConnectionCount = function (uid) {
  if(this.connCount) {
    this.connCount--;
  }
  if(!!uid) {
    this.removeLoginedUser(uid);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

socket.on('disconnect', function() {
  if (closed) {
    return;
  }
  closed = true;
  if (self.connection) {
    self.connection.<span class="apidocCodeKeywordSpan">decreaseConnectionCount</span>(session.uid);
  }
});

socket.on('error', function() {
  if (closed) {
    return;
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.getStatisticsInfo" id="apidoc.element.pomelo.connectionService.prototype.getStatisticsInfo">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>getStatisticsInfo
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getStatisticsInfo = function () {
  var list = [];
  for(var uid in this.logined) {
    list.push(this.logined[uid]);
  }

  return {serverId: this.serverId, totalConnCount: this.connCount, loginedCount: this.loginedCount, loginedList: list};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

var bindEvents = function(self, socket) {
var curServer = self.app.getCurServer();
var maxConnections = curServer['max-connections'];
if (self.connection &amp;&amp; maxConnections) {
  self.connection.increaseConnectionCount();
  var statisticInfo = self.connection.<span class="apidocCodeKeywordSpan">getStatisticsInfo</span>();
  if (statisticInfo.totalConnCount &gt; maxConnections) {
    logger.warn('the server %s has reached the max connections %s', curServer.id, maxConnections);
    socket.disconnect();
    return;
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.increaseConnectionCount" id="apidoc.element.pomelo.connectionService.prototype.increaseConnectionCount">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>increaseConnectionCount
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">increaseConnectionCount = function () {
  this.connCount++;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
};

var bindEvents = function(self, socket) {
var curServer = self.app.getCurServer();
var maxConnections = curServer['max-connections'];
if (self.connection &amp;&amp; maxConnections) {
  self.connection.<span class="apidocCodeKeywordSpan">increaseConnectionCount</span>();
  var statisticInfo = self.connection.getStatisticsInfo();
  if (statisticInfo.totalConnCount &gt; maxConnections) {
    logger.warn('the server %s has reached the max connections %s', curServer.id, maxConnections);
    socket.disconnect();
    return;
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.removeLoginedUser" id="apidoc.element.pomelo.connectionService.prototype.removeLoginedUser">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>removeLoginedUser
        <span class="apidocSignatureSpan">(uid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeLoginedUser = function (uid) {
  if(!!this.logined[uid]) {
    this.loginedCount--;
  }
  delete this.logined[uid];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      });
    }
    self.app.event.emit(events.BIND_SESSION, session);
  });

  session.on('unbind', function(uid) {
    if (self.connection) {
      self.connection.<span class="apidocCodeKeywordSpan">removeLoginedUser</span>(uid);
    }
    self.app.event.emit(events.UNBIND_SESSION, session);
  });

  return session;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectionService.prototype.updateUserInfo" id="apidoc.element.pomelo.connectionService.prototype.updateUserInfo">
        function <span class="apidocSignatureSpan">pomelo.connectionService.prototype.</span>updateUserInfo
        <span class="apidocSignatureSpan">(uid, info)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateUserInfo = function (uid, info) {
    var user = this.logined[uid];
    if (!user) {
        return;
    }

    for (var p in info) {
        if (info.hasOwnProperty(p) &amp;&amp; typeof info[p] !== 'function') {
            user[p] = info[p];
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors" id="apidoc.module.pomelo.connectors">module pomelo.connectors</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector" id="apidoc.element.pomelo.connectors.hybridconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>hybridconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hybridconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);

  this.opts = opts || {};
  this.port = port;
  this.host = host;
  this.useDict = opts.useDict;
  this.useProtobuf = opts.useProtobuf;
  this.handshake = new Handshake(opts);
  this.heartbeat = new Heartbeat(opts);
  this.distinctHost = opts.distinctHost;
  this.ssl = opts.ssl;

  this.switcher = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector" id="apidoc.element.pomelo.connectors.mqttconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>mqttconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts || {};

  this.adaptor = new Adaptor(this.opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector" id="apidoc.element.pomelo.connectors.sioconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>sioconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sioconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts;
  this.heartbeats = opts.heartbeats || true;
  this.closeTimeout = opts.closeTimeout || 60;
  this.heartbeatTimeout = opts.heartbeatTimeout || 60;
  this.heartbeatInterval = opts.heartbeatInterval || 25;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector" id="apidoc.element.pomelo.connectors.udpconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>udpconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">udpconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.opts = opts || {};
  this.type = opts.udpType || 'udp4';
  this.handshake = new Handshake(opts);
  if(!opts.heartbeat) {
    opts.heartbeat = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIME;
    opts.timeout = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIMEOUT;
  }
  this.heartbeat = new Heartbeat(utils.extends(opts, {disconnectOnTimeout: true}));
  this.clients = {};
  this.host = host;
  this.port = port;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.hybridconnector" id="apidoc.module.pomelo.connectors.hybridconnector">module pomelo.connectors.hybridconnector</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.hybridconnector" id="apidoc.element.pomelo.connectors.hybridconnector.hybridconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>hybridconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hybridconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);

  this.opts = opts || {};
  this.port = port;
  this.host = host;
  this.useDict = opts.useDict;
  this.useProtobuf = opts.useProtobuf;
  this.handshake = new Handshake(opts);
  this.heartbeat = new Heartbeat(opts);
  this.distinctHost = opts.distinctHost;
  this.ssl = opts.ssl;

  this.switcher = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.decode" id="apidoc.element.pomelo.connectors.hybridconnector.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  msg = Message.decode(msg.body);
  var route = msg.route;

  // decode use dictionary
  if(!!msg.compressRoute) {
    if(!!this.connector.useDict) {
      var abbrs = this.dictionary.getAbbrs();
      if(!abbrs[route]) {
        logger.error('dictionary error! no abbrs for route : %s', route);
        return null;
      }
      route = msg.route = abbrs[route];
    } else {
      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);
      return null;
    }
  }

  // decode use protobuf
  if(!!this.protobuf &amp;&amp; !!this.protobuf.getProtos().client[route]) {
    msg.body = this.protobuf.decode(route, msg.body);
  } else if(!!this.decodeIO_protobuf &amp;&amp; !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {
    msg.body = this.decodeIO_protobuf.decode(route, msg.body);
  } else {
    try {
      msg.body = JSON.parse(msg.body.toString('utf8'));
    } catch (ex) {
      msg.body = {};
    }
  }

  return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.encode" id="apidoc.element.pomelo.connectors.hybridconnector.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(!!reqId) {
    return composeResponse(this, reqId, route, msg);
  } else {
    return composePush(this, route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.super_" id="apidoc.element.pomelo.connectors.hybridconnector.super_">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.hybridconnector.prototype" id="apidoc.module.pomelo.connectors.hybridconnector.prototype">module pomelo.connectors.hybridconnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.decode" id="apidoc.element.pomelo.connectors.hybridconnector.prototype.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  msg = Message.decode(msg.body);
  var route = msg.route;

  // decode use dictionary
  if(!!msg.compressRoute) {
    if(!!this.connector.useDict) {
      var abbrs = this.dictionary.getAbbrs();
      if(!abbrs[route]) {
        logger.error('dictionary error! no abbrs for route : %s', route);
        return null;
      }
      route = msg.route = abbrs[route];
    } else {
      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);
      return null;
    }
  }

  // decode use protobuf
  if(!!this.protobuf &amp;&amp; !!this.protobuf.getProtos().client[route]) {
    msg.body = this.protobuf.decode(route, msg.body);
  } else if(!!this.decodeIO_protobuf &amp;&amp; !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {
    msg.body = this.decodeIO_protobuf.decode(route, msg.body);
  } else {
    try {
      msg.body = JSON.parse(msg.body.toString('utf8'));
    } catch (ex) {
      msg.body = {};
    }
  }

  return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.encode" id="apidoc.element.pomelo.connectors.hybridconnector.prototype.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(!!reqId) {
    return composeResponse(this, reqId, route, msg);
  } else {
    return composePush(this, route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.start" id="apidoc.element.pomelo.connectors.hybridconnector.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  var app = require('../pomelo').app;
  var self = this;

  var gensocket = function(socket) {
    var hybridsocket = new HybridSocket(curId++, socket);
    hybridsocket.on('handshake', self.handshake.handle.bind(self.handshake, hybridsocket));
    hybridsocket.on('heartbeat', self.heartbeat.handle.bind(self.heartbeat, hybridsocket));
    hybridsocket.on('disconnect', self.heartbeat.clear.bind(self.heartbeat, hybridsocket.id));
    hybridsocket.on('closing', Kick.handle.bind(null, hybridsocket));
    self.emit('connection', hybridsocket);
  };

  this.connector = app.components.__connector__.connector;
  this.dictionary = app.components.__dictionary__;
  this.protobuf = app.components.__protobuf__;
  this.decodeIO_protobuf = app.components.__decodeIO__protobuf__;

  if(!this.ssl) {
    this.listeningServer = net.createServer();
  } else {
    this.listeningServer = tls.createServer(this.ssl);
  }
  this.switcher = new Switcher(this.listeningServer, self.opts);

  this.switcher.on('connection', function(socket) {
    gensocket(socket);
  });

  if(!!this.distinctHost) {
    this.listeningServer.listen(this.port, this.host);
  } else {
    this.listeningServer.listen(this.port);
  }

  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.hybridconnector.prototype.stop" id="apidoc.element.pomelo.connectors.hybridconnector.prototype.stop">
        function <span class="apidocSignatureSpan">pomelo.connectors.hybridconnector.prototype.</span>stop
        <span class="apidocSignatureSpan">(force, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function (force, cb) {
  this.switcher.close();
  this.listeningServer.close();

  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.mqttconnector" id="apidoc.module.pomelo.connectors.mqttconnector">module pomelo.connectors.mqttconnector</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.mqttconnector" id="apidoc.element.pomelo.connectors.mqttconnector.mqttconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>mqttconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts || {};

  this.adaptor = new Adaptor(this.opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.super_" id="apidoc.element.pomelo.connectors.mqttconnector.super_">
        function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.mqttconnector.prototype" id="apidoc.module.pomelo.connectors.mqttconnector.prototype">module pomelo.connectors.mqttconnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.close" id="apidoc.element.pomelo.connectors.mqttconnector.prototype.close">
        function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  this.mqttServer.close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);
this.version = crypto.createHash('md5').update(protoStr).digest('base64');

//Watch file
var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));
if (this.watchers[type]) {
  this.watchers[type].<span class="apidocCodeKeywordSpan">close</span>();
}
this.watchers[type] = watcher;
};

pro.onUpdate = function(type, path, event) {
if(event !== 'change') {
  return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.encode" id="apidoc.element.pomelo.connectors.mqttconnector.prototype.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msgBody)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msgBody) {
	if (!!reqId) {
		return composeResponse(reqId, route, msgBody);
	} else {
		return composePush(route, msgBody);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.start" id="apidoc.element.pomelo.connectors.mqttconnector.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  var self = this;
  this.mqttServer = mqtt.createServer();
  this.mqttServer.on('client', function(client) {
		client.on('error', function(err) {
			client.stream.destroy();
		});
		
    client.on('close', function() {
			client.stream.destroy();
		});
		
    client.on('disconnect', function(packet) {
			client.stream.destroy();
		});

    if(self.opts.disconnectOnTimeout) {
      var timeout = self.opts.timeout * 1000 || constants.TIME.DEFAULT_MQTT_HEARTBEAT_TIMEOUT;
      client.stream.setTimeout(timeout,function() {
        client.emit('close');
      });
    }

    client.on('connect', function(packet) {
      client.connack({returnCode: 0});
      var mqttsocket = new MQTTSocket(curId++, client, self.adaptor);
      self.emit('connection', mqttsocket);
    });
  });

  this.mqttServer.listen(this.port);

  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.mqttconnector.prototype.stop" id="apidoc.element.pomelo.connectors.mqttconnector.prototype.stop">
        function <span class="apidocSignatureSpan">pomelo.connectors.mqttconnector.prototype.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
	this.mqttServer.close();
	process.exit(0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.sioconnector" id="apidoc.module.pomelo.connectors.sioconnector">module pomelo.connectors.sioconnector</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.sioconnector" id="apidoc.element.pomelo.connectors.sioconnector.sioconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>sioconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sioconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.port = port;
  this.host = host;
  this.opts = opts;
  this.heartbeats = opts.heartbeats || true;
  this.closeTimeout = opts.closeTimeout || 60;
  this.heartbeatTimeout = opts.heartbeatTimeout || 60;
  this.heartbeatInterval = opts.heartbeatInterval || 25;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.decode" id="apidoc.element.pomelo.connectors.sioconnector.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  var index = 0;

  var id = parseIntField(msg, index, PKG_ID_BYTES);
  index += PKG_ID_BYTES;

  var routeLen = parseIntField(msg, index, PKG_ROUTE_LENGTH_BYTES);

  var route = msg.substr(PKG_HEAD_BYTES, routeLen);
  var body = msg.substr(PKG_HEAD_BYTES + routeLen);

  return {
    id: id,
    route: route,
    body: JSON.parse(body)
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.encode" id="apidoc.element.pomelo.connectors.sioconnector.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(reqId) {
    return composeResponse(reqId, route, msg);
  } else {
    return composePush(route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.super_" id="apidoc.element.pomelo.connectors.sioconnector.super_">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.sioconnector.prototype" id="apidoc.module.pomelo.connectors.sioconnector.prototype">module pomelo.connectors.sioconnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.prototype.decode" id="apidoc.element.pomelo.connectors.sioconnector.prototype.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  var index = 0;

  var id = parseIntField(msg, index, PKG_ID_BYTES);
  index += PKG_ID_BYTES;

  var routeLen = parseIntField(msg, index, PKG_ROUTE_LENGTH_BYTES);

  var route = msg.substr(PKG_HEAD_BYTES, routeLen);
  var body = msg.substr(PKG_HEAD_BYTES + routeLen);

  return {
    id: id,
    route: route,
    body: JSON.parse(body)
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.prototype.encode" id="apidoc.element.pomelo.connectors.sioconnector.prototype.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(reqId) {
    return composeResponse(reqId, route, msg);
  } else {
    return composePush(route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.prototype.start" id="apidoc.element.pomelo.connectors.sioconnector.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  var self = this;
  // issue https://github.com/NetEase/pomelo-cn/issues/174
  var opts = {}
  if(!!this.opts) {
    opts = this.opts;
  }
  else {
    opts = {
      transports: [
      'websocket', 'polling-xhr', 'polling-jsonp', 'polling'
      ]
    };
  }

  var sio = require('socket.io')(httpServer, opts);

  var port = this.port;
  httpServer.listen(port, function () {
    console.log('sio Server listening at port %d', port);
  });
  sio.set('path', '/socket.io');
  sio.set('transports', this.opts.transports);
  sio.set('close timeout', this.closeTimeout);
  sio.set('heartbeat timeout', this.heartbeatTimeout);
  sio.set('heartbeat interval', this.heartbeatInterval);
  sio.set('heartbeats', this.heartbeats);
  sio.set('log level', 1);

  sio.on('connection', function (socket) {
  // this.wsocket.sockets.on('connection', function (socket) {
    var siosocket = new SioSocket(curId++, socket);
    self.emit('connection', siosocket);
    siosocket.on('closing', function(reason) {
      siosocket.send({route: 'onKick', reason: reason});
    });
  });

  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.sioconnector.prototype.stop" id="apidoc.element.pomelo.connectors.sioconnector.prototype.stop">
        function <span class="apidocSignatureSpan">pomelo.connectors.sioconnector.prototype.</span>stop
        <span class="apidocSignatureSpan">(force, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function (force, cb) {
  this.wsocket.server.close();
  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.udpconnector" id="apidoc.module.pomelo.connectors.udpconnector">module pomelo.connectors.udpconnector</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.udpconnector" id="apidoc.element.pomelo.connectors.udpconnector.udpconnector">
        function <span class="apidocSignatureSpan">pomelo.connectors.</span>udpconnector
        <span class="apidocSignatureSpan">(port, host, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">udpconnector = function (port, host, opts) {
  if (!(this instanceof Connector)) {
    return new Connector(port, host, opts);
  }

  EventEmitter.call(this);
  this.opts = opts || {};
  this.type = opts.udpType || 'udp4';
  this.handshake = new Handshake(opts);
  if(!opts.heartbeat) {
    opts.heartbeat = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIME;
    opts.timeout = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIMEOUT;
  }
  this.heartbeat = new Heartbeat(utils.extends(opts, {disconnectOnTimeout: true}));
  this.clients = {};
  this.host = host;
  this.port = port;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.decode" id="apidoc.element.pomelo.connectors.udpconnector.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  msg = Message.decode(msg.body);
  var route = msg.route;

  // decode use dictionary
  if(!!msg.compressRoute) {
    if(!!this.connector.useDict) {
      var abbrs = this.dictionary.getAbbrs();
      if(!abbrs[route]) {
        logger.error('dictionary error! no abbrs for route : %s', route);
        return null;
      }
      route = msg.route = abbrs[route];
    } else {
      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);
      return null;
    }
  }

  // decode use protobuf
  if(!!this.protobuf &amp;&amp; !!this.protobuf.getProtos().client[route]) {
    msg.body = this.protobuf.decode(route, msg.body);
  } else if(!!this.decodeIO_protobuf &amp;&amp; !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {
    msg.body = this.decodeIO_protobuf.decode(route, msg.body);
  } else {
    try {
      msg.body = JSON.parse(msg.body.toString('utf8'));
    } catch (ex) {
      msg.body = {};
    }
  }

  return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.encode" id="apidoc.element.pomelo.connectors.udpconnector.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(!!reqId) {
    return composeResponse(this, reqId, route, msg);
  } else {
    return composePush(this, route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.super_" id="apidoc.element.pomelo.connectors.udpconnector.super_">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.connectors.udpconnector.prototype" id="apidoc.module.pomelo.connectors.udpconnector.prototype">module pomelo.connectors.udpconnector.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.prototype.decode" id="apidoc.element.pomelo.connectors.udpconnector.prototype.decode">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>decode
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decode = function (msg) {
  msg = Message.decode(msg.body);
  var route = msg.route;

  // decode use dictionary
  if(!!msg.compressRoute) {
    if(!!this.connector.useDict) {
      var abbrs = this.dictionary.getAbbrs();
      if(!abbrs[route]) {
        logger.error('dictionary error! no abbrs for route : %s', route);
        return null;
      }
      route = msg.route = abbrs[route];
    } else {
      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);
      return null;
    }
  }

  // decode use protobuf
  if(!!this.protobuf &amp;&amp; !!this.protobuf.getProtos().client[route]) {
    msg.body = this.protobuf.decode(route, msg.body);
  } else if(!!this.decodeIO_protobuf &amp;&amp; !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {
    msg.body = this.decodeIO_protobuf.decode(route, msg.body);
  } else {
    try {
      msg.body = JSON.parse(msg.body.toString('utf8'));
    } catch (ex) {
      msg.body = {};
    }
  }

  return msg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.on('message', function(msg) {
var dmsg = msg;
if (self.useAsyncCoder) {
  return handleMessageAsync(self, msg, session, socket);
}

if (self.decode) {
  dmsg = self.<span class="apidocCodeKeywordSpan">decode</span>(msg, session);
} else if (self.connector.decode) {
  dmsg = self.connector.decode(msg, socket);
}
if (!dmsg) {
  // discard invalid message
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.prototype.encode" id="apidoc.element.pomelo.connectors.udpconnector.prototype.encode">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>encode
        <span class="apidocSignatureSpan">(reqId, route, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encode = function (reqId, route, msg) {
  if(!!reqId) {
    return composeResponse(this, reqId, route, msg);
  } else {
    return composePush(this, route, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var emsg = msg;
if (this.encode) {
  // use costumized encode
  emsg = this.encode.call(this, reqId, route, msg);
} else if (this.connector.encode) {
  // use connector default encode
  emsg = this.connector.<span class="apidocCodeKeywordSpan">encode</span>(reqId, route, msg);
}

this.doSend(reqId, route, emsg, recvs, opts, cb);
};

pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {
var emsg = msg;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.prototype.start" id="apidoc.element.pomelo.connectors.udpconnector.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  var self = this;
  this.tcpServer = net.createServer();
  this.socket = dgram.createSocket(this.type, function(msg, peer) {
    var key = genKey(peer);
    if(!self.clients[key]) {
      var udpsocket = new UdpSocket(curId++, self.socket, peer);
      self.clients[key] = udpsocket;

      udpsocket.on('handshake',
      self.handshake.handle.bind(self.handshake, udpsocket));

      udpsocket.on('heartbeat',
      self.heartbeat.handle.bind(self.heartbeat, udpsocket));

      udpsocket.on('disconnect',
      self.heartbeat.clear.bind(self.heartbeat, udpsocket.id));

      udpsocket.on('disconnect', function() {
        delete self.clients[genKey(udpsocket.peer)];
      });

      udpsocket.on('closing', Kick.handle.bind(null, udpsocket));

      self.emit('connection', udpsocket);
    }
  });

  this.socket.on('message', function(data, peer) {
    var socket = self.clients[genKey(peer)];
    if(!!socket) {
      socket.emit('package', data);
    }
  });

  this.socket.on('error', function(err) {
    logger.error('udp socket encounters with error: %j', err.stack);
    return;
  });

  this.socket.bind(this.port, this.host);
  this.tcpServer.listen(this.port);
  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.connectors.udpconnector.prototype.stop" id="apidoc.element.pomelo.connectors.udpconnector.prototype.stop">
        function <span class="apidocSignatureSpan">pomelo.connectors.udpconnector.prototype.</span>stop
        <span class="apidocSignatureSpan">(force, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function (force, cb) {
  this.socket.close();
  process.nextTick(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.countDownLatch" id="apidoc.module.pomelo.countDownLatch">module pomelo.countDownLatch</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.countDownLatch.createCountDownLatch" id="apidoc.element.pomelo.countDownLatch.createCountDownLatch">
        function <span class="apidocSignatureSpan">pomelo.countDownLatch.</span>createCountDownLatch
        <span class="apidocSignatureSpan">(count, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createCountDownLatch = function (count, opts, cb) {
  if(!count || count &lt;= 0) {
    throw new Error('count should be positive.');
  }

  if (!cb &amp;&amp; typeof opts === 'function') {
    cb = opts;
    opts = {};
  }

  if(typeof cb !== 'function') {
    throw new Error('cb should be a function.');
  }

  return new CountDownLatch(count, opts, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var timeouts = [];
var requests = {};
var count = utils.size(listeners);
if(count === 0) {
  logger.warn('master watchdog listeners is none, msg: %j', msg);
  return;
}
var latch = countDownLatch.<span class="apidocCodeKeywordSpan">createCountDownLatch</span>(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN
}, function(isTimeout) {
  if(!!isTimeout) {
    for(var key in requests) {
      if(!requests[key])  {
        timeouts.push(key);
      }
    }
    logger.error('master watchdog request timeout message: %j, timeouts: %j, fails: %j', msg, timeouts, fails);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.filterService" id="apidoc.module.pomelo.filterService">module pomelo.filterService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.filterService.filterService" id="apidoc.element.pomelo.filterService.filterService">
        function <span class="apidocSignatureSpan">pomelo.</span>filterService
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filterService = function () {
  this.befores = [];    // before filters
  this.afters = [];     // after filters
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.filterService.prototype" id="apidoc.module.pomelo.filterService.prototype">module pomelo.filterService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.filterService.prototype.after" id="apidoc.element.pomelo.filterService.prototype.after">
        function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>after
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">after = function (filter){
  this.afters.unshift(filter);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.filter = function (filter) {
 this.before(filter);
 this.<span class="apidocCodeKeywordSpan">after</span>(filter);
};

/**
* Add before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
* @memberOf Application
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filterService.prototype.afterFilter" id="apidoc.element.pomelo.filterService.prototype.afterFilter">
        function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>afterFilter
        <span class="apidocSignatureSpan">(err, msg, session, resp, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">afterFilter = function (err, msg, session, resp, cb) {
  var index = 0, self = this;
  function next(err) {
    //if done
    if(index &gt;= self.afters.length) {
      cb(err);
      return;
    }

    var handler = self.afters[index++];
    if(typeof handler === 'function') {
      handler(err, msg, session, resp, next);
    } else if(typeof handler.after === 'function') {
      handler.after(err, msg, session, resp, next);
    } else {
      logger.error('meet invalid after filter, handler or handler.after should be function.');
      next(new Error('invalid after filter.'));
    }
  } //end of next

  next(err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filterService.prototype.before" id="apidoc.element.pomelo.filterService.prototype.before">
        function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>before
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">before = function (filter){
  this.befores.push(filter);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* add a filter to before and after filter
*
* @param {Object} filter provide before and after filter method.
*                        A filter should have two methods: before and after.
* @memberOf Application
*/
Application.filter = function (filter) {
 this.<span class="apidocCodeKeywordSpan">before</span>(filter);
 this.after(filter);
};

/**
* Add before filter.
*
* @param {Object|Function} bf before fileter, bf(msg, session, next)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filterService.prototype.beforeFilter" id="apidoc.element.pomelo.filterService.prototype.beforeFilter">
        function <span class="apidocSignatureSpan">pomelo.filterService.prototype.</span>beforeFilter
        <span class="apidocSignatureSpan">(msg, session, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">beforeFilter = function (msg, session, cb) {
  var index = 0, self = this;
  var next = function(err, resp, opts) {
    if(err || index &gt;= self.befores.length) {
      cb(err, resp, opts);
      return;
    }

    var handler = self.befores[index++];
    if(typeof handler === 'function') {
      handler(msg, session, next);
    } else if(typeof handler.before === 'function') {
      handler.before(msg, session, next);
    } else {
      logger.error('meet invalid before filter, handler or handler.before should be function.');
      next(new Error('invalid before filter.'));
    }
  }; //end of next

  next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.filters" id="apidoc.module.pomelo.filters">module pomelo.filters</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.filters.serial" id="apidoc.element.pomelo.filters.serial">
        function <span class="apidocSignatureSpan">pomelo.filters.</span>serial
        <span class="apidocSignatureSpan">(timeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">serial = function (timeout) {
  return new Filter(timeout);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filters.time" id="apidoc.element.pomelo.filters.time">
        function <span class="apidocSignatureSpan">pomelo.filters.</span>time
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function () {
  return new Filter();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filters.timeout" id="apidoc.element.pomelo.filters.timeout">
        function <span class="apidocSignatureSpan">pomelo.filters.</span>timeout
        <span class="apidocSignatureSpan">(timeout, maxSize)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeout = function (timeout, maxSize) {
  return new Filter(timeout || DEFAULT_TIMEOUT, maxSize || DEFAULT_SIZE);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.filters.toobusy" id="apidoc.element.pomelo.filters.toobusy">
        function <span class="apidocSignatureSpan">pomelo.filters.</span>toobusy
        <span class="apidocSignatureSpan">(maxLag)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toobusy = function (maxLag) {
  return new Filter(maxLag || DEFAULT_MAXLAG);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.generate" id="apidoc.module.pomelo.generate">module pomelo.generate</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.generate.publish" id="apidoc.element.pomelo.generate.publish">
        function <span class="apidocSignatureSpan">pomelo.generate.</span>publish
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publish = function (opts) {
  opts = opts || {};
  var dup = opts.dup ? protocol.DUP_MASK : 0;
  var qos = opts.qos || 0;
  var retain = opts.retain ? protocol.RETAIN_MASK : 0;
  var topic = opts.topic;
  var payload = opts.payload || new Buffer(0);
  var id = (typeof opts.messageId === 'undefined') ? randint() : opts.messageId;
  var packet = {header: 0, payload: []};

<span class="apidocCodeCommentSpan">  /* Check required fields */
</span>  if (typeof topic !== 'string' || topic.length &lt;= 0) return null;
  /* if payload is a string, we'll convert it into a buffer */
  if(typeof payload == 'string') {
    payload = new Buffer(payload);
  }
  /* accepting only a buffer for payload */
  if (!Buffer.isBuffer(payload)) return null;
  if (typeof qos !== 'number' || qos &lt; 0 || qos &gt; 2) return null;
  if (typeof id !== 'number' || id &lt; 0 || id &gt; 0xFFFF) return null;

  /* Generate header */
  packet.header = protocol.codes.publish &lt;&lt; protocol.CMD_SHIFT | dup | qos &lt;&lt; protocol.QOS_SHIFT | retain;

  /* Topic name */
  packet.payload = packet.payload.concat(gen_string(topic));

  /* Message ID */
  if (qos &gt; 0) packet.payload = packet.payload.concat(gen_number(id));


  var buf = new Buffer([packet.header]
      .concat(gen_length(packet.payload.length + payload.length))
      .concat(packet.payload));

  return Buffer.concat([buf, payload]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(this.state !== ST_INITED) {
  return;
}
if(msg instanceof Buffer) {
  // if encoded, send directly
  this.socket.stream.write(msg);
} else {
  this.adaptor.<span class="apidocCodeKeywordSpan">publish</span>(this, msg);
}
};

Socket.prototype.sendBatch = function(msgs) {
for(var i = 0, l = msgs.length; i&lt;l; i++) {
  this.send(msgs[i]);
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.handlerService" id="apidoc.module.pomelo.handlerService">module pomelo.handlerService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.handlerService.handlerService" id="apidoc.element.pomelo.handlerService.handlerService">
        function <span class="apidocSignatureSpan">pomelo.</span>handlerService
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handlerService = function (app, opts) {
  this.app = app;
  this.handlerMap = {};
  if(!!opts.reloadHandlers) {
    watchHandlers(app, this.handlerMap);
  }

  this.enableForwardLog = opts.enableForwardLog || false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.handlerService.prototype" id="apidoc.module.pomelo.handlerService.prototype">module pomelo.handlerService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.handlerService.prototype.getHandler" id="apidoc.element.pomelo.handlerService.prototype.getHandler">
        function <span class="apidocSignatureSpan">pomelo.handlerService.prototype.</span>getHandler
        <span class="apidocSignatureSpan">(routeRecord)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandler = function (routeRecord) {
  var serverType = routeRecord.serverType;
  if(!this.handlerMap[serverType]) {
    loadHandlers(this.app, serverType, this.handlerMap);
  }
  var handlers = this.handlerMap[serverType] || {};
  var handler = handlers[routeRecord.handler];
  if(!handler) {
    logger.warn('could not find handler for routeRecord: %j', routeRecord);
    return null;
  }
  if(typeof handler[routeRecord.method] !== 'function') {
    logger.warn('could not find the method %s in handler: %s', routeRecord.method, routeRecord.handler);
    return null;
  }
  return handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Service.prototype.name = 'handler';

/**
 * Handler the request.
 */
Service.prototype.handle = function(routeRecord, msg, session, cb) {
// the request should be processed by current server
var handler = this.<span class="apidocCodeKeywordSpan">getHandler</span>(routeRecord);
if(!handler) {
  logger.error('[handleManager]: fail to find handler for %j', msg.__route__);
  utils.invokeCallback(cb, new Error('fail to find handler for ' + msg.__route__));
  return;
}
var start = Date.now();
var self = this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.handlerService.prototype.handle" id="apidoc.element.pomelo.handlerService.prototype.handle">
        function <span class="apidocSignatureSpan">pomelo.handlerService.prototype.</span>handle
        <span class="apidocSignatureSpan">(routeRecord, msg, session, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (routeRecord, msg, session, cb) {
  // the request should be processed by current server
  var handler = this.getHandler(routeRecord);
  if(!handler) {
    logger.error('[handleManager]: fail to find handler for %j', msg.__route__);
    utils.invokeCallback(cb, new Error('fail to find handler for ' + msg.__route__));
    return;
  }
  var start = Date.now();
  var self = this;

  var callback = function(err, resp, opts) {
    if(self.enableForwardLog) {
      var log = {
        route : msg.__route__,
        args : msg,
        time : utils.format(new Date(start)),
        timeUsed : new Date() - start
      };
      forwardLogger.info(JSON.stringify(log));
    }

    // resp = getResp(arguments);
    utils.invokeCallback(cb, err, resp, opts);
  }

  var method = routeRecord.method;

  if(!Array.isArray(msg)) {
    handler[method](msg, session, callback);
  } else {
    msg.push(session);
    msg.push(callback);
    handler[method].apply(handler, msg);
  }
  return;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	process.nextTick(cb);
};

/**
 * Proxy server handle
 */
pro.handle = function(msg, session, cb) {
	this.server.<span class="apidocCodeKeywordSpan">handle</span>(msg, session, cb);
};

/**
 * Proxy server global handle
 */
Component.prototype.globalHandle = function(msg, session, cb) {
	this.server.globalHandle(msg, session, cb);
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.handshake" id="apidoc.module.pomelo.handshake">module pomelo.handshake</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.handshake.handshake" id="apidoc.element.pomelo.handshake.handshake">
        function <span class="apidocSignatureSpan">pomelo.</span>handshake
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handshake = function (opts) {
  opts = opts || {};
  this.userHandshake = opts.handshake;

  if(opts.heartbeat) {
    this.heartbeatSec = opts.heartbeat;
    this.heartbeat = opts.heartbeat * 1000;
  }

  this.checkClient = opts.checkClient;

  this.useDict = opts.useDict;
  this.useProtobuf = opts.useProtobuf;
  this.useCrypto = opts.useCrypto;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var CODE_USE_ERROR = 500;
var CODE_OLD_CLIENT = 501;

/**
 * Process the handshake request.
 *
 * @param {Object} opts option parameters
 *                      opts.<span class="apidocCodeKeywordSpan">handshake</span>(msg, cb(err, resp)) handshake callback. msg is
 the handshake message from client.
 *                      opts.hearbeat heartbeat interval (level?)
 *                      opts.version required client level
 */
var Command = function(opts) {
opts = opts || {};
this.userHandshake = opts.handshake;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.handshake.prototype" id="apidoc.module.pomelo.handshake.prototype">module pomelo.handshake.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.handshake.prototype.handle" id="apidoc.element.pomelo.handshake.prototype.handle">
        function <span class="apidocSignatureSpan">pomelo.handshake.prototype.</span>handle
        <span class="apidocSignatureSpan">(socket, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (socket, msg) {
  if(!msg.sys) {
    processError(socket, CODE_USE_ERROR);
    return;
  }

  if(typeof this.checkClient === 'function') {
    if(!msg || !msg.sys || !this.checkClient(msg.sys.type, msg.sys.version)) {
      processError(socket, CODE_OLD_CLIENT);
      return;
    }
  }

  var opts = {
    heartbeat : setupHeartbeat(this)
  };

  if(this.useDict) {
    var dictVersion = pomelo.app.components.__dictionary__.getVersion();
    if(!msg.sys.dictVersion || msg.sys.dictVersion !== dictVersion){

      // may be deprecated in future
      opts.dict = pomelo.app.components.__dictionary__.getDict();

      opts.routeToCode = pomelo.app.components.__dictionary__.getDict();
      opts.codeToRoute = pomelo.app.components.__dictionary__.getAbbrs();
      opts.dictVersion = dictVersion;
    }
    opts.useDict = true;
  }

  if(this.useProtobuf) {
    var protoVersion = pomelo.app.components.__protobuf__.getVersion();
    if(!msg.sys.protoVersion || msg.sys.protoVersion !== protoVersion){
      opts.protos = pomelo.app.components.__protobuf__.getProtos();
    }
    opts.useProto = true;
  }

  if(!!pomelo.app.components.__decodeIO__protobuf__) {
    if(!!this.useProtobuf) {
      throw new Error('protobuf can not be both used in the same project.');
    }
    var version = pomelo.app.components.__decodeIO__protobuf__.getVersion();
    if(!msg.sys.protoVersion || msg.sys.protoVersion &lt; version) {
      opts.protos = pomelo.app.components.__decodeIO__protobuf__.getProtos();
    }
    opts.useProto = true;
  }

  if(this.useCrypto) {
    pomelo.app.components.__connector__.setPubKey(socket.id, msg.sys.rsa);
  }

  if(typeof this.userHandshake === 'function') {
    this.userHandshake(msg, function(err, resp) {
      if(err) {
        process.nextTick(function() {
          processError(socket, CODE_USE_ERROR);
        });
        return;
      }
      process.nextTick(function() {
        response(socket, opts, resp);
      });
    }, socket);
    return;
  }

  process.nextTick(function() {
    response(socket, opts);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	process.nextTick(cb);
};

/**
 * Proxy server handle
 */
pro.handle = function(msg, session, cb) {
	this.server.<span class="apidocCodeKeywordSpan">handle</span>(msg, session, cb);
};

/**
 * Proxy server global handle
 */
Component.prototype.globalHandle = function(msg, session, cb) {
	this.server.globalHandle(msg, session, cb);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.heartbeat" id="apidoc.module.pomelo.heartbeat">module pomelo.heartbeat</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.heartbeat.heartbeat" id="apidoc.element.pomelo.heartbeat.heartbeat">
        function <span class="apidocSignatureSpan">pomelo.</span>heartbeat
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">heartbeat = function (opts) {
  opts = opts || {};
  this.heartbeat = null;
  this.timeout = null;
  this.disconnectOnTimeout = opts.disconnectOnTimeout;

  if(opts.heartbeat) {
    this.heartbeat = opts.heartbeat * 1000; // heartbeat interval
    this.timeout = opts.timeout * 1000 || this.heartbeat * 2;      // max heartbeat message timeout
    this.disconnectOnTimeout = true;
  }

  this.timeouts = {};
  this.clients = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.heartbeat.prototype" id="apidoc.module.pomelo.heartbeat.prototype">module pomelo.heartbeat.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.heartbeat.prototype.clear" id="apidoc.element.pomelo.heartbeat.prototype.clear">
        function <span class="apidocSignatureSpan">pomelo.heartbeat.prototype.</span>clear
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clear = function (id) {
  var tid = this.timeouts[id];
  if(tid) {
    clearTimeout(tid);
    delete this.timeouts[id];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.clients[socket.id] = 1;
  socket.once('disconnect', clearTimers.bind(null, this, socket.id));
  socket.once('error', clearTimers.bind(null, this, socket.id));
}

// clear timeout timer
if(self.disconnectOnTimeout) {
  this.<span class="apidocCodeKeywordSpan">clear</span>(socket.id);
}

socket.sendRaw(Package.encode(Package.TYPE_HEARTBEAT));

if(self.disconnectOnTimeout) {
  self.timeouts[socket.id] = setTimeout(function() {
    logger.info('client %j heartbeat timeout.', socket.id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.heartbeat.prototype.handle" id="apidoc.element.pomelo.heartbeat.prototype.handle">
        function <span class="apidocSignatureSpan">pomelo.heartbeat.prototype.</span>handle
        <span class="apidocSignatureSpan">(socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (socket) {
  if(!this.heartbeat) {
    // no heartbeat setting
    return;
  }

  var self = this;

  if(!this.clients[socket.id]) {
    // clear timers when socket disconnect or error
    this.clients[socket.id] = 1;
    socket.once('disconnect', clearTimers.bind(null, this, socket.id));
    socket.once('error', clearTimers.bind(null, this, socket.id));
  }

  // clear timeout timer
  if(self.disconnectOnTimeout) {
    this.clear(socket.id);
  }

  socket.sendRaw(Package.encode(Package.TYPE_HEARTBEAT));

  if(self.disconnectOnTimeout) {
    self.timeouts[socket.id] = setTimeout(function() {
      logger.info('client %j heartbeat timeout.', socket.id);
      socket.disconnect();
    }, self.timeout);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	process.nextTick(cb);
};

/**
 * Proxy server handle
 */
pro.handle = function(msg, session, cb) {
	this.server.<span class="apidocCodeKeywordSpan">handle</span>(msg, session, cb);
};

/**
 * Proxy server global handle
 */
Component.prototype.globalHandle = function(msg, session, cb) {
	this.server.globalHandle(msg, session, cb);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.hybridsocket" id="apidoc.module.pomelo.hybridsocket">module pomelo.hybridsocket</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.hybridsocket" id="apidoc.element.pomelo.hybridsocket.hybridsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>hybridsocket
        <span class="apidocSignatureSpan">(id, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hybridsocket = function (id, socket) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;

  if(!socket._socket) {
    this.remoteAddress = {
      ip: socket.address().address,
      port: socket.address().port
    };
  } else {
    this.remoteAddress = {
      ip: socket._socket.remoteAddress,
      port: socket._socket.remotePort
    };
  }

  var self = this;

  socket.once('close', this.emit.bind(this, 'disconnect'));
  socket.on('error', this.emit.bind(this, 'error'));

  socket.on('message', function(msg) {
    if(msg) {
      msg = Package.decode(msg);
      handler(self, msg);
    }
  });

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.super_" id="apidoc.element.pomelo.hybridsocket.super_">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.hybridsocket.prototype" id="apidoc.module.pomelo.hybridsocket.prototype">module pomelo.hybridsocket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.disconnect" id="apidoc.element.pomelo.hybridsocket.prototype.disconnect">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>disconnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disconnect = function () {
  if(this.state === ST_CLOSED) {
    return;
  }

  this.state = ST_CLOSED;
  this.socket.emit('close');
  this.socket.close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var ip = socket.remoteAddress.ip;
var check = function(list) {
  for (var address in list) {
    var exp = new RegExp(list[address]);
    if (exp.test(ip)) {
      socket.<span class="apidocCodeKeywordSpan">disconnect</span>();
      return true;
    }
  }
  return false;
};
// dynamical check
if (this.blacklist.length !== 0 &amp;&amp; !!check(this.blacklist)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.handshakeResponse" id="apidoc.element.pomelo.hybridsocket.prototype.handshakeResponse">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>handshakeResponse
        <span class="apidocSignatureSpan">(resp)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handshakeResponse = function (resp) {
  if(this.state !== ST_INITED) {
    return;
  }

  this.socket.send(resp, {binary: true});
  this.state = ST_WAIT_ACK;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var res = {
  code: CODE_OK,
  sys: sys
};
if(resp) {
  res.user = resp;
}
socket.<span class="apidocCodeKeywordSpan">handshakeResponse</span>(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify
(res))));
};

var processError = function(socket, code) {
var res = {
  code: code
};
socket.sendForce(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.send" id="apidoc.element.pomelo.hybridsocket.prototype.send">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>send
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg) {
  if(msg instanceof String) {
    msg = new Buffer(msg);
  } else if(!(msg instanceof Buffer)) {
    msg = new Buffer(JSON.stringify(msg));
  }
  this.sendRaw(Package.encode(Package.TYPE_DATA, msg));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   opts = {
     type: 'response',
     userOptions: opts || {}
   };
   // for compatiablity
   opts.isResponse = true;

   self.<span class="apidocCodeKeywordSpan">send</span>(msg.id, msg.route, resp, [session.id], opts,
     function() {});
 });
};

/**
* Get server type form request message.
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.sendBatch" id="apidoc.element.pomelo.hybridsocket.prototype.sendBatch">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendBatch
        <span class="apidocSignatureSpan">(msgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendBatch = function (msgs) {
  var rs = [];
  for(var i=0; i&lt;msgs.length; i++) {
    var src = Package.encode(Package.TYPE_DATA, msgs[i]);
    rs.push(src);
  }
  this.sendRaw(Buffer.concat(rs));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Send message to the session in batch.
*
* @param  {Array} msgs list of message
*/
Session.prototype.sendBatch = function(msgs) {
 this.__socket__.<span class="apidocCodeKeywordSpan">sendBatch</span>(msgs);
};

/**
* Closed callback for the session which would disconnect client in next tick.
*
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.sendForce" id="apidoc.element.pomelo.hybridsocket.prototype.sendForce">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendForce
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendForce = function (msg) {
  if(this.state === ST_CLOSED) {
    return;
  }
  this.socket.send(msg, {binary: true});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.handshakeResponse(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));
};

var processError = function(socket, code) {
  var res = {
    code: code
  };
  socket.<span class="apidocCodeKeywordSpan">sendForce</span>(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res
))));
  process.nextTick(function() {
    socket.disconnect();
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.hybridsocket.prototype.sendRaw" id="apidoc.element.pomelo.hybridsocket.prototype.sendRaw">
        function <span class="apidocSignatureSpan">pomelo.hybridsocket.prototype.</span>sendRaw
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendRaw = function (msg) {
  if(this.state !== ST_WORKING) {
    return;
  }
  var self = this;

  this.socket.send(msg, {binary: true}, function(err) {
    if(!!err) {
      logger.error('websocket send binary data failed: %j', err.stack);
      return;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
Socket.prototype.send = function(msg) {
 if(msg instanceof String) {
   msg = new Buffer(msg);
 } else if(!(msg instanceof Buffer)) {
   msg = new Buffer(JSON.stringify(msg));
 }
 this.<span class="apidocCodeKeywordSpan">sendRaw</span>(Package.encode(Package.TYPE_DATA, msg));
};

/**
* Send byte data packages to client in batch.
*
* @param  {Buffer} msgs byte data
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.index" id="apidoc.module.pomelo.index">module pomelo.index</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.index.backendSession" id="apidoc.element.pomelo.index.backendSession">
        function <span class="apidocSignatureSpan">pomelo.index.</span>backendSession
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">backendSession = function (app) {
  var service = new BackendSessionService(app);
  service.name = '__backendSession__';
  // export backend session service to the application context.
  app.set('backendSessionService', service, true);

  // for compatibility as `LocalSession` is renamed to `BackendSession`
  app.set('localSessionService', service, true);

  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.channel" id="apidoc.element.pomelo.index.channel">
        function <span class="apidocSignatureSpan">pomelo.index.</span>channel
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">channel = function (app, opts) {
  var service = new ChannelService(app, opts);
  app.set('channelService', service, true);
  service.name = '__channel__';
  return service;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.connection" id="apidoc.element.pomelo.index.connection">
        function <span class="apidocSignatureSpan">pomelo.index.</span>connection
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connection = function (app) {
  return new Component(app);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.connector" id="apidoc.element.pomelo.index.connector">
        function <span class="apidocSignatureSpan">pomelo.index.</span>connector
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connector = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.createApp" id="apidoc.element.pomelo.index.createApp">
        function <span class="apidocSignatureSpan">pomelo.index.</span>createApp
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createApp = function (opts) {
  var app = application;
  app.init(opts);
  self.app = app;
  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.dictionary" id="apidoc.element.pomelo.index.dictionary">
        function <span class="apidocSignatureSpan">pomelo.index.</span>dictionary
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dictionary = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.master" id="apidoc.element.pomelo.index.master">
        function <span class="apidocSignatureSpan">pomelo.index.</span>master
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">master = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.monitor" id="apidoc.element.pomelo.index.monitor">
        function <span class="apidocSignatureSpan">pomelo.index.</span>monitor
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monitor = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.protobuf" id="apidoc.element.pomelo.index.protobuf">
        function <span class="apidocSignatureSpan">pomelo.index.</span>protobuf
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">protobuf = function (app, opts) {
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.proxy" id="apidoc.element.pomelo.index.proxy">
        function <span class="apidocSignatureSpan">pomelo.index.</span>proxy
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proxy = function (app, opts) {
  opts = opts || {};
  // proxy default config
  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  opts.router = genRouteFun();
  opts.context = app;
  opts.routeContext = app;
  if (app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }

  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.pushScheduler" id="apidoc.element.pomelo.index.pushScheduler">
        function <span class="apidocSignatureSpan">pomelo.index.</span>pushScheduler
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pushScheduler = function (app, opts) {
  return new PushScheduler(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.remote" id="apidoc.element.pomelo.index.remote">
        function <span class="apidocSignatureSpan">pomelo.index.</span>remote
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remote = function (app, opts) {
  opts = opts || {};

  // cacheMsg is deprecated, just for compatibility here.
  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;
  opts.interval = opts.interval || 30;
  if(app.enabled('rpcDebugLog')) {
    opts.rpcDebugLog = true;
    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);
  }
  return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.serial" id="apidoc.element.pomelo.index.serial">
        function <span class="apidocSignatureSpan">pomelo.index.</span>serial
        <span class="apidocSignatureSpan">(timeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">serial = function (timeout) {
  return new Filter(timeout);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.server" id="apidoc.element.pomelo.index.server">
        function <span class="apidocSignatureSpan">pomelo.index.</span>server
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">server = function (app, opts) {
	return new Component(app, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.session" id="apidoc.element.pomelo.index.session">
        function <span class="apidocSignatureSpan">pomelo.index.</span>session
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">session = function (app, opts) {
  var cmp = new Component(app, opts);
  app.set('sessionService', cmp, true);
  return cmp;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.time" id="apidoc.element.pomelo.index.time">
        function <span class="apidocSignatureSpan">pomelo.index.</span>time
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function () {
  return new Filter();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.timeout" id="apidoc.element.pomelo.index.timeout">
        function <span class="apidocSignatureSpan">pomelo.index.</span>timeout
        <span class="apidocSignatureSpan">(timeout, maxSize)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeout = function (timeout, maxSize) {
  return new Filter(timeout || DEFAULT_TIMEOUT, maxSize || DEFAULT_SIZE);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.index.toobusy" id="apidoc.element.pomelo.index.toobusy">
        function <span class="apidocSignatureSpan">pomelo.index.</span>toobusy
        <span class="apidocSignatureSpan">(maxLag)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toobusy = function (maxLag) {
  return new Filter(maxLag || DEFAULT_MAXLAG);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.kick" id="apidoc.module.pomelo.kick">module pomelo.kick</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.kick.handle" id="apidoc.element.pomelo.kick.handle">
        function <span class="apidocSignatureSpan">pomelo.kick.</span>handle
        <span class="apidocSignatureSpan">(socket, reason)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (socket, reason) {
// websocket close code 1000 would emit when client close the connection
  if(typeof reason === 'string') {
    var res = {
      reason: reason
    };
    socket.sendRaw(Package.encode(Package.TYPE_KICK, new Buffer(JSON.stringify(res))));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	process.nextTick(cb);
};

/**
 * Proxy server handle
 */
pro.handle = function(msg, session, cb) {
	this.server.<span class="apidocCodeKeywordSpan">handle</span>(msg, session, cb);
};

/**
 * Proxy server global handle
 */
Component.prototype.globalHandle = function(msg, session, cb) {
	this.server.globalHandle(msg, session, cb);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.moduleUtil" id="apidoc.module.pomelo.moduleUtil">module pomelo.moduleUtil</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.moduleUtil.loadModules" id="apidoc.element.pomelo.moduleUtil.loadModules">
        function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>loadModules
        <span class="apidocSignatureSpan">(self, consoleService)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadModules = function (self, consoleService) {
  // load app register modules
  var _modules = self.app.get(Constants.KEYWORDS.MODULE);

  if(!_modules) {
    return;
  }

  var modules = [];
  for(var m in _modules){
    modules.push(_modules[m]);
  }

  var record, moduleId, module;
  for(var i=0, l=modules.length; i&lt;l; i++) {
    record = modules[i];
    if(typeof record.module === 'function') {
      module = record.module(record.opts, consoleService);
    } else {
      module = record.module;
    }

    moduleId = record.moduleId || module.moduleId;

    if(!moduleId) {
      logger.warn('ignore an unknown module.');
      continue;
    }

    consoleService.register(moduleId, module);
    self.modules.push(module);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.moduleUtil.registerDefaultModules" id="apidoc.element.pomelo.moduleUtil.registerDefaultModules">
        function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>registerDefaultModules
        <span class="apidocSignatureSpan">(isMaster, app, closeWatcher)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">registerDefaultModules = function (isMaster, app, closeWatcher) {
  if(!closeWatcher) {
    if(isMaster) {
      app.registerAdmin(require('../modules/masterwatcher'), {app: app});
    } else {
      app.registerAdmin(require('../modules/monitorwatcher'), {app: app});
    }
  }
  app.registerAdmin(admin.modules.watchServer,{app:app});
  app.registerAdmin(require('../modules/console'), {app: app, starter: starter});
  if(app.enabled('systemMonitor')) {
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.systemInfo);
      app.registerAdmin(admin.modules.nodeInfo);
    }
    app.registerAdmin(admin.modules.monitorLog, {path: pathUtil.getLogPath(app.getBase())});
    app.registerAdmin(admin.modules.scripts, {app:app, path: pathUtil.getScriptPath(app.getBase())});
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.profiler);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.moduleUtil.startModules" id="apidoc.element.pomelo.moduleUtil.startModules">
        function <span class="apidocSignatureSpan">pomelo.moduleUtil.</span>startModules
        <span class="apidocSignatureSpan">(modules, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startModules = function (modules, cb) {
  // invoke the start lifecycle method of modules

  if(!modules) {
    return;
  }
  startModule(null, modules, 0, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.mqttadaptor" id="apidoc.module.pomelo.mqttadaptor">module pomelo.mqttadaptor</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor.mqttadaptor" id="apidoc.element.pomelo.mqttadaptor.mqttadaptor">
        function <span class="apidocSignatureSpan">pomelo.</span>mqttadaptor
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttadaptor = function (opts) {
  opts = opts || {};
  this.subReqs = {};
  this.publishRoute = opts.publishRoute;
  this.subscribeRoute = opts.subscribeRoute;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.mqttadaptor.prototype" id="apidoc.module.pomelo.mqttadaptor.prototype">module pomelo.mqttadaptor.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor.prototype.onPubAck" id="apidoc.element.pomelo.mqttadaptor.prototype.onPubAck">
        function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onPubAck
        <span class="apidocSignatureSpan">(client, packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPubAck = function (client, packet) {
  var req = {
    id: packet.messageId,
    route: 'connector.mqttHandler.pubAck',
    body: {
      mid: packet.messageId
    }
  };

  this.subReqs[packet.messageId] = packet;

  client.emit('message', req);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor.prototype.onPublish" id="apidoc.element.pomelo.mqttadaptor.prototype.onPublish">
        function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onPublish
        <span class="apidocSignatureSpan">(client, packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPublish = function (client, packet) {
  var route = this.publishRoute;

  if(!route) {
    throw new Error('unspecified publish route.');
  }

  var payload = packet.payload;
  if(payload instanceof Buffer) {
    payload = payload.toString('utf8');
  }

  var req = {
    id: packet.messageId,
    route: route,
    body: packet
  };

  client.emit('message', req);

  if(packet.qos === 1) {
    client.socket.puback({messageId: packet.messageId});
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor.prototype.onSubscribe" id="apidoc.element.pomelo.mqttadaptor.prototype.onSubscribe">
        function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>onSubscribe
        <span class="apidocSignatureSpan">(client, packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onSubscribe = function (client, packet) {
  var route = this.subscribeRoute;

  if(!route) {
    throw new Error('unspecified subscribe route.');
  }

  var req = {
    id: packet.messageId,
    route: route,
    body: {
      subscriptions: packet.subscriptions
    }
  };

  this.subReqs[packet.messageId] = packet;

  client.emit('message', req);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttadaptor.prototype.publish" id="apidoc.element.pomelo.mqttadaptor.prototype.publish">
        function <span class="apidocSignatureSpan">pomelo.mqttadaptor.prototype.</span>publish
        <span class="apidocSignatureSpan">(client, packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publish = function (client, packet) {
  var mid = packet.id;
  var subreq = this.subReqs[mid];
  if(subreq) {
    // is suback
    client.socket.suback({messageId: mid, granted: packet.body});
    delete this.subReqs[mid];
    return;
  }

  client.socket.publish(packet.body);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(this.state !== ST_INITED) {
  return;
}
if(msg instanceof Buffer) {
  // if encoded, send directly
  this.socket.stream.write(msg);
} else {
  this.adaptor.<span class="apidocCodeKeywordSpan">publish</span>(this, msg);
}
};

Socket.prototype.sendBatch = function(msgs) {
for(var i = 0, l = msgs.length; i&lt;l; i++) {
  this.send(msgs[i]);
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.mqttsocket" id="apidoc.module.pomelo.mqttsocket">module pomelo.mqttsocket</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket.mqttsocket" id="apidoc.element.pomelo.mqttsocket.mqttsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>mqttsocket
        <span class="apidocSignatureSpan">(id, socket, adaptor)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mqttsocket = function (id, socket, adaptor) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;
  this.remoteAddress = {
    ip: socket.stream.remoteAddress,
    port: socket.stream.remotePort
  };
  this.adaptor = adaptor;

  var self = this;

  socket.on('close', this.emit.bind(this, 'disconnect'));
  socket.on('error', this.emit.bind(this, 'disconnect'));
  socket.on('disconnect', this.emit.bind(this, 'disconnect'));

  socket.on('pingreq', function(packet) {
    socket.pingresp();
  });

  socket.on('subscribe', this.adaptor.onSubscribe.bind(this.adaptor, this));

  socket.on('publish', this.adaptor.onPublish.bind(this.adaptor, this));

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket.super_" id="apidoc.element.pomelo.mqttsocket.super_">
        function <span class="apidocSignatureSpan">pomelo.mqttsocket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.mqttsocket.prototype" id="apidoc.module.pomelo.mqttsocket.prototype">module pomelo.mqttsocket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket.prototype.disconnect" id="apidoc.element.pomelo.mqttsocket.prototype.disconnect">
        function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>disconnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disconnect = function () {
  if(this.state === ST_CLOSED) {
    return;
  }

  this.state = ST_CLOSED;
  this.socket.stream.destroy();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var ip = socket.remoteAddress.ip;
var check = function(list) {
  for (var address in list) {
    var exp = new RegExp(list[address]);
    if (exp.test(ip)) {
      socket.<span class="apidocCodeKeywordSpan">disconnect</span>();
      return true;
    }
  }
  return false;
};
// dynamical check
if (this.blacklist.length !== 0 &amp;&amp; !!check(this.blacklist)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket.prototype.send" id="apidoc.element.pomelo.mqttsocket.prototype.send">
        function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>send
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg) {
  if(this.state !== ST_INITED) {
    return;
  }
  if(msg instanceof Buffer) {
    // if encoded, send directly
    this.socket.stream.write(msg);
  } else {
    this.adaptor.publish(this, msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   opts = {
     type: 'response',
     userOptions: opts || {}
   };
   // for compatiablity
   opts.isResponse = true;

   self.<span class="apidocCodeKeywordSpan">send</span>(msg.id, msg.route, resp, [session.id], opts,
     function() {});
 });
};

/**
* Get server type form request message.
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.mqttsocket.prototype.sendBatch" id="apidoc.element.pomelo.mqttsocket.prototype.sendBatch">
        function <span class="apidocSignatureSpan">pomelo.mqttsocket.prototype.</span>sendBatch
        <span class="apidocSignatureSpan">(msgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendBatch = function (msgs) {
  for(var i = 0, l = msgs.length; i&lt;l; i++) {
    this.send(msgs[i]);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Send message to the session in batch.
*
* @param  {Array} msgs list of message
*/
Session.prototype.sendBatch = function(msgs) {
 this.__socket__.<span class="apidocCodeKeywordSpan">sendBatch</span>(msgs);
};

/**
* Closed callback for the session which would disconnect client in next tick.
*
* @api public
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pathUtil" id="apidoc.module.pomelo.pathUtil">module pomelo.pathUtil</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getCronPath" id="apidoc.element.pomelo.pathUtil.getCronPath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getCronPath
        <span class="apidocSignatureSpan">(appBase, serverType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCronPath = function (appBase, serverType) {
  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.CRON);
  return fs.existsSync(p) ? p : null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getHandlerPath" id="apidoc.element.pomelo.pathUtil.getHandlerPath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getHandlerPath
        <span class="apidocSignatureSpan">(appBase, serverType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandlerPath = function (appBase, serverType) {
  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.HANDLER);
  return fs.existsSync(p) ? p : null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

pro.start = function(cb) {
  var servers = this.app.get('servers');
  var routes = [];

  //Load all the handler files
  for(var serverType in servers) {
var p = pathUtil.<span class="apidocCodeKeywordSpan">getHandlerPath</span>(this.app.getBase(), serverType);
if(!p) {
  continue;
}

var handlers = Loader.load(p, this.app);

for(var name in handlers) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getLogPath" id="apidoc.element.pomelo.pathUtil.getLogPath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getLogPath
        <span class="apidocSignatureSpan">(appBase)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLogPath = function (appBase) {
  return path.join(appBase, Constants.DIR.LOG);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  app.registerAdmin(admin.modules.watchServer,{app:app});
  app.registerAdmin(require('../modules/console'), {app: app, starter: starter});
  if(app.enabled('systemMonitor')) {
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.systemInfo);
      app.registerAdmin(admin.modules.nodeInfo);
    }
    app.registerAdmin(admin.modules.monitorLog, {path: pathUtil.<span class="apidocCodeKeywordSpan">getLogPath</span>(app.getBase
())});
    app.registerAdmin(admin.modules.scripts, {app:app, path: pathUtil.getScriptPath(app.getBase())});
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.profiler);
    }
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getScriptPath" id="apidoc.element.pomelo.pathUtil.getScriptPath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getScriptPath
        <span class="apidocSignatureSpan">(appBase)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getScriptPath = function (appBase) {
  return path.join(appBase, Constants.DIR.SCRIPT);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  app.registerAdmin(require('../modules/console'), {app: app, starter: starter});
  if(app.enabled('systemMonitor')) {
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.systemInfo);
      app.registerAdmin(admin.modules.nodeInfo);
    }
    app.registerAdmin(admin.modules.monitorLog, {path: pathUtil.getLogPath(app.getBase())});
    app.registerAdmin(admin.modules.scripts, {app:app, path: pathUtil.<span class="apidocCodeKeywordSpan">getScriptPath</span>(app
.getBase())});
    if(os.platform() !== Constants.PLATFORM.WIN) {
      app.registerAdmin(admin.modules.profiler);
    }
  }
};

var startModule = function(err, modules, index, cb) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getSysRemotePath" id="apidoc.element.pomelo.pathUtil.getSysRemotePath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getSysRemotePath
        <span class="apidocSignatureSpan">(role)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSysRemotePath = function (role) {
  var p = path.join(__dirname, '/../common/remote/', role);
  return fs.existsSync(p) ? p : null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
var getProxyRecords = function(app, sinfo) {
var records = [],
  appBase = app.getBase(),
  record;
// sys remote service path record
if (app.isFrontend(sinfo)) {
  record = pathUtil.<span class="apidocCodeKeywordSpan">getSysRemotePath</span>('frontend');
} else {
  record = pathUtil.getSysRemotePath('backend');
}
if (record) {
  records.push(pathUtil.remotePathRecord('sys', sinfo.serverType, record));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.getUserRemotePath" id="apidoc.element.pomelo.pathUtil.getUserRemotePath">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>getUserRemotePath
        <span class="apidocSignatureSpan">(appBase, serverType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getUserRemotePath = function (appBase, serverType) {
  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.REMOTE);
  return fs.existsSync(p) ? p : null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    record = pathUtil.getSysRemotePath('backend');
  }
  if (record) {
    records.push(pathUtil.remotePathRecord('sys', sinfo.serverType, record));
  }

  // user remote service path record
  record = pathUtil.<span class="apidocCodeKeywordSpan">getUserRemotePath</span>(appBase, sinfo.serverType);
  if (record) {
    records.push(pathUtil.remotePathRecord('user', sinfo.serverType, record));
  }

  return records;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.listUserRemoteDir" id="apidoc.element.pomelo.pathUtil.listUserRemoteDir">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>listUserRemoteDir
        <span class="apidocSignatureSpan">(appBase)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listUserRemoteDir = function (appBase) {
  var base = path.join(appBase, '/app/servers/');
  var files = fs.readdirSync(base);
  return files.filter(function(fn) {
    if(fn.charAt(0) === '.') {
      return false;
    }

    return fs.statSync(path.join(base, fn)).isDirectory();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pathUtil.remotePathRecord" id="apidoc.element.pomelo.pathUtil.remotePathRecord">
        function <span class="apidocSignatureSpan">pomelo.pathUtil.</span>remotePathRecord
        <span class="apidocSignatureSpan">(namespace, serverType, path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remotePathRecord = function (namespace, serverType, path) {
  return {namespace: namespace, serverType: serverType, path: path};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// sys remote service path record
if (app.isFrontend(sinfo)) {
  record = pathUtil.getSysRemotePath('frontend');
} else {
  record = pathUtil.getSysRemotePath('backend');
}
if (record) {
  records.push(pathUtil.<span class="apidocCodeKeywordSpan">remotePathRecord</span>('sys', sinfo.serverType, record));
}

// user remote service path record
record = pathUtil.getUserRemotePath(appBase, sinfo.serverType);
if (record) {
  records.push(pathUtil.remotePathRecord('user', sinfo.serverType, record));
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pushSchedulers" id="apidoc.module.pomelo.pushSchedulers">module pomelo.pushSchedulers</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer" id="apidoc.element.pomelo.pushSchedulers.buffer">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>buffer
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buffer = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
  this.flushInterval = opts.flushInterval || DEFAULT_FLUSH_INTERVAL;
  this.sessions = {};   // sid -&gt; msg queue
  this.tid = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.direct" id="apidoc.element.pomelo.pushSchedulers.direct">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>direct
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">direct = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pushSchedulers.buffer" id="apidoc.module.pomelo.pushSchedulers.buffer">module pomelo.pushSchedulers.buffer</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer.buffer" id="apidoc.element.pomelo.pushSchedulers.buffer.buffer">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>buffer
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buffer = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
  this.flushInterval = opts.flushInterval || DEFAULT_FLUSH_INTERVAL;
  this.sessions = {};   // sid -&gt; msg queue
  this.tid = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pushSchedulers.buffer.prototype" id="apidoc.module.pomelo.pushSchedulers.buffer.prototype">module pomelo.pushSchedulers.buffer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.schedule" id="apidoc.element.pomelo.pushSchedulers.buffer.prototype.schedule">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>schedule
        <span class="apidocSignatureSpan">(reqId, route, msg, recvs, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">schedule = function (reqId, route, msg, recvs, opts, cb) {
  opts = opts || {};
  if(opts.type === 'broadcast') {
    doBroadcast(this, msg, opts.userOptions);
  } else {
    doBatchPush(this, msg, recvs);
  }

  process.nextTick(function() {
    utils.invokeCallback(cb);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.doSend = function(reqId, route, emsg, recvs, opts, cb) {
if (!emsg) {
  process.nextTick(function() {
    return cb &amp;&amp; cb(new Error('fail to send message for encode result is empty.'));
  });
}

this.app.components.__pushScheduler__.<span class="apidocCodeKeywordSpan">schedule</span>(reqId, route, emsg,
  recvs, opts, cb);
}

pro.setPubKey = function(id, key) {
var pubKey = new rsa.Key();
pubKey.n = new rsa.BigInteger(key.rsa_n, 16);
pubKey.e = key.rsa_e;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.start" id="apidoc.element.pomelo.pushSchedulers.buffer.prototype.start">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>start
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (cb) {
  this.tid = setInterval(flush.bind(null, this), this.flushInterval);
  process.nextTick(function() {
    utils.invokeCallback(cb);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return;
}

process.nextTick(cb);
};

pro.afterStart = function(cb) {
this.connector.<span class="apidocCodeKeywordSpan">start</span>(cb);
this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
if (this.connector) {
  this.connector.stop(force, cb);
  this.connector = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.buffer.prototype.stop" id="apidoc.element.pomelo.pushSchedulers.buffer.prototype.stop">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.buffer.prototype.</span>stop
        <span class="apidocSignatureSpan">(force, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function (force, cb) {
  if(this.tid) {
    clearInterval(this.tid);
    this.tid = null;
  }
  process.nextTick(function() {
    utils.invokeCallback(cb);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.afterStart = function(cb) {
  this.connector.start(cb);
  this.connector.on('connection', hostFilter.bind(this, bindEvents));
};

pro.stop = function(force, cb) {
  if (this.connector) {
    this.connector.<span class="apidocCodeKeywordSpan">stop</span>(force, cb);
    this.connector = null;
    return;
  } else {
    process.nextTick(cb);
  }
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pushSchedulers.direct" id="apidoc.module.pomelo.pushSchedulers.direct">module pomelo.pushSchedulers.direct</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.direct.direct" id="apidoc.element.pomelo.pushSchedulers.direct.direct">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.</span>direct
        <span class="apidocSignatureSpan">(app, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">direct = function (app, opts) {
  if (!(this instanceof Service)) {
    return new Service(app, opts);
  }

  opts = opts || {};
  this.app = app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.pushSchedulers.direct.prototype" id="apidoc.module.pomelo.pushSchedulers.direct.prototype">module pomelo.pushSchedulers.direct.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.pushSchedulers.direct.prototype.schedule" id="apidoc.element.pomelo.pushSchedulers.direct.prototype.schedule">
        function <span class="apidocSignatureSpan">pomelo.pushSchedulers.direct.prototype.</span>schedule
        <span class="apidocSignatureSpan">(reqId, route, msg, recvs, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">schedule = function (reqId, route, msg, recvs, opts, cb) {
  opts = opts || {};
  if(opts.type === 'broadcast') {
    doBroadcast(this, msg, opts.userOptions);
  } else {
    doBatchPush(this, msg, recvs);
  }

  if(cb) {
    process.nextTick(function() {
      utils.invokeCallback(cb);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
pro.doSend = function(reqId, route, emsg, recvs, opts, cb) {
if (!emsg) {
  process.nextTick(function() {
    return cb &amp;&amp; cb(new Error('fail to send message for encode result is empty.'));
  });
}

this.app.components.__pushScheduler__.<span class="apidocCodeKeywordSpan">schedule</span>(reqId, route, emsg,
  recvs, opts, cb);
}

pro.setPubKey = function(id, key) {
var pubKey = new rsa.Key();
pubKey.n = new rsa.BigInteger(key.rsa_n, 16);
pubKey.e = key.rsa_e;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.rpcFilters" id="apidoc.module.pomelo.rpcFilters">module pomelo.rpcFilters</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.rpcFilters.rpcLog" id="apidoc.element.pomelo.rpcFilters.rpcLog">
        function <span class="apidocSignatureSpan">pomelo.rpcFilters.</span>rpcLog
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rpcLog = function () {
  return new Filter();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Proxy component lifecycle function
 *
 * @param {Function} cb
 * @return {Void}
 */
pro.start = function(cb) {
if(this.opts.enableRpcLog) {
  logger.warn('enableRpcLog is deprecated in 0.8.0, please use app.rpcFilter(pomelo.rpcFilters.<span class="apidocCodeKeywordSpan
">rpcLog</span>())');
}
var rpcBefores = this.app.get(Constants.KEYWORDS.RPC_BEFORE_FILTER);
var rpcAfters = this.app.get(Constants.KEYWORDS.RPC_AFTER_FILTER);
var rpcErrorHandler = this.app.get(Constants.RESERVED.RPC_ERROR_HANDLER);

if(!!rpcBefores) {
  this.client.before(rpcBefores);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.rpcFilters.toobusy" id="apidoc.element.pomelo.rpcFilters.toobusy">
        function <span class="apidocSignatureSpan">pomelo.rpcFilters.</span>toobusy
        <span class="apidocSignatureSpan">(maxLag)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toobusy = function (maxLag) {
  return new Filter(maxLag || DEFAULT_MAXLAG);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.sessionService" id="apidoc.module.pomelo.sessionService">module pomelo.sessionService</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.sessionService.sessionService" id="apidoc.element.pomelo.sessionService.sessionService">
        function <span class="apidocSignatureSpan">pomelo.</span>sessionService
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sessionService = function (opts) {
  opts = opts || {};
  this.singleSession = opts.singleSession;
  this.sessions = {};     // sid -&gt; session
  this.uidMap = {};       // uid -&gt; sessions
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.sessionService.prototype" id="apidoc.module.pomelo.sessionService.prototype">module pomelo.sessionService.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.bind" id="apidoc.element.pomelo.sessionService.prototype.bind">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>bind
        <span class="apidocSignatureSpan">(sid, uid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bind = function (sid, uid, cb) {
  var session = this.sessions[sid];

  if(!session) {
    process.nextTick(function() {
      cb(new Error('session does not exist, sid: ' + sid));
    });
    return;
  }

  if(session.uid) {
    if(session.uid === uid) {
      // already bound with the same uid
      cb();
      return;
    }

    // already bound with other uid
    process.nextTick(function() {
      cb(new Error('session has already bound with ' + session.uid));
    });
    return;
  }

  var sessions = this.uidMap[uid];

  if(!!this.singleSession &amp;&amp; !!sessions) {
    process.nextTick(function() {
      cb(new Error('singleSession is enabled, and session has already bound with uid: ' + uid));
    });
    return;
  }

  if(!sessions) {
    sessions = this.uidMap[uid] = [];
  }

  for(var i=0, l=sessions.length; i&lt;l; i++) {
    // session has binded with the uid
    if(sessions[i].id === session.id) {
      process.nextTick(cb);
      return;
    }
  }
  sessions.push(session);

  session.bind(uid);

  if(cb) {
    process.nextTick(cb);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 return false;
};

var bindEvents = function(Event, app) {
 var emethods = new Event(app);
 for(var m in emethods) {
   if(typeof emethods[m] === 'function') {
     app.event.on(m, emethods[m].<span class="apidocCodeKeywordSpan">bind</span>(emethods));
   }
 }
};

var addFilter = function(app, type, filter) {
var filters = app.get(type);
 if(!filters) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.create" id="apidoc.element.pomelo.sessionService.prototype.create">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>create
        <span class="apidocSignatureSpan">(sid, frontendId, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (sid, frontendId, socket) {
  var session = new Session(sid, frontendId, socket, this);
  this.sessions[session.id] = session;

  return session;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var app = self.app,
  sid = socket.id;
var session = self.session.get(sid);
if (session) {
  return session;
}

session = self.session.<span class="apidocCodeKeywordSpan">create</span>(sid, app.getServerId(), socket);
logger.debug('[%s] getSession session is created with session id: %s', app.getServerId(), sid);

// bind events for session
socket.on('disconnect', session.closed.bind(session));
socket.on('error', session.closed.bind(session));
session.on('closed', onSessionClose.bind(null, app));
session.on('bind', function(uid) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.forEachBindedSession" id="apidoc.element.pomelo.sessionService.prototype.forEachBindedSession">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>forEachBindedSession
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEachBindedSession = function (cb) {
  var i, l, sessions;
  for(var uid in this.uidMap) {
    sessions = this.uidMap[uid];
    for(i=0, l=sessions.length; i&lt;l; i++) {
      cb(sessions[i]);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.forEachSession" id="apidoc.element.pomelo.sessionService.prototype.forEachSession">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>forEachSession
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEachSession = function (cb) {
  for(var sid in this.sessions) {
    cb(this.sessions[sid]);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.get" id="apidoc.element.pomelo.sessionService.prototype.get">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>get
        <span class="apidocSignatureSpan">(sid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (sid) {
  return this.sessions[sid];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*  // app.getBase() -&gt; /home/game
*
* @return {String} application base path
*
* @memberOf Application
*/
Application.getBase = function() {
 return this.<span class="apidocCodeKeywordSpan">get</span>(Constants.RESERVED.BASE);
};

/**
* Override require method in application
*
* @param {String} relative path of file
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.getByUid" id="apidoc.element.pomelo.sessionService.prototype.getByUid">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getByUid
        <span class="apidocSignatureSpan">(uid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getByUid = function (uid) {
  return this.uidMap[uid];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
SessionService.prototype.kick = function(uid, reason, cb) {
// compatible for old kick(uid, cb);
if(typeof reason === 'function') {
  cb = reason;
  reason = 'kick';
}
var sessions = this.<span class="apidocCodeKeywordSpan">getByUid</span>(uid);

if(sessions) {
  // notify client
  var sids = [];
  var self = this;
  sessions.forEach(function(session) {
    sids.push(session.id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.getClientAddressBySessionId" id="apidoc.element.pomelo.sessionService.prototype.getClientAddressBySessionId">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getClientAddressBySessionId
        <span class="apidocSignatureSpan">(sid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getClientAddressBySessionId = function (sid) {
  var session = this.get(sid);
  if(session) {
     var socket = session.__socket__;
     return socket.remoteAddress;
  } else {
     return null;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.getSessionsCount" id="apidoc.element.pomelo.sessionService.prototype.getSessionsCount">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>getSessionsCount
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSessionsCount = function () {
  return utils.size(this.sessions);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.import" id="apidoc.element.pomelo.sessionService.prototype.import">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>import
        <span class="apidocSignatureSpan">(sid, key, value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">import = function (sid, key, value, cb) {
  var session = this.sessions[sid];
  if(!session) {
    utils.invokeCallback(cb, new Error('session does not exist, sid: ' + sid));
    return;
  }
  session.set(key, value);
  utils.invokeCallback(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

FrontendSession.prototype.get = function(key) {
  return this.settings[key];
};

FrontendSession.prototype.push = function(key, cb) {
  this.__sessionService__.<span class="apidocCodeKeywordSpan">import</span>(this.id, key, this.get(key), cb);
};

FrontendSession.prototype.pushAll = function(cb) {
  this.__sessionService__.importAll(this.id, this.settings, cb);
};

FrontendSession.prototype.on = function(event, listener) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.importAll" id="apidoc.element.pomelo.sessionService.prototype.importAll">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>importAll
        <span class="apidocSignatureSpan">(sid, settings, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">importAll = function (sid, settings, cb) {
  var session = this.sessions[sid];
  if(!session) {
    utils.invokeCallback(cb, new Error('session does not exist, sid: ' + sid));
    return;
  }

  for(var f in settings) {
    session.set(f, settings[f]);
  }
  utils.invokeCallback(cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

FrontendSession.prototype.push = function(key, cb) {
  this.__sessionService__.import(this.id, key, this.get(key), cb);
};

FrontendSession.prototype.pushAll = function(cb) {
  this.__sessionService__.<span class="apidocCodeKeywordSpan">importAll</span>(this.id, this.settings, cb);
};

FrontendSession.prototype.on = function(event, listener) {
  EventEmitter.prototype.on.call(this, event, listener);
  this.__session__.on(event, listener);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.kick" id="apidoc.element.pomelo.sessionService.prototype.kick">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>kick
        <span class="apidocSignatureSpan">(uid, reason, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kick = function (uid, reason, cb) {
  // compatible for old kick(uid, cb);
  if(typeof reason === 'function') {
    cb = reason;
    reason = 'kick';
  }
  var sessions = this.getByUid(uid);

  if(sessions) {
    // notify client
    var sids = [];
    var self = this;
    sessions.forEach(function(session) {
      sids.push(session.id);
    });

    sids.forEach(function(sid) {
      self.sessions[sid].closed(reason);
    });

    process.nextTick(function() {
      utils.invokeCallback(cb);
    });
  } else {
    process.nextTick(function() {
      utils.invokeCallback(cb);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.kickBySessionId" id="apidoc.element.pomelo.sessionService.prototype.kickBySessionId">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>kickBySessionId
        <span class="apidocSignatureSpan">(sid, reason, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kickBySessionId = function (sid, reason, cb) {
  if(typeof reason === 'function') {
    cb = reason;
    reason = 'kick';
  }

  var session = this.get(sid);

  if(session) {
    // notify client
    session.closed(reason);
    process.nextTick(function() {
      utils.invokeCallback(cb);
    });
  } else {
    process.nextTick(function() {
      utils.invokeCallback(cb);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.remove" id="apidoc.element.pomelo.sessionService.prototype.remove">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>remove
        <span class="apidocSignatureSpan">(sid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remove = function (sid) {
  var session = this.sessions[sid];
  if(session) {
    var uid = session.uid;
    delete this.sessions[session.id];

    var sessions = this.uidMap[uid];
    if(!sessions) {
      return;
    }

    for(var i=0, l=sessions.length; i&lt;l; i++) {
      if(sessions[i].id === sid) {
        sessions.splice(i, 1);
        if(sessions.length === 0) {
          delete this.uidMap[uid];
        }
        break;
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
    });
  }
};

var removeFromStore = function(self, key, value) {
  if(!!self.store) {
    self.store.<span class="apidocCodeKeywordSpan">remove</span>(key, value, function(err) {
      if(!!err) {
        logger.error('remove key: %s value: %s from store, with err: %j', key, value, err.stack);
      }
    });
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.sendMessage" id="apidoc.element.pomelo.sessionService.prototype.sendMessage">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>sendMessage
        <span class="apidocSignatureSpan">(sid, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendMessage = function (sid, msg) {
  var session = this.sessions[sid];

  if(!session) {
    logger.debug('Fail to send message for non-existing session, sid: ' + sid + ' msg: ' + msg);
    return false;
  }

  return send(this, session, msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.sendMessageByUid" id="apidoc.element.pomelo.sessionService.prototype.sendMessageByUid">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>sendMessageByUid
        <span class="apidocSignatureSpan">(uid, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendMessageByUid = function (uid, msg) {
  var sessions = this.uidMap[uid];

  if(!sessions) {
    logger.debug('fail to send message by uid for non-existing session. uid: %j',
        uid);
    return false;
  }

  for(var i=0, l=sessions.length; i&lt;l; i++) {
    send(this, sessions[i], msg);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.sessionService.prototype.unbind" id="apidoc.element.pomelo.sessionService.prototype.unbind">
        function <span class="apidocSignatureSpan">pomelo.sessionService.prototype.</span>unbind
        <span class="apidocSignatureSpan">(sid, uid, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbind = function (sid, uid, cb) {
  var session = this.sessions[sid];

  if(!session) {
    process.nextTick(function() {
      cb(new Error('session does not exist, sid: ' + sid));
    });
    return;
  }

  if(!session.uid || session.uid !== uid) {
    process.nextTick(function() {
      cb(new Error('session has not bind with ' + session.uid));
    });
    return;
  }

  var sessions = this.uidMap[uid], sess;
  if(sessions) {
    for(var i=0, l=sessions.length; i&lt;l; i++) {
      sess = sessions[i];
      if(sess.id === sid) {
        sessions.splice(i, 1);
        break;
      }
    }

    if(sessions.length === 0) {
      delete this.uidMap[uid];
    }
  }
  session.unbind(uid);

  if(cb) {
    process.nextTick(cb);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param  {Number|String}   uid user id
 * @param  {Function} cb  callback function
 *
 * @memberOf BackendSession
 */
BackendSession.prototype.unbind = function(uid, cb) {
  var self = this;
  this.__sessionService__.<span class="apidocCodeKeywordSpan">unbind</span>(this.frontendId, this.id, uid, function(err) {
    if(!err) {
      self.uid = null;
    }
    utils.invokeCallback(cb, err);
  });
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.siosocket" id="apidoc.module.pomelo.siosocket">module pomelo.siosocket</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.siosocket.siosocket" id="apidoc.element.pomelo.siosocket.siosocket">
        function <span class="apidocSignatureSpan">pomelo.</span>siosocket
        <span class="apidocSignatureSpan">(id, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">siosocket = function (id, socket) {
  EventEmitter.call(this);
  this.id = id;
  this.socket = socket;
  this.remoteAddress = {
    ip: socket.handshake.address.address,
    port: socket.handshake.address.port
  };

  var self = this;

  socket.on('disconnect', this.emit.bind(this, 'disconnect'));

  socket.on('error', this.emit.bind(this, 'error'));

  socket.on('message', function(msg) {
    self.emit('message', msg);
  });

  this.state = ST_INITED;

  // TODO: any other events?
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.siosocket.super_" id="apidoc.element.pomelo.siosocket.super_">
        function <span class="apidocSignatureSpan">pomelo.siosocket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.siosocket.prototype" id="apidoc.module.pomelo.siosocket.prototype">module pomelo.siosocket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.siosocket.prototype.disconnect" id="apidoc.element.pomelo.siosocket.prototype.disconnect">
        function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>disconnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disconnect = function () {
  if(this.state === ST_CLOSED) {
    return;
  }

  this.state = ST_CLOSED;
  this.socket.disconnect();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var ip = socket.remoteAddress.ip;
var check = function(list) {
  for (var address in list) {
    var exp = new RegExp(list[address]);
    if (exp.test(ip)) {
      socket.<span class="apidocCodeKeywordSpan">disconnect</span>();
      return true;
    }
  }
  return false;
};
// dynamical check
if (this.blacklist.length !== 0 &amp;&amp; !!check(this.blacklist)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.siosocket.prototype.send" id="apidoc.element.pomelo.siosocket.prototype.send">
        function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>send
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg) {
  if(this.state !== ST_INITED) {
    return;
  }
  if(typeof msg !== 'string') {
    msg = JSON.stringify(msg);
  }
  this.socket.send(msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   opts = {
     type: 'response',
     userOptions: opts || {}
   };
   // for compatiablity
   opts.isResponse = true;

   self.<span class="apidocCodeKeywordSpan">send</span>(msg.id, msg.route, resp, [session.id], opts,
     function() {});
 });
};

/**
* Get server type form request message.
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.siosocket.prototype.sendBatch" id="apidoc.element.pomelo.siosocket.prototype.sendBatch">
        function <span class="apidocSignatureSpan">pomelo.siosocket.prototype.</span>sendBatch
        <span class="apidocSignatureSpan">(msgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendBatch = function (msgs) {
  this.send(encodeBatch(msgs));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Send message to the session in batch.
*
* @param  {Array} msgs list of message
*/
Session.prototype.sendBatch = function(msgs) {
 this.__socket__.<span class="apidocCodeKeywordSpan">sendBatch</span>(msgs);
};

/**
* Closed callback for the session which would disconnect client in next tick.
*
* @api public
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.starter" id="apidoc.module.pomelo.starter">module pomelo.starter</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.starter.bindCpu" id="apidoc.element.pomelo.starter.bindCpu">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>bindCpu
        <span class="apidocSignatureSpan">(sid, pid, host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindCpu = function (sid, pid, host) {
  if(os.platform() === Constants.PLATFORM.LINUX &amp;&amp; cpus[sid] !== undefined) {
    if (utils.isLocal(host)) {
      var options = [];
      options.push('-pc');
      options.push(cpus[sid]);
      options.push(pid);
      starter.localrun(Constants.COMMAND.TASKSET, null, options);
    }
    else {
      var cmd = util.format('taskset -pc "%s" "%s"', cpus[sid], pid);
      starter.sshrun(cmd, host, null);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.starter.kill" id="apidoc.element.pomelo.starter.kill">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>kill
        <span class="apidocSignatureSpan">(pids, servers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kill = function (pids, servers) {
  var cmd;
  for(var i = 0; i &lt; servers.length; i++) {
    var server = servers[i];
    if(utils.isLocal(server.host)) {
      var options = [];
      if(os.platform() === Constants.PLATFORM.WIN) {
        cmd = Constants.COMMAND.TASKKILL;
        options.push('/pid');
        options.push('/f');
      } else {
        cmd = Constants.COMMAND.KILL;
        options.push(-9);
      }
      options.push(pids[i]);
      starter.localrun(cmd,null,options);
    } else {
      if(os.platform() === Constants.PLATFORM.WIN) {
        cmd = util.format('taskkill /pid %s /f', pids[i]);
      } else {
        cmd = util.format('kill -9 %s', pids[i]);
      }
      starter.sshrun(cmd, server.host);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.starter.localrun" id="apidoc.element.pomelo.starter.localrun">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>localrun
        <span class="apidocSignatureSpan">(cmd, host, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">localrun = function (cmd, host, options, callback) {
  logger.info('Executing ' + cmd + ' ' + options + ' locally');
  spawnProcess(cmd, host, options, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  options.push(util.format('env=%s',  env));
  for(key in server) {
    if(key === Constants.RESERVED.CPU) {
      cpus[server.id] = server[key];
    }
    options.push(util.format('%s=%s', key, server[key]));
  }
  starter.<span class="apidocCodeKeywordSpan">localrun</span>(process.execPath, null, options, cb);
} else {
  cmd = util.format('cd "%s" &amp;&amp; "%s"', app.getBase(), process.execPath);
  var arg = server.args;
  if (arg !== undefined) {
    cmd += arg;
  }
  cmd += util.format(' "%s" env=%s ', app.get(Constants.RESERVED.MAIN), env);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.starter.run" id="apidoc.element.pomelo.starter.run">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>run
        <span class="apidocSignatureSpan">(app, server, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (app, server, cb) {
  env = app.get(Constants.RESERVED.ENV);
  var cmd, key;
  if (utils.isLocal(server.host)) {
    var options = [];
    if (!!server.args) {
      if(typeof server.args === 'string') {
        options.push(server.args.trim());
      } else {
        options = options.concat(server.args);
      }
    }
    cmd = app.get(Constants.RESERVED.MAIN);
    options.push(cmd);
    options.push(util.format('env=%s',  env));
    for(key in server) {
      if(key === Constants.RESERVED.CPU) {
        cpus[server.id] = server[key];
      }
      options.push(util.format('%s=%s', key, server[key]));
    }
    starter.localrun(process.execPath, null, options, cb);
  } else {
    cmd = util.format('cd "%s" &amp;&amp; "%s"', app.getBase(), process.execPath);
    var arg = server.args;
    if (arg !== undefined) {
      cmd += arg;
    }
    cmd += util.format(' "%s" env=%s ', app.get(Constants.RESERVED.MAIN), env);
    for(key in server) {
      if(key === Constants.RESERVED.CPU) {
        cpus[server.id] = server[key];
      }
      cmd += util.format(' %s=%s ', key, server[key]);
    }
    starter.sshrun(cmd, server.host, cb);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var condition = app.startId || app.type;
switch(condition) {
  case Constants.RESERVED.MASTER:
  break;
  case Constants.RESERVED.ALL:
  servers = app.getServersFromConfig();
  for (var serverId in servers) {
    this.<span class="apidocCodeKeywordSpan">run</span>(app, servers[serverId]);
  }
  break;
  default:
  server = app.getServerFromConfig(condition);
  if(!!server) {
    this.run(app, server);
  } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.starter.runServers" id="apidoc.element.pomelo.starter.runServers">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>runServers
        <span class="apidocSignatureSpan">(app)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">runServers = function (app) {
  var server, servers;
  var condition = app.startId || app.type;
  switch(condition) {
    case Constants.RESERVED.MASTER:
    break;
    case Constants.RESERVED.ALL:
    servers = app.getServersFromConfig();
    for (var serverId in servers) {
      this.run(app, servers[serverId]);
    }
    break;
    default:
    server = app.getServerFromConfig(condition);
    if(!!server) {
      this.run(app, server);
    } else {
      servers = app.get(Constants.RESERVED.SERVERS)[condition];
      for(var i=0; i&lt;servers.length; i++) {
        this.run(app, servers[i]);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Start servers by type.
 */
module.exports.startByType = function(app, cb) {
if(!!app.startId) {
  if(app.startId === Constants.RESERVED.MASTER) {
    utils.invokeCallback(cb);
  } else {
    starter.<span class="apidocCodeKeywordSpan">runServers</span>(app);
  }
} else {
  if(!!app.type &amp;&amp; app.type !== Constants.RESERVED.ALL &amp;&amp; app.type !== Constants.RESERVED.MASTER) {
    starter.runServers(app);
  } else {
    utils.invokeCallback(cb);
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.starter.sshrun" id="apidoc.element.pomelo.starter.sshrun">
        function <span class="apidocSignatureSpan">pomelo.starter.</span>sshrun
        <span class="apidocSignatureSpan">(cmd, host, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sshrun = function (cmd, host, cb) {
  var args = [];
  args.push(host);
  var ssh_params = pomelo.app.get(Constants.RESERVED.SSH_CONFIG_PARAMS);
  if(!!ssh_params &amp;&amp; Array.isArray(ssh_params)) {
    args = args.concat(ssh_params);
  }
  args.push(cmd);

  logger.info('Executing ' + cmd + ' on ' + host + ':22');
  spawnProcess(Constants.COMMAND.SSH, host, args, cb);
  return;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   cmd += util.format(' "%s" env=%s ', app.get(Constants.RESERVED.MAIN), env);
   for(key in server) {
     if(key === Constants.RESERVED.CPU) {
       cpus[server.id] = server[key];
     }
     cmd += util.format(' %s=%s ', key, server[key]);
   }
   starter.<span class="apidocCodeKeywordSpan">sshrun</span>(cmd, server.host, cb);
 }
};

/**
* Bind process with cpu
*
* @param {String} sid server id
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.switcher" id="apidoc.module.pomelo.switcher">module pomelo.switcher</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.switcher.switcher" id="apidoc.element.pomelo.switcher.switcher">
        function <span class="apidocSignatureSpan">pomelo.</span>switcher
        <span class="apidocSignatureSpan">(server, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">switcher = function (server, opts) {
  EventEmitter.call(this);
  this.server = server;
  this.wsprocessor = new WSProcessor();
  this.tcpprocessor = new TCPProcessor(opts.closeMethod);
  this.id = 1;
  this.timeout = (opts.timeout || DEFAULT_TIMEOUT) * 1000;
  this.setNoDelay = opts.setNoDelay;

  if (!opts.ssl) {
    this.server.on('connection', this.newSocket.bind(this));
  } else {
    this.server.on('secureConnection', this.newSocket.bind(this));
    this.server.on('clientError', function(e, tlsSo) {
      logger.warn('an ssl error occured before handshake established: ', e);
      tlsSo.destroy();
    });
  }

  this.wsprocessor.on('connection', this.emit.bind(this, 'connection'));
  this.tcpprocessor.on('connection', this.emit.bind(this, 'connection'));

  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.switcher.super_" id="apidoc.element.pomelo.switcher.super_">
        function <span class="apidocSignatureSpan">pomelo.switcher.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.switcher.prototype" id="apidoc.module.pomelo.switcher.prototype">module pomelo.switcher.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.switcher.prototype.close" id="apidoc.element.pomelo.switcher.prototype.close">
        function <span class="apidocSignatureSpan">pomelo.switcher.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  if(this.state !== ST_STARTED) {
    return;
  }

  this.state = ST_CLOSED;
  this.wsprocessor.close();
  this.tcpprocessor.close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);
this.version = crypto.createHash('md5').update(protoStr).digest('base64');

//Watch file
var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));
if (this.watchers[type]) {
  this.watchers[type].<span class="apidocCodeKeywordSpan">close</span>();
}
this.watchers[type] = watcher;
};

pro.onUpdate = function(type, path, event) {
if(event !== 'change') {
  return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.switcher.prototype.newSocket" id="apidoc.element.pomelo.switcher.prototype.newSocket">
        function <span class="apidocSignatureSpan">pomelo.switcher.prototype.</span>newSocket
        <span class="apidocSignatureSpan">(socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">newSocket = function (socket) {
  if(this.state !== ST_STARTED) {
    return;
  }

  socket.setTimeout(this.timeout, function() {
     logger.warn('connection is timeout without communication, the remote ip is %s &amp;&amp; port is %s',
       socket.remoteAddress, socket.remotePort);
     socket.destroy();
  });

  var self = this;

  socket.once('data', function(data) {
    // FIXME: handle incomplete HTTP method
    if(isHttp(data)) {
      processHttp(self, self.wsprocessor, socket, data);
    } else {
      if(!!self.setNoDelay) {
        socket.setNoDelay(true);
      }
      processTcp(self, self.tcpprocessor, socket, data);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.taskManager" id="apidoc.module.pomelo.taskManager">module pomelo.taskManager</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.taskManager.addTask" id="apidoc.element.pomelo.taskManager.addTask">
        function <span class="apidocSignatureSpan">pomelo.taskManager.</span>addTask
        <span class="apidocSignatureSpan">(key, fn, ontimeout, timeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addTask = function (key, fn, ontimeout, timeout) {
  var queue = queues[key];
  if(!queue) {
    queue = sequeue.createQueue(manager.timeout);
    queues[key] = queue;
  }

  return queue.push(fn, ontimeout, timeout);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.timeout = timeout;
};

/**
 * request serialization after filter
 */
Filter.prototype.before = function(msg, session, next) {
  taskManager.<span class="apidocCodeKeywordSpan">addTask</span>(session.id, function(task) {
    session.__serialTask__ = task;
    next();
  }, function() {
    logger.error('[serial filter] msg timeout, msg:' + JSON.stringify(msg));
  }, this.timeout);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.taskManager.closeQueue" id="apidoc.element.pomelo.taskManager.closeQueue">
        function <span class="apidocSignatureSpan">pomelo.taskManager.</span>closeQueue
        <span class="apidocSignatureSpan">(key, force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closeQueue = function (key, force) {
  if(!queues[key]) {
    // ignore illeagle key
    return;
  }

  queues[key].close(force);
  delete queues[key];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  self.app.event.emit(events.UNBIND_SESSION, session);
});

return session;
};

var onSessionClose = function(app, session, reason) {
taskManager.<span class="apidocCodeKeywordSpan">closeQueue</span>(session.id, true);
app.event.emit(events.CLOSE_SESSION, session);
};

var handleMessage = function(self, session, msg) {
logger.debug('[%s] handleMessage session id: %s, msg: %j', self.app.serverId, session.id, msg);
var type = checkServerType(msg.route);
if (!type) {
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.tcpprocessor" id="apidoc.module.pomelo.tcpprocessor">module pomelo.tcpprocessor</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.tcpprocessor.tcpprocessor" id="apidoc.element.pomelo.tcpprocessor.tcpprocessor">
        function <span class="apidocSignatureSpan">pomelo.</span>tcpprocessor
        <span class="apidocSignatureSpan">(closeMethod)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tcpprocessor = function (closeMethod) {
  EventEmitter.call(this);
  this.closeMethod = closeMethod;
  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpprocessor.super_" id="apidoc.element.pomelo.tcpprocessor.super_">
        function <span class="apidocSignatureSpan">pomelo.tcpprocessor.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.tcpprocessor.prototype" id="apidoc.module.pomelo.tcpprocessor.prototype">module pomelo.tcpprocessor.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.tcpprocessor.prototype.add" id="apidoc.element.pomelo.tcpprocessor.prototype.add">
        function <span class="apidocSignatureSpan">pomelo.tcpprocessor.prototype.</span>add
        <span class="apidocSignatureSpan">(socket, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (socket, data) {
  if(this.state !== ST_STARTED) {
    return;
  }
  var tcpsocket = new TcpSocket(socket, {headSize: HEAD_SIZE,
                                         headHandler: utils.headHandler,
                                         closeMethod: this.closeMethod});
  this.emit('connection', tcpsocket);
  socket.emit('data', data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  });
}
};

var addToStore = function(self, key, value) {
  if(!!self.store) {
    self.store.<span class="apidocCodeKeywordSpan">add</span>(key, value, function(err) {
      if(!!err) {
        logger.error('add key: %s value: %s to store, with err: %j', key, value, err.stack);
      }
    });
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpprocessor.prototype.close" id="apidoc.element.pomelo.tcpprocessor.prototype.close">
        function <span class="apidocSignatureSpan">pomelo.tcpprocessor.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  if(this.state !== ST_STARTED) {
    return;
  }
  this.state = ST_CLOSED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);
this.version = crypto.createHash('md5').update(protoStr).digest('base64');

//Watch file
var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));
if (this.watchers[type]) {
  this.watchers[type].<span class="apidocCodeKeywordSpan">close</span>();
}
this.watchers[type] = watcher;
};

pro.onUpdate = function(type, path, event) {
if(event !== 'change') {
  return;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.tcpsocket" id="apidoc.module.pomelo.tcpsocket">module pomelo.tcpsocket</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.tcpsocket.tcpsocket" id="apidoc.element.pomelo.tcpsocket.tcpsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>tcpsocket
        <span class="apidocSignatureSpan">(socket, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tcpsocket = function (socket, opts) {
  if(!(this instanceof Socket)) {
    return new Socket(socket, opts);
  }

  if(!socket || !opts) {
    throw new Error('invalid socket or opts');
  }

  if(!opts.headSize || typeof opts.headHandler !== 'function') {
    throw new Error('invalid opts.headSize or opts.headHandler');
  }

  // stream style interfaces.
  // TODO: need to port to stream2 after node 0.9
  Stream.call(this);
  this.readable = true;
  this.writeable = true;

  this._socket = socket;
  this.headSize = opts.headSize;
  this.closeMethod = opts.closeMethod;
  this.headBuffer = new Buffer(opts.headSize);
  this.headHandler = opts.headHandler;

  this.headOffset = 0;
  this.packageOffset = 0;
  this.packageSize = 0;
  this.packageBuffer = null;

  // bind event form the origin socket
  this._socket.on('data', ondata.bind(null, this));
  this._socket.on('end', onend.bind(null, this));
  this._socket.on('error', this.emit.bind(this, 'error'));
  this._socket.on('close', this.emit.bind(this, 'close'));

  this.state = ST_HEAD;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpsocket.super_" id="apidoc.element.pomelo.tcpsocket.super_">
        function <span class="apidocSignatureSpan">pomelo.tcpsocket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Stream() {
  EE.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.tcpsocket.prototype" id="apidoc.module.pomelo.tcpsocket.prototype">module pomelo.tcpsocket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.tcpsocket.prototype.close" id="apidoc.element.pomelo.tcpsocket.prototype.close">
        function <span class="apidocSignatureSpan">pomelo.tcpsocket.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  if(!!this.closeMethod &amp;&amp; this.closeMethod === 'end') {
    this._socket.end();
  } else {
    try {
      this._socket.destroy();
    } catch (e) {
      logger.error('socket close with destroy error: %j', e.stack);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);
this.version = crypto.createHash('md5').update(protoStr).digest('base64');

//Watch file
var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));
if (this.watchers[type]) {
  this.watchers[type].<span class="apidocCodeKeywordSpan">close</span>();
}
this.watchers[type] = watcher;
};

pro.onUpdate = function(type, path, event) {
if(event !== 'change') {
  return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.tcpsocket.prototype.send" id="apidoc.element.pomelo.tcpsocket.prototype.send">
        function <span class="apidocSignatureSpan">pomelo.tcpsocket.prototype.</span>send
        <span class="apidocSignatureSpan">(msg, encode, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg, encode, cb) {
  this._socket.write(msg, encode, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   opts = {
     type: 'response',
     userOptions: opts || {}
   };
   // for compatiablity
   opts.isResponse = true;

   self.<span class="apidocCodeKeywordSpan">send</span>(msg.id, msg.route, resp, [session.id], opts,
     function() {});
 });
};

/**
* Get server type form request message.
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.udpsocket" id="apidoc.module.pomelo.udpsocket">module pomelo.udpsocket</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.udpsocket" id="apidoc.element.pomelo.udpsocket.udpsocket">
        function <span class="apidocSignatureSpan">pomelo.</span>udpsocket
        <span class="apidocSignatureSpan">(id, socket, peer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">udpsocket = function (id, socket, peer) {
	EventEmitter.call(this);
	
  this.id = id;
	this.socket = socket;
  this.peer = peer;
	this.host = peer.address;
	this.port = peer.port;
	this.remoteAddress = {
    ip: this.host,
    port: this.port
  };

  var self = this;
  this.on('package', function(pkg) {
    if(!!pkg) {
      pkg = Package.decode(pkg);
      handler(self, pkg);
    }
  });

  this.state = ST_INITED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.super_" id="apidoc.element.pomelo.udpsocket.super_">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.udpsocket.prototype" id="apidoc.module.pomelo.udpsocket.prototype">module pomelo.udpsocket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.disconnect" id="apidoc.element.pomelo.udpsocket.prototype.disconnect">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>disconnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">disconnect = function () {
  if(this.state === ST_CLOSED) {
    return;
  }
  this.state = ST_CLOSED;
  this.emit('disconnect', 'the connection is disconnected.');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var ip = socket.remoteAddress.ip;
var check = function(list) {
  for (var address in list) {
    var exp = new RegExp(list[address]);
    if (exp.test(ip)) {
      socket.<span class="apidocCodeKeywordSpan">disconnect</span>();
      return true;
    }
  }
  return false;
};
// dynamical check
if (this.blacklist.length !== 0 &amp;&amp; !!check(this.blacklist)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.handshakeResponse" id="apidoc.element.pomelo.udpsocket.prototype.handshakeResponse">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>handshakeResponse
        <span class="apidocSignatureSpan">(resp)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handshakeResponse = function (resp) {
  if(this.state !== ST_INITED) {
    return;
  }
  this.sendRaw(resp);
  this.state = ST_WAIT_ACK;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var res = {
  code: CODE_OK,
  sys: sys
};
if(resp) {
  res.user = resp;
}
socket.<span class="apidocCodeKeywordSpan">handshakeResponse</span>(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify
(res))));
};

var processError = function(socket, code) {
var res = {
  code: code
};
socket.sendForce(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.send" id="apidoc.element.pomelo.udpsocket.prototype.send">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>send
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg) {
  if(this.state !== ST_WORKING) {
    return;
  }
  if(msg instanceof String) {
    msg = new Buffer(msg);
  } else if(!(msg instanceof Buffer)) {
    msg = new Buffer(JSON.stringify(msg));
  }
  this.sendRaw(Package.encode(Package.TYPE_DATA, msg));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   opts = {
     type: 'response',
     userOptions: opts || {}
   };
   // for compatiablity
   opts.isResponse = true;

   self.<span class="apidocCodeKeywordSpan">send</span>(msg.id, msg.route, resp, [session.id], opts,
     function() {});
 });
};

/**
* Get server type form request message.
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.sendBatch" id="apidoc.element.pomelo.udpsocket.prototype.sendBatch">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendBatch
        <span class="apidocSignatureSpan">(msgs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendBatch = function (msgs) {
  if(this.state !== ST_WORKING) {
    return;
  }
  var rs = [];
  for(var i=0; i&lt;msgs.length; i++) {
    var src = Package.encode(Package.TYPE_DATA, msgs[i]);
    rs.push(src);
  }
  this.sendRaw(Buffer.concat(rs));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Send message to the session in batch.
*
* @param  {Array} msgs list of message
*/
Session.prototype.sendBatch = function(msgs) {
 this.__socket__.<span class="apidocCodeKeywordSpan">sendBatch</span>(msgs);
};

/**
* Closed callback for the session which would disconnect client in next tick.
*
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.sendForce" id="apidoc.element.pomelo.udpsocket.prototype.sendForce">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendForce
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendForce = function (msg) {
  if(this.state === ST_CLOSED) {
    return;
  }
  this.sendRaw(msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  socket.handshakeResponse(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));
};

var processError = function(socket, code) {
  var res = {
    code: code
  };
  socket.<span class="apidocCodeKeywordSpan">sendForce</span>(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res
))));
  process.nextTick(function() {
    socket.disconnect();
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.udpsocket.prototype.sendRaw" id="apidoc.element.pomelo.udpsocket.prototype.sendRaw">
        function <span class="apidocSignatureSpan">pomelo.udpsocket.prototype.</span>sendRaw
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendRaw = function (msg) {
	this.socket.send(msg, 0, msg.length, this.port, this.host, function(err, bytes) {
    if(!!err)	{
      logger.error('send msg to remote with err: %j', err.stack);
      return;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
Socket.prototype.send = function(msg) {
 if(msg instanceof String) {
   msg = new Buffer(msg);
 } else if(!(msg instanceof Buffer)) {
   msg = new Buffer(JSON.stringify(msg));
 }
 this.<span class="apidocCodeKeywordSpan">sendRaw</span>(Package.encode(Package.TYPE_DATA, msg));
};

/**
* Send byte data packages to client in batch.
*
* @param  {Buffer} msgs byte data
*/
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.utils" id="apidoc.module.pomelo.utils">module pomelo.utils</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.utils.arrayDiff" id="apidoc.element.pomelo.utils.arrayDiff">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>arrayDiff
        <span class="apidocSignatureSpan">(array1, array2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">arrayDiff = function (array1, array2) {
  var o = {};
  for(var i = 0, len = array2.length; i &lt; len; i++) {
    o[array2[i]] = true;
  }

  var result = [];
  for(i = 0, len = array1.length; i &lt; len; i++) {
    var v = array1[i];
    if(o[v]) continue;
    result.push(v);
  }
  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
var count = serverIds.length;
var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN}, function() {
  if(!successFlag) {
    utils.invokeCallback(cb, new Error('all servers start failed.'));
    return;
  }
  utils.invokeCallback(cb, null, utils.<span class="apidocCodeKeywordSpan">arrayDiff</span>(serverIds, successIds));
});

var request = function(id) {
  return (function() {
    agent.request(id, module.exports.moduleId, { signal: msg.signal }, function(msg) {
      if(!utils.size(msg)) {
        latch.done();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.checkPort" id="apidoc.element.pomelo.utils.checkPort">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>checkPort
        <span class="apidocSignatureSpan">(server, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkPort = function (server, cb) {
  if (!server.port &amp;&amp; !server.clientPort) {
    this.invokeCallback(cb, 'leisure');
    return;
  }
  var self = this;
  var port = server.port || server.clientPort;
  var host = server.host;
  var generateCommand = function(self, host, port) {
    var cmd;
    var ssh_params = pomelo.app.get(Constants.RESERVED.SSH_CONFIG_PARAMS);
    if(!!ssh_params &amp;&amp; Array.isArray(ssh_params)) {
      ssh_params = ssh_params.join(' ');
    }
    else {
      ssh_params = "";
    }
    if (!self.isLocal(host)) {
      cmd = util.format('ssh %s %s "netstat -an|awk \'{print $4}\'|grep %s|wc -l"', host, ssh_params, port);
    } else {
      cmd = util.format('netstat -an|awk \'{print $4}\'|grep %s|wc -l', port);
    }
    return cmd;
  };
  var cmd1 = generateCommand(self, host, port);
  var child = exec(cmd1, function(err, stdout, stderr) {
    if(err) {
      logger.error('command %s execute with error: %j', cmd1, err.stack);
      self.invokeCallback(cb, 'error');
    } else if(stdout.trim() !== '0') {
      self.invokeCallback(cb, 'busy');
    } else {
      port = server.clientPort;
      var cmd2 = generateCommand(self, host, port);
      exec(cmd2, function(err, stdout, stderr) {
        if(err) {
          logger.error('command %s execute with error: %j', cmd2, err.stack);
          self.invokeCallback(cb, 'error');
        } else if (stdout.trim() !== '0') {
          self.invokeCallback(cb, 'busy');
        } else {
          self.invokeCallback(cb, 'leisure');
        }
      });
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.endsWith" id="apidoc.element.pomelo.utils.endsWith">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>endsWith
        <span class="apidocSignatureSpan">(str, suffix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">endsWith = function (str, suffix) {
  if (typeof str !== 'string' || typeof suffix !== 'string' ||
    suffix.length &gt; str.length) {
    return false;
  }
  return str.indexOf(suffix, str.length - suffix.length) !== -1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.extends" id="apidoc.element.pomelo.utils.extends">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>extends
        <span class="apidocSignatureSpan">(origin, add)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extends = function (origin, add) {
  if (!add || !this.isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.format" id="apidoc.element.pomelo.utils.format">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>format
        <span class="apidocSignatureSpan">(date, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (date, format) {
  format = format || 'MMddhhmm';
  var o = {
    "M+": date.getMonth() + 1, //month
    "d+": date.getDate(), //day
    "h+": date.getHours(), //hour
    "m+": date.getMinutes(), //minute
    "s+": date.getSeconds(), //second
    "q+": Math.floor((date.getMonth() + 3) / 3), //quarter
    "S": date.getMilliseconds() //millisecond
  };

  if (/(y+)/.test(format)) {
    format = format.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
  }

  for (var k in o) {
    if (new RegExp("(" + k + ")").test(format)) {
      format = format.replace(RegExp.$1, RegExp.$1.length === 1 ? o[k] :
        ("00" + o[k]).substr(("" + o[k]).length));
    }
  }
  return format;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    options.push(server.args.trim());
  } else {
    options = options.concat(server.args);
  }
}
cmd = app.get(Constants.RESERVED.MAIN);
options.push(cmd);
options.push(util.<span class="apidocCodeKeywordSpan">format</span>('env=%s',  env));
for(key in server) {
  if(key === Constants.RESERVED.CPU) {
    cpus[server.id] = server[key];
  }
  options.push(util.format('%s=%s', key, server[key]));
}
starter.localrun(process.execPath, null, options, cb);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.hasChineseChar" id="apidoc.element.pomelo.utils.hasChineseChar">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>hasChineseChar
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasChineseChar = function (str) {
  if (/.*[\u4e00-\u9fa5]+.*$/.test(str)) {
    return true;
  } else {
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    logger.error('could not verify message without public key [%s]', self.app.serverId);
    return false;
  }

  delete msg.body.__crypto__;

  var message = JSON.stringify(msg.body);
  if (utils.<span class="apidocCodeKeywordSpan">hasChineseChar</span>(message))
    message = utils.unicodeToUtf8(message);

  return pubKey.verifyString(message, sig);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.headHandler" id="apidoc.element.pomelo.utils.headHandler">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>headHandler
        <span class="apidocSignatureSpan">(headBuffer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">headHandler = function (headBuffer) {
  var len = 0;
  for(var i=1; i&lt;4; i++) {
    if(i &gt; 1) {
      len &lt;&lt;= 8;
    }
    len += headBuffer.readUInt8(i);
  }
  return len;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Tcp socket wrapper with package compositing.
 * Collect the package from socket and emit a completed package with 'data' event.
 * Uniform with ws.WebSocket interfaces.
 *
 * @param {Object} socket origin socket from node.js net module
 * @param {Object} opts   options parameter.
 *                        opts.headSize size of package head
 *                        opts.<span class="apidocCodeKeywordSpan">headHandler</span>(headBuffer) handler for package head. caculate
 and return body size from head data.
 */
var Socket = function(socket, opts) {
if(!(this instanceof Socket)) {
  return new Socket(socket, opts);
}

if(!socket || !opts) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.invokeCallback" id="apidoc.element.pomelo.utils.invokeCallback">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>invokeCallback
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">invokeCallback = function (cb) {
  if (typeof cb === 'function') {
    var len = arguments.length;
    if(len == 1) {
      return cb();
    }

    if(len == 2) {
      return cb(arguments[1]);
    }

    if(len == 3) {
      return cb(arguments[1], arguments[2]);
    }

    if(len == 4) {
      return cb(arguments[1], arguments[2], arguments[3]);
    }

    var args = Array(len - 1);
    for (i = 1; i &lt; len; i++)
        args[i - 1] = arguments[i];
    cb.apply(null, args);
    // cb.apply(null, Array.prototype.slice.call(arguments, 1));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param  {Function} cb callback function
* @memberOf Application
*/
Application.start = function(cb) {
 this.startTime = Date.now();
 if(this.state &gt; STATE_INITED) {
   utils.<span class="apidocCodeKeywordSpan">invokeCallback</span>(cb, new Error('application has already start.'));
   return;
 }

 var self = this;
 appUtil.startByType(self, function() {
   appUtil.loadDefaultComponents(self);
   var startUp = function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.isLocal" id="apidoc.element.pomelo.utils.isLocal">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>isLocal
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isLocal = function (host) {
  var app = require('../pomelo').app;
  if(!app) {
    return host === '127.0.0.1' || host === 'localhost' || host === '0.0.0.0' || inLocal(host);
  } else {
    return host === '127.0.0.1' || host === 'localhost' || host === '0.0.0.0' || inLocal(host) || host === app.master.host;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Object} app current application context
 * @param {Object} server
 * @return {Void}
 */
starter.run = function(app, server, cb) {
env = app.get(Constants.RESERVED.ENV);
var cmd, key;
if (utils.<span class="apidocCodeKeywordSpan">isLocal</span>(server.host)) {
  var options = [];
  if (!!server.args) {
    if(typeof server.args === 'string') {
      options.push(server.args.trim());
    } else {
      options = options.concat(server.args);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.isObject" id="apidoc.element.pomelo.utils.isObject">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>isObject
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isObject = function (arg) {
  return typeof arg === 'object' &amp;&amp; arg !== null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    cserver[k] = v + i;
  }
  serverMap[cserver.id] = cserver;
}
};

utils.extends = function(origin, add) {
if (!add || !this.<span class="apidocCodeKeywordSpan">isObject</span>(add)) return origin;

var keys = Object.keys(add);
var i = keys.length;
while (i--) {
  origin[keys[i]] = add[keys[i]];
}
return origin;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.loadCluster" id="apidoc.element.pomelo.utils.loadCluster">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>loadCluster
        <span class="apidocSignatureSpan">(app, server, serverMap)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadCluster = function (app, server, serverMap) {
  var increaseFields = {};
  var host = server.host;
  var count = parseInt(server[Constants.RESERVED.CLUSTER_COUNT]);
  var seq = app.clusterSeq[server.serverType];
  if(!seq) {
    seq = 0;
    app.clusterSeq[server.serverType] = count;
  } else {
    app.clusterSeq[server.serverType] = seq + count;
  }

  for(var key in server) {
    var value = server[key].toString();
    if(value.indexOf(Constants.RESERVED.CLUSTER_SIGNAL) &gt; 0) {
      var base = server[key].slice(0, -2);
      increaseFields[key] = base;
    }
  }

  var clone = function(src) {
    var rs = {};
    for(var key in src) {
      rs[key] = src[key];
    }
    return rs;
  };
  for(var i=0, l=seq; i&lt;count; i++,l++) {
    var cserver = clone(server);
    cserver.id = Constants.RESERVED.CLUSTER_PREFIX + server.serverType + '-' + l;
    for(var k in increaseFields) {
      var v = parseInt(increaseFields[k]);
      cserver[k] = v + i;
    }
    serverMap[cserver.id] = cserver;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

var startCluster = function(app, msg, cb) {
var serverMap = {};
var fails = [];
var successFlag;
var serverInfo = parseArgs(msg, ClusterInfo, cb);
utils.<span class="apidocCodeKeywordSpan">loadCluster</span>(app, serverInfo, serverMap);
var count = utils.size(serverMap);
var latch = countDownLatch.createCountDownLatch(count, function() {
  if(!successFlag) {
    utils.invokeCallback(cb, new Error('all servers start failed.'));
    return;
  }
  utils.invokeCallback(cb, null, fails);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.ping" id="apidoc.element.pomelo.utils.ping">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>ping
        <span class="apidocSignatureSpan">(host, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ping = function (host, cb) {
  if(!module.exports.isLocal(host)) {
    var cmd = 'ping -w 15 ' + host;
    exec(cmd, function(err, stdout, stderr) {
      if(!!err) {
        cb(false);
        return;
      }
      cb(true);
    });
  } else {
    cb(true);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.size" id="apidoc.element.pomelo.utils.size">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>size
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">size = function (obj) {
  var count = 0;
  for (var i in obj) {
    if (obj.hasOwnProperty(i) &amp;&amp; typeof obj[i] !== 'function') {
      count++;
    }
  }
  return count;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var Watchdog = function(app, service) {
  EventEmitter.call(this);

  this.app = app;
  this.service = service;
  this.isStarted = false;
  this.count = utils.<span class="apidocCodeKeywordSpan">size</span>(app.getServersFromConfig());

  this.servers = {};
  this.listeners = {};
};
util.inherits(Watchdog, EventEmitter);

module.exports = Watchdog;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.startsWith" id="apidoc.element.pomelo.utils.startsWith">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>startsWith
        <span class="apidocSignatureSpan">(str, prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">startsWith = function (str, prefix) {
  if (typeof str !== 'string' || typeof prefix !== 'string' ||
    prefix.length &gt; str.length) {
    return false;
  }

  return str.indexOf(prefix) === 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
};

var checkCluster = function(msg) {
  var flag = false;
  var args = msg.args;
  for(var i=0; i &lt; args.length; i++) {
    if(utils.<span class="apidocCodeKeywordSpan">startsWith</span>(args[i], Constants.RESERVED.CLUSTER_COUNT)) {
      flag = true;
    }
  }
  return flag;
};

var isReady = function(info) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.utils.unicodeToUtf8" id="apidoc.element.pomelo.utils.unicodeToUtf8">
        function <span class="apidocSignatureSpan">pomelo.utils.</span>unicodeToUtf8
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unicodeToUtf8 = function (str) {
  var i, len, ch;
  var utf8Str = "";
  len = str.length;
  for (i = 0; i &lt; len; i++) {
    ch = str.charCodeAt(i);

    if ((ch &gt;= 0x0) &amp;&amp; (ch &lt;= 0x7F)) {
      utf8Str += str.charAt(i);

    } else if ((ch &gt;= 0x80) &amp;&amp; (ch &lt;= 0x7FF)) {
      utf8Str += String.fromCharCode(0xc0 | ((ch &gt;&gt; 6) &amp; 0x1F));
      utf8Str += String.fromCharCode(0x80 | (ch &amp; 0x3F));

    } else if ((ch &gt;= 0x800) &amp;&amp; (ch &lt;= 0xFFFF)) {
      utf8Str += String.fromCharCode(0xe0 | ((ch &gt;&gt; 12) &amp; 0xF));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 6) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | (ch &amp; 0x3F));

    } else if ((ch &gt;= 0x10000) &amp;&amp; (ch &lt;= 0x1FFFFF)) {
      utf8Str += String.fromCharCode(0xF0 | ((ch &gt;&gt; 18) &amp; 0x7));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 12) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 6) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | (ch &amp; 0x3F));

    } else if ((ch &gt;= 0x200000) &amp;&amp; (ch &lt;= 0x3FFFFFF)) {
      utf8Str += String.fromCharCode(0xF8 | ((ch &gt;&gt; 24) &amp; 0x3));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 18) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 12) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 6) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | (ch &amp; 0x3F));

    } else if ((ch &gt;= 0x4000000) &amp;&amp; (ch &lt;= 0x7FFFFFFF)) {
      utf8Str += String.fromCharCode(0xFC | ((ch &gt;&gt; 30) &amp; 0x1));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 24) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 18) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 12) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | ((ch &gt;&gt; 6) &amp; 0x3F));
      utf8Str += String.fromCharCode(0x80 | (ch &amp; 0x3F));

    }

  }
  return utf8Str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return false;
  }

  delete msg.body.__crypto__;

  var message = JSON.stringify(msg.body);
  if (utils.hasChineseChar(message))
    message = utils.<span class="apidocCodeKeywordSpan">unicodeToUtf8</span>(message);

  return pubKey.verifyString(message, sig);
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.watchdog" id="apidoc.module.pomelo.watchdog">module pomelo.watchdog</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.watchdog.watchdog" id="apidoc.element.pomelo.watchdog.watchdog">
        function <span class="apidocSignatureSpan">pomelo.</span>watchdog
        <span class="apidocSignatureSpan">(app, service)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">watchdog = function (app, service) {
  EventEmitter.call(this);

  this.app = app;
  this.service = service;
  this.isStarted = false;
  this.count = utils.size(app.getServersFromConfig());

  this.servers = {};
  this.listeners = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.super_" id="apidoc.element.pomelo.watchdog.super_">
        function <span class="apidocSignatureSpan">pomelo.watchdog.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.watchdog.prototype" id="apidoc.module.pomelo.watchdog.prototype">module pomelo.watchdog.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.addServer" id="apidoc.element.pomelo.watchdog.prototype.addServer">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>addServer
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addServer = function (server) {
  if(!server) {
    return;
  }
  this.servers[server.id] = server;
  this.notify({action: 'addServer', server: server});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// ----------------- bind methods -------------------------

var onServerAdd = function(module, record) {
logger.debug('masterwatcher receive add server event, with server: %j', record);
if(!record || record.type === 'client' || !record.serverType) {
  return;
}
module.watchdog.<span class="apidocCodeKeywordSpan">addServer</span>(record);
};

var onServerReconnect = function(module, record) {
logger.debug('masterwatcher receive reconnect server event, with server: %j', record);
if(!record || record.type === 'client' || !record.serverType) {
  logger.warn('onServerReconnect receive wrong message: %j', record);
  return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.notify" id="apidoc.element.pomelo.watchdog.prototype.notify">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>notify
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (msg) {
  var listeners = this.listeners;
  var success = true;
  var fails = [];
  var timeouts = [];
  var requests = {};
  var count = utils.size(listeners);
  if(count === 0) {
    logger.warn('master watchdog listeners is none, msg: %j', msg);
    return;
  }
  var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN}, function(isTimeout) {
    if(!!isTimeout) {
      for(var key in requests) {
        if(!requests[key])  {
          timeouts.push(key);
        }
      }
      logger.error('master watchdog request timeout message: %j, timeouts: %j, fails: %j', msg, timeouts, fails);
    }
    if(!success) {
      logger.error('master watchdog request fail message: %j, fails: %j', msg, fails);
    }
  });

  var moduleRequest = function(self, id) {
    return (function() {
      self.service.agent.request(id, Constants.KEYWORDS.MONITOR_WATCHER, msg, function(signal) {
        if(signal !== Constants.SIGNAL.OK) {
          fails.push(id);
          success = false;
        }
        requests[id] = 1;
        latch.done();
      });
    })();
  };

  for(var id in listeners) {
    requests[id] = 0;
    moduleRequest(this, id);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports = Watchdog;

Watchdog.prototype.addServer = function(server) {
if(!server) {
  return;
}
this.servers[server.id] = server;
this.<span class="apidocCodeKeywordSpan">notify</span>({action: 'addServer', server: server});
};

Watchdog.prototype.removeServer = function(id) {
if(!id) {
  return;
}
this.unsubscribe(id);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.notifyById" id="apidoc.element.pomelo.watchdog.prototype.notifyById">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>notifyById
        <span class="apidocSignatureSpan">(id, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notifyById = function (id, msg) {
  this.service.agent.request(id, Constants.KEYWORDS.MONITOR_WATCHER, msg, function(signal) {
    if(signal !== Constants.SIGNAL.OK) {
      logger.error('master watchdog fail to notify to monitor, id: %s, msg: %j', id, msg);
    } else {
      logger.debug('master watchdog notify to monitor success, id: %s, msg: %j', id, msg);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if(!server) {
    return;
  }
  if(!this.servers[server.id]) {
    this.servers[server.id] = server;
  }
  //replace server in reconnect server
  this.<span class="apidocCodeKeywordSpan">notifyById</span>(server.id, {action: 'replaceServer', servers: self.servers
});
  // notify other server to add server
  this.notify({action: 'addServer', server: server});
  // add server in listener
  this.subscribe(server.id);
};

Watchdog.prototype.subscribe = function(id) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.query" id="apidoc.element.pomelo.watchdog.prototype.query">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>query
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">query = function () {
  return this.servers;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var subscribe = function(module, agent, msg, cb) {
if(!msg) {
  utils.invokeCallback(cb, new Error('masterwatcher subscribe empty message.'));
  return;
}

module.watchdog.subscribe(msg.id);
utils.invokeCallback(cb, null, module.watchdog.<span class="apidocCodeKeywordSpan">query</span>());
};

var unsubscribe = function(module, agent, msg, cb) {
if(!msg) {
  utils.invokeCallback(cb, new Error('masterwatcher unsubscribe empty message.'));
  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.reconnectServer" id="apidoc.element.pomelo.watchdog.prototype.reconnectServer">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>reconnectServer
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconnectServer = function (server) {
  var self = this;
  if(!server) {
    return;
  }
  if(!this.servers[server.id]) {
    this.servers[server.id] = server;
  }
  //replace server in reconnect server
  this.notifyById(server.id, {action: 'replaceServer', servers: self.servers});
  // notify other server to add server
  this.notify({action: 'addServer', server: server});
  // add server in listener
  this.subscribe(server.id);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var onServerReconnect = function(module, record) {
logger.debug('masterwatcher receive reconnect server event, with server: %j', record);
if(!record || record.type === 'client' || !record.serverType) {
  logger.warn('onServerReconnect receive wrong message: %j', record);
  return;
}
module.watchdog.<span class="apidocCodeKeywordSpan">reconnectServer</span>(record);
};

var onServerLeave = function(module, id, type) {
logger.debug('masterwatcher receive remove server event, with server: %s, type: %s', id, type);
if(!id) {
  logger.warn('onServerLeave receive server id is empty.');
  return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.record" id="apidoc.element.pomelo.watchdog.prototype.record">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>record
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">record = function (id) {
  if(!this.isStarted &amp;&amp; --this.count &lt; 0) {
    var usedTime = Date.now() - this.app.startTime;
    logger.info('all servers startup in %s ms', usedTime);
    this.notify({action: 'startOver'});
    this.isStarted = true;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

var record = function(module, agent, msg) {
if(!msg) {
  utils.invokeCallback(cb, new Error('masterwatcher record empty message.'));
  return;
}
module.watchdog.<span class="apidocCodeKeywordSpan">record</span>(msg.id);
};

var masterMethods = {
'subscribe': subscribe,
'unsubscribe': unsubscribe,
'query': query,
'record': record
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.removeServer" id="apidoc.element.pomelo.watchdog.prototype.removeServer">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>removeServer
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeServer = function (id) {
  if(!id) {
    return;
  }
  this.unsubscribe(id);
  delete this.servers[id];
  this.notify({action: 'removeServer', id: id});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var onServerLeave = function(module, id, type) {
logger.debug('masterwatcher receive remove server event, with server: %s, type: %s', id, type);
if(!id) {
  logger.warn('onServerLeave receive server id is empty.');
  return;
}
if(type !== 'client') {
  module.watchdog.<span class="apidocCodeKeywordSpan">removeServer</span>(id);
}
};

// ----------------- module methods -------------------------

Module.prototype.start = function(cb) {
utils.invokeCallback(cb);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.subscribe" id="apidoc.element.pomelo.watchdog.prototype.subscribe">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>subscribe
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (id) {
  this.listeners[id] = 1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.servers[server.id] = server;
  }
  //replace server in reconnect server
  this.notifyById(server.id, {action: 'replaceServer', servers: self.servers});
  // notify other server to add server
  this.notify({action: 'addServer', server: server});
  // add server in listener
  this.<span class="apidocCodeKeywordSpan">subscribe</span>(server.id);
};

Watchdog.prototype.subscribe = function(id) {
  this.listeners[id] = 1;
};

Watchdog.prototype.unsubscribe = function(id) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.watchdog.prototype.unsubscribe" id="apidoc.element.pomelo.watchdog.prototype.unsubscribe">
        function <span class="apidocSignatureSpan">pomelo.watchdog.prototype.</span>unsubscribe
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unsubscribe = function (id) {
  delete this.listeners[id];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.notify({action: 'addServer', server: server});
};

Watchdog.prototype.removeServer = function(id) {
if(!id) {
  return;
}
this.<span class="apidocCodeKeywordSpan">unsubscribe</span>(id);
delete this.servers[id];
this.notify({action: 'removeServer', id: id});
};

Watchdog.prototype.reconnectServer = function(server) {
var self = this;
if(!server) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.wsprocessor" id="apidoc.module.pomelo.wsprocessor">module pomelo.wsprocessor</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.wsprocessor.wsprocessor" id="apidoc.element.pomelo.wsprocessor.wsprocessor">
        function <span class="apidocSignatureSpan">pomelo.</span>wsprocessor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wsprocessor = function () {
  EventEmitter.call(this);
  this.httpServer = new HttpServer();

  var self = this;
  this.wsServer = new WebSocketServer({server: this.httpServer});

  this.wsServer.on('connection', function(socket) {
    // emit socket to outside
    self.emit('connection', socket);
  });

  this.state = ST_STARTED;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.wsprocessor.super_" id="apidoc.element.pomelo.wsprocessor.super_">
        function <span class="apidocSignatureSpan">pomelo.wsprocessor.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.pomelo.wsprocessor.prototype" id="apidoc.module.pomelo.wsprocessor.prototype">module pomelo.wsprocessor.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.pomelo.wsprocessor.prototype.add" id="apidoc.element.pomelo.wsprocessor.prototype.add">
        function <span class="apidocSignatureSpan">pomelo.wsprocessor.prototype.</span>add
        <span class="apidocSignatureSpan">(socket, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (socket, data) {
  if(this.state !== ST_STARTED) {
    return;
  }
  this.httpServer.emit('connection', socket);
  if(typeof socket.ondata === 'function') {
    // compatible with stream2
    socket.ondata(data, 0, data.length);
  } else {
    // compatible with old stream
    socket.emit('data', data);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  });
}
};

var addToStore = function(self, key, value) {
  if(!!self.store) {
    self.store.<span class="apidocCodeKeywordSpan">add</span>(key, value, function(err) {
      if(!!err) {
        logger.error('add key: %s value: %s to store, with err: %j', key, value, err.stack);
      }
    });
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.pomelo.wsprocessor.prototype.close" id="apidoc.element.pomelo.wsprocessor.prototype.close">
        function <span class="apidocSignatureSpan">pomelo.wsprocessor.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  if(this.state !== ST_STARTED) {
    return;
  }
  this.state = ST_CLOSED;
  this.wsServer.close();
  this.wsServer = null;
  this.httpServer = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);
this.version = crypto.createHash('md5').update(protoStr).digest('base64');

//Watch file
var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));
if (this.watchers[type]) {
  this.watchers[type].<span class="apidocCodeKeywordSpan">close</span>();
}
this.watchers[type] = watcher;
};

pro.onUpdate = function(type, path, event) {
if(event !== 'change') {
  return;
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>